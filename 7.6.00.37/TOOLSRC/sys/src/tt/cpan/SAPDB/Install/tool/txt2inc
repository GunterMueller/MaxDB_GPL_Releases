#!/usr/bin/perl

use Symbol;

sub main {
	my ($inname, $outname, $symbol) = @_;

	unless (defined $inname && defined $outname) {
		print "txt2inc infilename outfilename [symbol]\n";
	}

	unless (defined $symbol) {
		$symbol = $inname;
	}

	my $in = gensym ();
	my $out = gensym ();

	open ($in, $inname);
	open ($out, "> ".$outname);

	print $out "/*\n";
	print $out " * this generated by txt2inc, all changes will be lost\n";
	print $out " */\n";
	print $out "static const char ".$symbol."[] = {\n";
	while (<$in>) {
		$_ =~ s/\\/\\\\/g; 
		$_ =~ s/\"/\\"/g; 
		$_ =~ s/\n/\\n/g; 
		$_ =~ s/\r/\\r/g; 
		$_ =~ s/\t/\\t/g; 

		$_ = "\"".$_."\"\n";
		print $out $_;
	}
	print $out "};\n";

	close ($in);
	close ($out);
}

main (@ARGV);
