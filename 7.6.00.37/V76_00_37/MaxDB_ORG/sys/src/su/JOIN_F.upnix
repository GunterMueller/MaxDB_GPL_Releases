JOIN_F.vdnts
 
Enter command:
FILE XRESTORE !
 
Enter command:
DBMCLI SUPERDBA,COLDUSER!
UTIL_CONNECT SUPERDBA,COLDUSER!
OK
 
BACKUP_RESTORE XINITDB DATA!
OK
Returncode           0
Date                 DATEXXXX
Time                 TIMEYYYY
Server               <servernode>
Database             <serverdb>
Kernel Version       KERNEL    vv.vv.vv Build bbb-bbb-bbb-bbb
Pages Transferred    000
Pages Left           0
Volumes              1
Medianame            xinitdb
Location             xinitdb.sav
Errortext
Label                <label>
Is Consistent        true
First LOG Page       000
Last LOG Page
DB Stamp 1 Date      DATEXXXX
DB Stamp 1 Time      TIMEYYYY
DB Stamp 2 Date
DB Stamp 2 Time
Page Count           000
Devices Used         1
Database ID          <servernode>:<serverdb>_DATEXXXX_<timestamp>
Max Used Data Page  000
Converter Page Count 8
 
UTIL_EXECUTE CLEAR LOG!
OK
 
DB_ONLINE!
OK
 
UTIL_RELEASE!
OK
 
UTIL_CONNECT SUT,SUT!
OK
 
UTIL_RELEASE!
OK
 
BYE!
 
Enter command:
 
FILE JOIN_F ( 'NO' !
 
Enter command:
SENDERID DBM !
FILE CONNECT ( SUT SUT !
 
Enter command:
CONNECT SUT IDENTIFIED BY SUT   ISOLATION LEVEL 1 !
 
Enter command:
SET PARAMETER OPTIMIZE_OPERATOR_JOIN = 'NO' !
 
Enter command:
COMMIT RELEASE !
 
Enter command:
SENDERID XCI !
 
FILE CONNECT ( SUT SUT !
 
Enter command:
CONNECT SUT IDENTIFIED BY SUT   ISOLATION LEVEL 1 !
 
Enter command:
CREATE USER KERN PASSWORD TEST DBA NOT EXCLUSIVE !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
FILE CONNECT ( KERN TEST SQLMODE ORACLE !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE ORACLE ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE MITARBEITER (
   MA_ID        NUMBER (3) NOT NULL PRIMARY KEY,
   NAME         CHAR (30)  NOT NULL,
   SOLL_STUNDEN NUMBER (3) NOT NULL)!
 
Enter command:
INSERT INTO MITARBEITER VALUES (1, 'Ladewig', 40)!
 
Enter command:
INSERT INTO MITARBEITER VALUES (2, 'Schweiberger', 40)!
 
Enter command:
INSERT INTO MITARBEITER VALUES (3, 'Crossley', 20)!
 
Enter command:
INSERT INTO MITARBEITER VALUES (4, 'Ellis', 20)!
 
Enter command:
CREATE TABLE PROJEKT (
   PROJEKTID   NUMBER(3) NOT NULL PRIMARY KEY,
   ITS_NAME  CHAR(30) NOT NULL)!
 
Enter command:
INSERT INTO PROJEKT VALUES (1, 'Beratung IT Verlag')!
 
Enter command:
INSERT INTO PROJEKT VALUES (2, 'Loesung SQL Reatsel')!
 
Enter command:
INSERT INTO PROJEKT VALUES (3, 'Uebersetzung/Dokumentation')!
 
Enter command:
INSERT INTO PROJEKT VALUES (4, 'Vernetzung IT Verlag')!
 
Enter command:
CREATE TABLE PROJEKT_ZUORDNUNG (
   MA_ID                NUMBER (3) NOT NULL REFERENCES MITARBEITER,
   PROJEKTID           NUMBER (3) NOT NULL REFERENCES PROJEKT,
   ZEIT_ANTEIL_PROZENT  NUMBER (3),
        PRIMARY KEY (MA_ID, PROJEKTID))!
 
Enter command:
INSERT INTO PROJEKT_ZUORDNUNG VALUES (1, 1, 50)!
 
Enter command:
INSERT INTO PROJEKT_ZUORDNUNG VALUES (1, 2, 50)!
 
Enter command:
INSERT INTO PROJEKT_ZUORDNUNG VALUES (2, 1, 30)!
 
Enter command:
INSERT INTO PROJEKT_ZUORDNUNG VALUES (2, 2, 60)!
 
Enter command:
INSERT INTO PROJEKT_ZUORDNUNG VALUES (2, 3, 10)!
 
Enter command:
INSERT INTO PROJEKT_ZUORDNUNG VALUES (3, 2, 10)!
 
Enter command:
INSERT INTO PROJEKT_ZUORDNUNG VALUES (3, 3, 90)!
 
Enter command:
CREATE TABLE PROJZEIT (
   MA_ID       NUMBER (3) NOT NULL,
   PROJEKTID  NUMBER(3) NOT NULL,
   DATUM       DATE NOT NULL,
   WOCHE       NUMBER (4) NOT NULL,
   STUNDEN     NUMBER (2) NOT NULL,
        PRIMARY KEY (MA_ID, PROJEKTID, DATUM),
        FOREIGN KEY (MA_ID, PROJEKTID) REFERENCES PROJEKT_ZUORDNUNG)!
 
Enter command:
INSERT INTO PROJZEIT VALUES (1, 1, '21-JUN-93', 9325, 8)!
 
Enter command:
INSERT INTO PROJZEIT VALUES (1, 1, '22-JUN-93', 9325, 8)!
 
Enter command:
INSERT INTO PROJZEIT VALUES (1, 2, '23-JUN-93', 9325, 8)!
 
Enter command:
INSERT INTO PROJZEIT VALUES (1, 2, '24-JUN-93', 9325, 8)!
 
Enter command:
INSERT INTO PROJZEIT VALUES (1, 2, '25-JUN-93', 9325, 8)!
 
Enter command:
INSERT INTO PROJZEIT VALUES (2, 1, '21-JUN-93', 9325, 8)!
 
Enter command:
INSERT INTO PROJZEIT VALUES (2, 1, '22-JUN-93', 9325, 8)!
 
Enter command:
INSERT INTO PROJZEIT VALUES (2, 2, '23-JUN-93', 9325, 8)!
 
Enter command:
INSERT INTO PROJZEIT VALUES (2, 2, '24-JUN-93', 9325, 8)!
 
Enter command:
INSERT INTO PROJZEIT VALUES (2, 2, '25-JUN-93', 9325, 8)!
 
Enter command:
INSERT INTO PROJZEIT VALUES (3, 2, '21-JUN-93', 9325, 4)!
 
Enter command:
INSERT INTO PROJZEIT VALUES (3, 3, '21-JUN-93', 9325, 4)!
 
Enter command:
INSERT INTO PROJZEIT VALUES (3, 3, '22-JUN-93', 9325, 8)!
 
Enter command:
INSERT INTO PROJZEIT VALUES (3, 3, '23-JUN-93', 9325, 8)!
 
Enter command:
INSERT INTO PROJZEIT VALUES (3, 3, '24-JUN-93', 9325, 8)!
 
Enter command:
INSERT INTO PROJZEIT VALUES (3, 3, '25-JUN-93', 9325, 8)!
 
Enter command:
COMMIT WORK !
 
Enter command:
SELECT MITARBEITER.NAME,
       PROJEKT.ITS_NAME
  FROM MITARBEITER, PROJEKT_ZUORDNUNG, PROJEKT
 WHERE MITARBEITER.MA_ID = PROJEKT_ZUORDNUNG.MA_ID
   AND PROJEKT_ZUORDNUNG.PROJEKTID = PROJEKT.PROJEKTID
 AND (MITARBEITER.SOLL_STUNDEN * PROJEKT_ZUORDNUNG.ZEIT_ANTEIL_PROZENT)
        / 100
     > (SELECT NVL(SUM(PROJZEIT.STUNDEN), 0)
          FROM PROJZEIT
         WHERE PROJZEIT.MA_ID = MITARBEITER.MA_ID
           AND PROJZEIT.PROJEKTID = PROJEKT.PROJEKTID
           AND WOCHE = 9325)!
 
resultcount :                     0
 
Enter command:
FETCH INTO :MA, :PR !
 
NAME                           | ITS_NAME
-------------------------------+-------------------------------
Ladewig                        | Beratung IT Verlag
Schweiberger                   | Uebersetzung/Dokumentation
 
resultcount :                     2
 
Enter command:
COMMIT RELEASE !
 
Enter command:
FILE CONNECT ( KERN TEST  !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST   ISOLATION LEVEL 1 !
 
Enter command:
SELECT SOLL.MA_ID, SOLL.NAME, ITS_NAME, SOLL, GELEISTET
    FROM
    (SELECT FIXED (SUM (STUNDEN), 5,2) GELEISTET, MA_ID, PROJEKTID
       FROM PROJZEIT
       GROUP BY MA_ID, PROJEKTID
     UNION
     SELECT 0, MA_ID, PROJEKTID FROM PROJEKT_ZUORDNUNG WHERE
        CHR (MA_ID) || CHR (PROJEKTID) NOT IN
          (SELECT CHR(MA_ID) || CHR (PROJEKTID) FROM PROJZEIT)
    ) GELEISTET,
    (SELECT A.MA_ID, A.NAME, B.PROJEKTID, ITS_NAME,
       FIXED (SOLL_STUNDEN / 100 * ZEIT_ANTEIL_PROZENT, 5, 2) SOLL
                    FROM MITARBEITER A,
                    PROJEKT_ZUORDNUNG B,
                    PROJEKT WHERE A.MA_ID = B.MA_ID AND
                    B.PROJEKTID = PROJEKT.PROJEKTID) SOLL
WHERE
SOLL.MA_ID      = GELEISTET.MA_ID      AND
SOLL.PROJEKTID = GELEISTET.PROJEKTID AND
SOLL > GELEISTET !
 
resultcount :                     2
 
Enter command:
FETCH !
 
MA_ID             :     1
NAME              :  Ladewig
ITS_NAME          :  Beratung IT Verlag
SOLL              :    20.00
GELEISTET         :    16.00
---------------------------------------------------
MA_ID             :     2
NAME              :  Schweiberger
ITS_NAME          :  Uebersetzung/Dokumentation
SOLL              :     4.00
GELEISTET         :     0.00
 
resultcount :                     2
 
Enter command:
 
SELECT SOLL.MA_ID, SOLL.NAME, ITS_NAME, SOLL, GELEISTET
    FROM
    (SELECT A.MA_ID, A.NAME, B.PROJEKTID, ITS_NAME,
       FIXED (SOLL_STUNDEN / 100 * ZEIT_ANTEIL_PROZENT, 5, 2) SOLL
                    FROM MITARBEITER A,
                    PROJEKT_ZUORDNUNG B,
                    PROJEKT WHERE A.MA_ID = B.MA_ID AND
                    B.PROJEKTID = PROJEKT.PROJEKTID) SOLL,
    (SELECT FIXED (SUM (STUNDEN), 5,2) GELEISTET, MA_ID, PROJEKTID
       FROM PROJZEIT
       GROUP BY MA_ID, PROJEKTID
     UNION
     SELECT 0, MA_ID, PROJEKTID FROM PROJEKT_ZUORDNUNG WHERE
        CHR (MA_ID) || CHR (PROJEKTID) NOT IN
          (SELECT CHR(MA_ID) || CHR (PROJEKTID) FROM PROJZEIT)
    ) GELEISTET
WHERE
SOLL.MA_ID      = GELEISTET.MA_ID      AND
SOLL.PROJEKTID = GELEISTET.PROJEKTID AND
SOLL > GELEISTET !
 
resultcount :                     2
 
Enter command:
FETCH!
 
MA_ID             :     1
NAME              :  Ladewig
ITS_NAME          :  Beratung IT Verlag
SOLL              :    20.00
GELEISTET         :    16.00
---------------------------------------------------
MA_ID             :     2
NAME              :  Schweiberger
ITS_NAME          :  Uebersetzung/Dokumentation
SOLL              :     4.00
GELEISTET         :     0.00
 
resultcount :                     2
 
Enter command:
 
SELECT SOLL.MA_ID, SOLL.NAME, ITS_NAME, SOLL, GELEISTET
    FROM
    (SELECT A.MA_ID, A.NAME, B.PROJEKTID, ITS_NAME,
       FIXED (SOLL_STUNDEN / 100 * ZEIT_ANTEIL_PROZENT, 5, 2) SOLL
                    FROM MITARBEITER A,
                    PROJEKT_ZUORDNUNG B,
                    PROJEKT WHERE A.MA_ID = B.MA_ID AND
                    B.PROJEKTID = PROJEKT.PROJEKTID) SOLL,
    (SELECT FIXED (SUM (STUNDEN), 5,2) GELEISTET, MA_ID, PROJEKTID
       FROM PROJZEIT
       GROUP BY MA_ID, PROJEKTID
     UNION
     SELECT 0, MA_ID, PROJEKTID FROM PROJEKT_ZUORDNUNG WHERE
        CHR (MA_ID) || CHR (PROJEKTID) NOT IN
          (SELECT CHR(MA_ID) || CHR (PROJEKTID) FROM PROJZEIT)
    ) GELEISTET
WHERE
SOLL.MA_ID      = GELEISTET.MA_ID      AND
SOLL.PROJEKTID = GELEISTET.PROJEKTID AND
SOLL > GELEISTET !
 
resultcount :                     2
 
Enter command:
FETCH !
 
MA_ID             :     1
NAME              :  Ladewig
ITS_NAME          :  Beratung IT Verlag
SOLL              :    20.00
GELEISTET         :    16.00
---------------------------------------------------
MA_ID             :     2
NAME              :  Schweiberger
ITS_NAME          :  Uebersetzung/Dokumentation
SOLL              :     4.00
GELEISTET         :     0.00
 
resultcount :                     2
 
Enter command:
 
DROP TABLE MITARBEITER !
 
Enter command:
DROP TABLE PROJEKT !
 
Enter command:
DROP TABLE PROJEKT_ZUORDNUNG!
 
Enter command:
DROP TABLE PROJZEIT!
 
Enter command:
COMMIT RELEASE !
 
Enter command:
FILE CONNECT ( KERN TEST !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST   ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE TAHEF
           (EJJ CHAR(2),
            AUS FIXED(5),
            OBJ FIXED(5),
            EMM CHAR(2),
            JJJ FIXED(5),
            HHH FIXED(5)) !
 
Enter command:
CREATE TABLE TAAGN
           (AGN FIXED(10),
            VBE FIXED(5),
            TX1 CHAR(30))!
 
Enter command:
CREATE TABLE TAWER
           (KDN FIXED(10),
            PRN FIXED(10),
            ANT FIXED(11),
            VOL FIXED(5),
            AUS FIXED(5),
            OBJ FIXED(5),
            AGN FIXED(10),
            JJJ FIXED(5),
            HHH FIXED(5))!
 
Enter command:
CREATE TABLE TAKP1
           (BRH FIXED(5),
            BRU FIXED(5),
            PRN FIXED(10),
            KDN FIXED(10))!
 
Enter command:
 
COMMIT WORK!
 
Enter command:
SELECT H.EJJ , H.AUS , H.OBJ , S.KDN , S.PRN , A.VBE , K.VBE , P.BRH ,
       P.BRU , S.ANT , S.VOL
 FROM TAHEF  H , TAWER  S , TAAGN  K , TAAGN  A , TAKP1  P
UNION ALL SELECT H.EJJ , H.AUS , H.OBJ , S.KDN , S.PRN ,     99 ,
  K.VBE , P.BRH , P.BRU , S.ANT , S.VOL
 FROM TAHEF  H , TAWER  S , TAAGN  K , TAKP1  P
 WHERE  NOT  EXISTS
   (SELECT  *  FROM TAAGN  A  WHERE A.AGN  = S.AGN )
UNION ALL SELECT H.EJJ , H.AUS , H.OBJ , S.KDN , S.PRN , A.VBE ,
 K.VBE ,   9999 ,     99 , S.ANT , S.VOL  FROM TAHEF  H , TAWER  S ,
 TAAGN  K , TAAGN  A
 WHERE  NOT  EXISTS
  (SELECT  *  FROM TAKP1  P
  WHERE P.KDN  = S.KDN  AND P.PRN  = S.PRN )
   UNION ALL SELECT H.EJJ , H.AUS , H.OBJ , S.KDN , S.PRN ,     99 ,
   K.VBE ,   9999 ,     99 , S.ANT , S.VOL
   FROM TAHEF  H , TAWER  S , TAAGN  K  WHERE NOT  EXISTS
  (SELECT  *  FROM TAAGN  A  WHERE A.AGN  = S.AGN )  AND  NOT  EXISTS
  (SELECT  *  FROM TAKP1  P  WHERE P.KDN  = S.KDN  AND P.PRN  = S.PRN )
  ORDER BY      4 ,      5 !
 
***ERROR    100 Row not found                                              0001
 
Enter command:
 
SELECT H.EJJ , H.AUS , H.OBJ , S.KDN , S.PRN , A.VBE , K.VBE , P.BRH ,
       P.BRU , S.ANT , S.VOL
 FROM TAHEF  H , TAWER  S , TAAGN  K , TAAGN  A , TAKP1  P
 WHERE  (H.OBJ  =      4 )  AND  (H.EJJ  = '92' )  AND  (H.EMM  = '01' )
  AND  (K.VBE  =      2 )  AND  (K.AGN  = S.KDN )  AND  (S.OBJ  = H.OBJ )
  AND  (S.AUS  = H.AUS )  AND  (S.JJJ  = H.JJJ )  AND  (S.HHH  = H.HHH )
  AND  (K.AGN  = S.KDN )  AND  (A.AGN  = S.AGN )  AND  (P.PRN  = S.PRN )
  AND  (P.KDN  = S.KDN )
UNION ALL SELECT H.EJJ , H.AUS , H.OBJ , S.KDN , S.PRN ,     99 ,
  K.VBE , P.BRH , P.BRU , S.ANT , S.VOL
 FROM TAHEF  H , TAWER  S , TAAGN  K , TAKP1  P
 WHERE  (H.OBJ  =    4 )
  AND  (H.EJJ  = '92' )  AND  (H.EMM  = '01' )  AND  (K.VBE  =      2 )
  AND  (K.AGN  = S.KDN )  AND  (S.OBJ  = H.OBJ )  AND  (S.AUS  = H.AUS )
  AND  (S.JJJ  = H.JJJ )  AND  (S.HHH  = H.HHH )  AND  (P.PRN  = S.PRN )
  AND  (P.KDN  = S.KDN )  AND  NOT  EXISTS
   (SELECT  *  FROM TAAGN  A  WHERE A.AGN  = S.AGN )
UNION ALL SELECT H.EJJ , H.AUS , H.OBJ , S.KDN , S.PRN , A.VBE ,
 K.VBE ,   9999 ,     99 , S.ANT , S.VOL  FROM TAHEF  H , TAWER  S ,
 TAAGN  K , TAAGN  A
 WHERE  (H.OBJ  =      4 )  AND  (H.EJJ  = '92' )
  AND  (H.EMM  = '01' )  AND  (K.VBE  =      2 )  AND  (K.AGN  = S.KDN )
  AND  (S.OBJ  = H.OBJ )  AND  (S.AUS  = H.AUS )  AND  (S.JJJ  = H.JJJ )
  AND  (S.HHH  = H.HHH )  AND  (A.AGN  = S.AGN )  AND  NOT  EXISTS
  (SELECT  *  FROM TAKP1  P
  WHERE P.KDN  = S.KDN  AND P.PRN  = S.PRN )
   UNION ALL SELECT H.EJJ , H.AUS , H.OBJ , S.KDN , S.PRN ,     99 ,
   K.VBE ,   9999 ,     99 , S.ANT , S.VOL
   FROM TAHEF  H , TAWER  S , TAAGN  K  WHERE  (H.OBJ  =      4 )
  AND  (H.EJJ  = '92' )  AND  (H.EMM  = '01' )  AND  (K.VBE  =      2 )
  AND  (K.AGN  = S.KDN )  AND  (S.OBJ  = H.OBJ )  AND  (S.AUS  = H.AUS )
  AND  (S.JJJ  = H.JJJ )  AND  (S.HHH  = H.HHH )  AND  NOT  EXISTS
  (SELECT  *  FROM TAAGN  A  WHERE A.AGN  = S.AGN )  AND  NOT  EXISTS
  (SELECT  *  FROM TAKP1  P  WHERE P.KDN  = S.KDN  AND P.PRN  = S.PRN )
  ORDER BY      4 ,      5 !
 
***ERROR    100 Row not found                                              0001
 
Enter command:
 
 
 
SELECT H.EJJ , H.AUS , H.OBJ , S.KDN , S.PRN , A.VBE , K.VBE , P.BRH ,
       P.BRU , S.ANT , S.VOL
 FROM TAHEF  H , TAWER  S , TAAGN  K , TAAGN  A , TAKP1  P
 WHERE  (H.OBJ  =      4 )  AND  (H.EJJ  = '92' )  AND  (H.EMM  = '01' )
  AND  (K.VBE  =      2 )  AND  (K.AGN  = S.KDN )  AND  (S.OBJ  = H.OBJ )
  AND  (S.AUS  = H.AUS )  AND  (S.JJJ  = H.JJJ )  AND  (S.HHH  = H.HHH )
  AND  (K.AGN  = S.KDN )  AND  (A.AGN  = S.AGN )  AND  (P.PRN  = S.PRN )
  AND  (P.KDN  = S.KDN )
UNION ALL SELECT H.EJJ , H.AUS , H.OBJ , S.KDN , S.PRN ,     99 ,
  K.VBE , P.BRH , P.BRU , S.ANT , S.VOL
 FROM TAHEF  H , TAWER  S , TAAGN  K , TAKP1  P
 WHERE  (H.OBJ  =    4 )
  AND  (H.EJJ  = '92' )  AND  (H.EMM  = '01' )  AND  (K.VBE  =      2 )
  AND  (K.AGN  = S.KDN )  AND  (S.OBJ  = H.OBJ )  AND  (S.AUS  = H.AUS )
  AND  (S.JJJ  = H.JJJ )  AND  (S.HHH  = H.HHH )  AND  (P.PRN  = S.PRN )
  AND  (P.KDN  = S.KDN )  AND  NOT  EXISTS
   (SELECT  *  FROM TAAGN  A  WHERE A.AGN  = S.AGN )
UNION ALL SELECT H.EJJ , H.AUS , H.OBJ , S.KDN , S.PRN , A.VBE ,
 K.VBE ,   9999 ,     99 , S.ANT , S.VOL  FROM TAHEF  H , TAWER  S ,
 TAAGN  K , TAAGN  A
 WHERE  (H.OBJ  =      4 )  AND  (H.EJJ  = '92' )
  AND  (H.EMM  = '01' )  AND  (K.VBE  =      2 )  AND  (K.AGN  = S.KDN )
  AND  (S.OBJ  = H.OBJ )  AND  (S.AUS  = H.AUS )  AND  (S.JJJ  = H.JJJ )
  AND  (S.HHH  = H.HHH )  AND  (A.AGN  = S.AGN )  AND  NOT  EXISTS
  (SELECT  *  FROM TAKP1  P
  WHERE P.KDN  = S.KDN  AND P.PRN  = S.PRN )
   UNION ALL SELECT H.EJJ , H.AUS , H.OBJ , S.KDN , S.PRN ,     99 ,
   K.VBE ,   9999 ,     99 , S.ANT , S.VOL
   FROM TAHEF  H , TAWER  S , TAAGN  K  WHERE  (H.OBJ  =      4 )
  AND  (H.EJJ  = '92' )  AND  (H.EMM  = '01' )  AND  (K.VBE  =      2 )
  AND  (K.AGN  = S.KDN )  AND  (S.OBJ  = H.OBJ )  AND  (S.AUS  = H.AUS )
  AND  (S.JJJ  = H.JJJ )  AND  (S.HHH  = H.HHH )  AND  NOT  EXISTS
  (SELECT  *  FROM TAAGN  A  WHERE A.AGN  = S.AGN )  AND  NOT  EXISTS
  (SELECT  *  FROM TAKP1  P  WHERE P.KDN  = S.KDN  AND P.PRN  = S.PRN )
  ORDER BY      4 ,      5 !
 
***ERROR    100 Row not found                                              0001
 
Enter command:
DROP TABLE TAHEF  !
 
Enter command:
DROP TABLE TAAGN  !
 
Enter command:
DROP TABLE TAWER  !
 
Enter command:
DROP TABLE TAKP1  !
 
Enter command:
COMMIT RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST   ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE FLUEGE
 (FLUG_NR       FIXED(3) KEY,
  GES_PLAETZE   FIXED(3) NOT NULL,
  VERF_PLAETZE  FIXED(3) NOT NULL)!
 
Enter command:
INSERT INTO FLUEGE VALUES (1, 200, 5)!
 
Enter command:
INSERT INTO FLUEGE VALUES (2, 300, 3)!
 
Enter command:
INSERT INTO FLUEGE VALUES (3, 450, 4)!
 
Enter command:
CREATE TABLE BUCHUNGEN
 (ID      FIXED (5) KEY,
  FLUG_NR FIXED(3) NOT NULL REFERENCES FLUEGE,
  NAME    CHAR (20) NOT NULL)!
 
Enter command:
INSERT INTO BUCHUNGEN VALUES ( 3, 3, 'Albrecht')!
 
Enter command:
INSERT INTO BUCHUNGEN VALUES (10, 1, 'Baader')!
 
Enter command:
INSERT INTO BUCHUNGEN VALUES (11, 1, 'Chall')!
 
Enter command:
INSERT INTO BUCHUNGEN VALUES ( 4, 1, 'Hansen')!
 
Enter command:
INSERT INTO BUCHUNGEN VALUES ( 1, 1, 'Jonas')!
 
Enter command:
INSERT INTO BUCHUNGEN VALUES ( 6, 3, 'Kauffmann')!
 
Enter command:
INSERT INTO BUCHUNGEN VALUES ( 7, 2, 'Lindemann')!
 
Enter command:
INSERT INTO BUCHUNGEN VALUES ( 8, 1, 'Linke')!
 
Enter command:
INSERT INTO BUCHUNGEN VALUES ( 2, 2, 'Medinger')!
 
Enter command:
INSERT INTO BUCHUNGEN VALUES ( 5, 2, 'Weiss')!
 
Enter command:
INSERT INTO BUCHUNGEN VALUES ( 9, 2, 'Weyhausen')!
 
Enter command:
SELECT A.FLUG_NR, A.NAME
  FROM BUCHUNGEN A, FLUEGE
 WHERE A.FLUG_NR = FLUEGE.FLUG_NR
   AND VERF_PLAETZE >=
           (SELECT COUNT(*)
              FROM BUCHUNGEN
             WHERE BUCHUNGEN.ID <= A.ID
               AND BUCHUNGEN.FLUG_NR = A.FLUG_NR)
 ORDER BY A.FLUG_NR, ID !
 
resultcount :                    10
 
Enter command:
FETCH !
 
FLUG_NR | NAME
--------+---------------------
   1    | Jonas
   1    | Hansen
   1    | Linke
   1    | Baader
   1    | Chall
   2    | Medinger
   2    | Weiss
   2    | Lindemann
   3    | Albrecht
   3    | Kauffmann
 
resultcount :                    10
 
Enter command:
DROP TABLE FLUEGE !
 
Enter command:
DROP TABLE BUCHUNGEN !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST   ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE RECHNUNGEN (RENR FIXED (4) KEY,
                         KDNR FIXED (4) NOT NULL,
                       BETRAG FIXED(9,2) NOT NULL)!
 
Enter command:
INSERT INTO RECHNUNGEN VALUES (1, 1, 1000)!
 
Enter command:
INSERT INTO RECHNUNGEN VALUES (2, 2, 1000)!
 
Enter command:
INSERT INTO RECHNUNGEN VALUES (3, 3, 1000)!
 
Enter command:
INSERT INTO RECHNUNGEN VALUES (4, 4, 1000)!
 
Enter command:
INSERT INTO RECHNUNGEN VALUES (5, 2, 2000)!
 
Enter command:
INSERT INTO RECHNUNGEN VALUES (6, 1, 3000)!
 
Enter command:
INSERT INTO RECHNUNGEN VALUES (7, 2, 1000)!
 
Enter command:
SELECT A.KDNR, A.RENR, A.BETRAG BETRAG,
       A.BETRAG / SUM (B.BETRAG) * 100 PROZENT
FROM RECHNUNGEN A, RECHNUNGEN B
GROUP BY A.KDNR, A.RENR, A.BETRAG !
 
resultcount :                     7
 
Enter command:
FETCH !
 
KDNR  | RENR  | BETRAG      | PROZENT
------+-------+-------------+---------------------------------------------
    1 |     1 |     1000.00 |  1.0000000000000000000000000000000000000E+01
    1 |     6 |     3000.00 |  3.0000000000000000000000000000000000000E+01
    2 |     2 |     1000.00 |  1.0000000000000000000000000000000000000E+01
    2 |     5 |     2000.00 |  2.0000000000000000000000000000000000000E+01
    2 |     7 |     1000.00 |  1.0000000000000000000000000000000000000E+01
    3 |     3 |     1000.00 |  1.0000000000000000000000000000000000000E+01
    4 |     4 |     1000.00 |  1.0000000000000000000000000000000000000E+01
 
resultcount :                     7
 
Enter command:
SELECT A.KDNR,
       FLOAT(SUM (A.BETRAG) / COUNT (DISTINCT B.RENR),18) BETRAG,
       FLOAT(SUM (A.BETRAG) / COUNT (DISTINCT B.RENR) /
      (SUM (B.BETRAG) / COUNT (DISTINCT A.RENR)) * 100,18) PROZENT
FROM RECHNUNGEN A, RECHNUNGEN B
GROUP BY A.KDNR !
 
resultcount :                     4
 
Enter command:
FETCH!
 
KDNR  | BETRAG                   | PROZENT
------+--------------------------+-------------------------
    1 |  4.00000000000000000E+03 |  4.00000000000000000E+01
    2 |  4.00000000000000000E+03 |  4.00000000000000000E+01
    3 |  1.00000000000000000E+03 |  1.00000000000000000E+01
    4 |  1.00000000000000000E+03 |  1.00000000000000000E+01
 
resultcount :                     4
 
Enter command:
SELECT A.KDNR,
       FLOAT(SUM (A.BETRAG), 18),
       FLOAT(SUM (A.BETRAG) / SUM(B.SUMBETRAG) * 100, 18) PROZENT
FROM RECHNUNGEN A,
     (SELECT SUM (BETRAG) SUMBETRAG
      FROM RECHNUNGEN) B
GROUP BY A.KDNR !
 
resultcount :                     4
 
Enter command:
FETCH!
 
KDNR  | EXPRESSION1              | PROZENT
------+--------------------------+-------------------------
    1 |  4.00000000000000000E+03 |  2.00000000000000000E+01
    2 |  4.00000000000000000E+03 |  1.33333333333333333E+01
    3 |  1.00000000000000000E+03 |  1.00000000000000000E+01
    4 |  1.00000000000000000E+03 |  1.00000000000000000E+01
 
resultcount :                     4
 
Enter command:
SELECT A.KDNR,
       FLOAT(SUM (A.BETRAG), 18),
       FLOAT(SUM (A.BETRAG) / B.SUMBETRAG * 100, 18) PROZENT
FROM RECHNUNGEN A,
     (SELECT SUM (BETRAG) SUMBETRAG
      FROM RECHNUNGEN) B
GROUP BY A.KDNR, B.SUMBETRAG !
 
resultcount :                     4
 
Enter command:
FETCH!
 
KDNR  | EXPRESSION1              | PROZENT
------+--------------------------+-------------------------
    1 |  4.00000000000000000E+03 |  4.00000000000000000E+01
    2 |  4.00000000000000000E+03 |  4.00000000000000000E+01
    3 |  1.00000000000000000E+03 |  1.00000000000000000E+01
    4 |  1.00000000000000000E+03 |  1.00000000000000000E+01
 
resultcount :                     4
 
Enter command:
SELECT A.KDNR,
       FIXED(SUM (A.BETRAG), 10) BETRAG,
       FIXED(SUM (A.BETRAG) / B.SUMBETRAG * 100, 3) PROZENT
FROM RECHNUNGEN A,
     (SELECT SUM (BETRAG) SUMBETRAG
      FROM RECHNUNGEN) B
GROUP BY A.KDNR, B.SUMBETRAG !
 
resultcount :                     4
 
Enter command:
FETCH!
 
KDNR  | BETRAG      | PROZENT
------+-------------+--------
    1 |        4000 |   40
    2 |        4000 |   40
    3 |        1000 |   10
    4 |        1000 |   10
 
resultcount :                     4
 
Enter command:
DROP TABLE RECHNUNGEN!
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST SQLMODE ORACLE !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE ORACLE ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE LAGER_FREI (
REGAL     NUMBER (3) NOT NULL,
FREI_VON  NUMBER (4) NOT NULL,
FREI_BIS  NUMBER (4) NOT NULL,
CHECK (FREI_VON < FREI_BIS),
PRIMARY KEY (REGAL, FREI_VON)) !
 
Enter command:
INSERT INTO LAGER_FREI VALUES (1,  25,3767)!
 
Enter command:
INSERT INTO LAGER_FREI VALUES (1,4234,4965)!
 
Enter command:
INSERT INTO LAGER_FREI VALUES (1,5001,5010)!
 
Enter command:
INSERT INTO LAGER_FREI VALUES (2, 702, 711)!
 
Enter command:
INSERT INTO LAGER_FREI VALUES (1,8001,8029)!
 
Enter command:
INSERT INTO LAGER_FREI VALUES (2,   1,  23)!
 
Enter command:
INSERT INTO LAGER_FREI VALUES (3,  25, 234)!
 
Enter command:
INSERT INTO LAGER_FREI VALUES (2,  55, 600)!
 
Enter command:
INSERT INTO LAGER_FREI VALUES (2, 800,7000)!
 
Enter command:
INSERT INTO LAGER_FREI VALUES (3, 255, 900)!
 
Enter command:
INSERT INTO LAGER_FREI VALUES (1,   1,  23)!
 
Enter command:
INSERT INTO LAGER_FREI VALUES (3,1002,7000)!
 
Enter command:
INSERT INTO LAGER_FREI VALUES (3, 921, 943)!
 
Enter command:
COMMIT WORK RELEASE!
 
Enter command:
 
FILE CONNECT ( KERN TEST SQLMODE ORACLE !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE ORACLE ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE TABLES
  (NAME         VARCHAR (30) PRIMARY KEY,
   STORAGE_SIZE NUMBER) !
 
Enter command:
INSERT INTO TABLES VALUES ('KONTO'  , 1000)!
 
Enter command:
INSERT INTO TABLES VALUES ('ARTIKEL', 1000)!
 
Enter command:
COMMIT !
 
Enter command:
CREATE TABLE INDEXES
  (NAME        VARCHAR2 (30) PRIMARY KEY,
   TABLE_NAME  VARCHAR2 (30) NOT NULL REFERENCES TABLES,
   UNIQUE_FLAG VARCHAR2 ( 4) NOT NULL
                      CHECK (UNIQUE_FLAG IN ('YES', 'NO'))) !
 
Enter command:
INSERT INTO INDEXES VALUES ('KT01', 'KONTO'  , 'YES')!
 
Enter command:
INSERT INTO INDEXES VALUES ('KT02', 'KONTO'  , 'YES')!
 
Enter command:
INSERT INTO INDEXES VALUES ('KT03', 'KONTO'  , 'YES')!
 
Enter command:
INSERT INTO INDEXES VALUES ('KT04', 'KONTO'  , 'YES')!
 
Enter command:
INSERT INTO INDEXES VALUES ('ART1', 'ARTIKEL', 'YES')!
 
Enter command:
INSERT INTO INDEXES VALUES ('ART2', 'ARTIKEL', 'YES')!
 
Enter command:
INSERT INTO INDEXES VALUES ('ART3', 'ARTIKEL', 'YES')!
 
Enter command:
INSERT INTO INDEXES VALUES ('ART4', 'ARTIKEL', 'YES')!
 
Enter command:
COMMIT !
 
Enter command:
CREATE TABLE INDEX_COLUMNS
  (INDEX_NAME      VARCHAR2 (30) REFERENCES INDEXES,
   COLUMN_NAME     VARCHAR2 (30) NOT NULL,
   COLUMN_POSITION NUMBER NOT NULL
                          CHECK (COLUMN_POSITION > 0),
   PRIMARY KEY (INDEX_NAME, COLUMN_NAME),
   CONSTRAINT C1_INDEX_NAME UNIQUE (INDEX_NAME, COLUMN_POSITION)) !
 
Enter command:
INSERT INTO INDEX_COLUMNS VALUES ('KT01', 'COL1', 1)!
 
Enter command:
INSERT INTO INDEX_COLUMNS VALUES ('KT02', 'COL1', 1)!
 
Enter command:
INSERT INTO INDEX_COLUMNS VALUES ('KT02', 'COL2', 2)!
 
Enter command:
INSERT INTO INDEX_COLUMNS VALUES ('KT03', 'COL1', 1)!
 
Enter command:
INSERT INTO INDEX_COLUMNS VALUES ('KT03', 'COL2', 2)!
 
Enter command:
INSERT INTO INDEX_COLUMNS VALUES ('KT03', 'COL3', 3)!
 
Enter command:
INSERT INTO INDEX_COLUMNS VALUES ('KT04', 'COL3', 1)!
 
Enter command:
INSERT INTO INDEX_COLUMNS VALUES ('KT04', 'COL4', 2)!
 
Enter command:
INSERT INTO INDEX_COLUMNS VALUES ('ART1', 'COLA', 1)!
 
Enter command:
INSERT INTO INDEX_COLUMNS VALUES ('ART1', 'COLB', 2)!
 
Enter command:
INSERT INTO INDEX_COLUMNS VALUES ('ART2', 'COLB', 1)!
 
Enter command:
INSERT INTO INDEX_COLUMNS VALUES ('ART2', 'COLC', 2)!
 
Enter command:
INSERT INTO INDEX_COLUMNS VALUES ('ART3', 'COLC', 1)!
 
Enter command:
INSERT INTO INDEX_COLUMNS VALUES ('ART3', 'COLD', 2)!
 
Enter command:
INSERT INTO INDEX_COLUMNS VALUES ('ART4', 'COLC', 1)!
 
Enter command:
INSERT INTO INDEX_COLUMNS VALUES ('ART4', 'COLD', 2)!
 
Enter command:
INSERT INTO INDEX_COLUMNS VALUES ('ART4', 'COLE', 3)!
 
Enter command:
INSERT INTO INDEX_COLUMNS VALUES ('ART4', 'COLF', 4)!
 
Enter command:
COMMIT !
 
Enter command:
SELECT SUBSTR(I1.TABLE_NAME, 1, 10),
       SUBSTR(I1.NAME, 1, 10),
       SUBSTR(I2.NAME, 1, 10)
  FROM INDEXES I1, INDEXES I2
 WHERE I1.TABLE_NAME = I2.TABLE_NAME
   AND I1.NAME <> I2.NAME
   AND NOT EXISTS
           (SELECT COLUMN_NAME, COLUMN_POSITION
              FROM INDEX_COLUMNS C1
             WHERE I2.NAME = C1.INDEX_NAME
           MINUS
           SELECT COLUMN_NAME, COLUMN_POSITION
             FROM INDEX_COLUMNS C2
            WHERE I1.NAME = C2.INDEX_NAME) !
 
***ERROR  -7011 Correlated subquery not allowed                            0255
 
Enter command:
FETCH INTO :A, :B, :C!
 
***ERROR  -4000 Unknown result table                                       0001
 
Enter command:
SELECT SUBSTR(I1.TABLE_NAME, 1, 10),
       SUBSTR(I1.NAME, 1, 10),
       SUBSTR(I2.NAME, 1, 10)
  FROM INDEXES I1, INDEXES I2
 WHERE I1.TABLE_NAME = I2.TABLE_NAME
   AND I1.NAME <> I2.NAME
   AND NOT EXISTS
           (SELECT *
              FROM INDEX_COLUMNS IC1
             WHERE IC1.INDEX_NAME = I2.NAME
               AND NOT EXISTS
                       (SELECT *
                          FROM INDEX_COLUMNS IC2
                         WHERE IC2.INDEX_NAME = I1.NAME
                           AND IC1.COLUMN_NAME = IC2.COLUMN_NAME)) !
 
resultcount :                     0
 
Enter command:
FETCH INTO :A, :B, :C!
 
EXPRESSION1 | EXPRESSION2 | EXPRESSION3
------------+-------------+------------
ARTIKEL     | ART4        | ART3
KONTO       | KT02        | KT01
KONTO       | KT03        | KT01
KONTO       | KT03        | KT02
 
resultcount :                     4
 
Enter command:
SELECT SUBSTR(I1.TABLE_NAME, 1, 10),
       SUBSTR(I2.NAME, 1, 10),
       SUBSTR(I1.NAME, 1, 10)
  FROM INDEXES I1,
       INDEXES I2,
       INDEX_COLUMNS IC1
 WHERE I1.TABLE_NAME = I2.TABLE_NAME
   AND I1.NAME = IC1.INDEX_NAME
   AND I1.NAME <> I2.NAME
   AND IC1.COLUMN_POSITION =
                (SELECT COUNT(*)
                   FROM INDEX_COLUMNS
                  WHERE INDEX_NAME = I1.NAME)
   AND IC1.COLUMN_POSITION =
                (SELECT COUNT(*)
                   FROM INDEX_COLUMNS IC2,
                        INDEX_COLUMNS IC3
                  WHERE IC2.INDEX_NAME = I1.NAME
                    AND IC3.INDEX_NAME = I2.NAME
                    AND IC2.COLUMN_NAME = IC3.COLUMN_NAME
                    AND IC2.COLUMN_POSITION = IC3.COLUMN_POSITION) !
 
resultcount :                     0
 
Enter command:
FETCH INTO :A, :B, :C!
 
EXPRESSION1 | EXPRESSION2 | EXPRESSION3
------------+-------------+------------
ARTIKEL     | ART4        | ART3
KONTO       | KT02        | KT01
KONTO       | KT03        | KT01
KONTO       | KT03        | KT02
 
resultcount :                     4
 
Enter command:
DROP TABLE TABLES !
 
Enter command:
DROP TABLE INDEXES !
 
Enter command:
DROP TABLE INDEX_COLUMNS !
 
Enter command:
COMMIT RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST SQLMODE ORACLE !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE ORACLE ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE BUECHER
   (BUCH_NR NUMBER PRIMARY KEY,
    TITEL   VARCHAR (30) NOT NULL,
    AUTOR   VARCHAR (30) NOT NULL)!
 
Enter command:
INSERT INTO BUECHER VALUES (1, 'ORACLE7'         , 'G. Stuerner')!
 
Enter command:
INSERT INTO BUECHER VALUES (2, 'INFORMIX 6.0/7.1', 'D. Petkovic')!
 
Enter command:
INSERT INTO BUECHER VALUES (3, 'SYBASE'          , 'D. McGoveran')!
 
Enter command:
COMMIT !
 
Enter command:
CREATE TABLE LESER
   (LESER_NR NUMBER PRIMARY KEY,
    NAME     VARCHAR (30) NOT NULL) !
 
Enter command:
INSERT INTO LESER VALUES (1, 'H. Kohl')!
 
Enter command:
INSERT INTO LESER VALUES (2, 'B. Clinton')!
 
Enter command:
INSERT INTO LESER VALUES (3, 'B. Jelzin')!
 
Enter command:
COMMIT !
 
Enter command:
CREATE TABLE AUSLEIHE
   (BUCH_NR  NUMBER REFERENCES BUECHER,
    LESER_NR NUMBER REFERENCES LESER,
    EIN_AUS  CHAR (3) NOT NULL
                 CHECK (EIN_AUS IN ('EIN', 'AUS')),
    DATUM    DATE NOT NULL,
    PRIMARY KEY (BUCH_NR, DATUM))!
 
Enter command:
COMMIT RELEASE !
 
Enter command:
FILE CONNECT ( KERN TEST !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST   ISOLATION LEVEL 1 !
 
Enter command:
INSERT INTO AUSLEIHE VALUES (3, 3, 'AUS', '19950609000000')!
 
Enter command:
INSERT INTO AUSLEIHE VALUES (2, 2, 'AUS', '19950611000000')!
 
Enter command:
INSERT INTO AUSLEIHE VALUES (1, 1, 'AUS', '19950612000000')!
 
Enter command:
INSERT INTO AUSLEIHE VALUES (3, 3, 'EIN', '19950613000000')!
 
Enter command:
INSERT INTO AUSLEIHE VALUES (1, 1, 'EIN', '19950615000000')!
 
Enter command:
INSERT INTO AUSLEIHE VALUES (1, 2, 'AUS', '19950617000000')!
 
Enter command:
INSERT INTO AUSLEIHE VALUES (2, 2, 'EIN', '19950618000000')!
 
Enter command:
INSERT INTO AUSLEIHE VALUES (2, 3, 'AUS', '19950619000000')!
 
Enter command:
INSERT INTO AUSLEIHE VALUES (3, 1, 'AUS', '19950619000000')!
 
Enter command:
INSERT INTO AUSLEIHE VALUES (1, 2, 'EIN', '19950622000000')!
 
Enter command:
INSERT INTO AUSLEIHE VALUES (2, 3, 'EIN', '19950627000000')!
 
Enter command:
INSERT INTO AUSLEIHE VALUES (3, 1, 'EIN', '19950630000000')!
 
Enter command:
COMMIT !
 
Enter command:
SELECT TITEL, NAME, AUS.EIN_AUS, EIN.EIN_AUS,
      DATEDIFF(EIN.DATUM, AUS.DATUM) DAUER
  FROM BUECHER, LESER, AUSLEIHE AUS, AUSLEIHE EIN
 WHERE BUECHER.BUCH_NR = AUS.BUCH_NR
   AND LESER.LESER_NR  = AUS.LESER_NR
   AND AUS.BUCH_NR     = EIN.BUCH_NR
   AND AUS.LESER_NR    = EIN.LESER_NR
   AND AUS.EIN_AUS     = 'AUS'
   AND EIN.EIN_AUS     = 'EIN'
   AND EIN.DATUM = (SELECT MIN (DATUM)
                      FROM AUSLEIHE
                     WHERE AUSLEIHE.EIN_AUS  = 'EIN'
                       AND AUSLEIHE.BUCH_NR  = AUS.BUCH_NR
                       AND AUSLEIHE.LESER_NR = AUS.LESER_NR
                       AND AUSLEIHE.DATUM    > AUS.DATUM) !
 
resultcount :                     6
 
Enter command:
FETCH!
 
TITEL             :  ORACLE7
NAME              :  H. Kohl
EIN_AUS           :  AUS
EIN_AUS           :  EIN
DAUER             :         3
---------------------------------------------------
TITEL             :  ORACLE7
NAME              :  B. Clinton
EIN_AUS           :  AUS
EIN_AUS           :  EIN
DAUER             :         5
---------------------------------------------------
TITEL             :  INFORMIX 6.0/7.1
NAME              :  B. Clinton
EIN_AUS           :  AUS
EIN_AUS           :  EIN
DAUER             :         7
---------------------------------------------------
TITEL             :  INFORMIX 6.0/7.1
NAME              :  B. Jelzin
EIN_AUS           :  AUS
EIN_AUS           :  EIN
DAUER             :         8
---------------------------------------------------
TITEL             :  SYBASE
NAME              :  H. Kohl
EIN_AUS           :  AUS
EIN_AUS           :  EIN
DAUER             :        11
---------------------------------------------------
TITEL             :  SYBASE
NAME              :  B. Jelzin
EIN_AUS           :  AUS
EIN_AUS           :  EIN
DAUER             :         4
 
resultcount :                     6
 
Enter command:
DROP TABLE BUECHER !
 
Enter command:
DROP TABLE LESER !
 
Enter command:
DROP TABLE AUSLEIHE !
 
Enter command:
COMMIT RELEASE!
 
Enter command:
 
FILE CONNECT ( KERN TEST SQLMODE INTERNAL !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE INTERNAL ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE ARTIKEL (
NUMMER      INTEGER PRIMARY KEY,
BEZEICHNUNG VARCHAR(30))!
 
Enter command:
INSERT INTO ARTIKEL VALUES (1, 'Bier')!
 
Enter command:
INSERT INTO ARTIKEL VALUES (2, 'Wein')!
 
Enter command:
CREATE TABLE PREIS (
NUMMER      INTEGER,
START_DATUM DATE,
PREIS       FIXED(10,2) NOT NULL,
PRIMARY KEY (NUMMER, START_DATUM),
FOREIGN KEY (NUMMER) REFERENCES ARTIKEL)!
 
Enter command:
INSERT INTO PREIS VALUES (1, '19950101', 1.20)!
 
Enter command:
INSERT INTO PREIS VALUES (1, '19950201', 1.30)!
 
Enter command:
INSERT INTO PREIS VALUES (1, '19950301', 1.50)!
 
Enter command:
INSERT INTO PREIS VALUES (1, '19950601', 1.90)!
 
Enter command:
INSERT INTO PREIS VALUES (2, '19950101', 1.90)!
 
Enter command:
INSERT INTO PREIS VALUES (2, '19950401', 1.50)!
 
Enter command:
INSERT INTO PREIS VALUES (2, '19951101', 2.10)!
 
Enter command:
CREATE TABLE VERKAUF (
NUMMER      INTEGER,
DATUM       DATE,
ANZAHL      INTEGER NOT NULL,
PRIMARY KEY (NUMMER, DATUM),
FOREIGN KEY (NUMMER) REFERENCES ARTIKEL)!
 
Enter command:
INSERT INTO VERKAUF VALUES (1, '19950120',  20)!
 
Enter command:
INSERT INTO VERKAUF VALUES (1, '19950311',  20)!
 
Enter command:
INSERT INTO VERKAUF VALUES (2, '19950514', 345)!
 
Enter command:
INSERT INTO VERKAUF VALUES (1, '19950811',  55)!
 
Enter command:
INSERT INTO VERKAUF VALUES (2, '19950214',  55)!
 
Enter command:
INSERT INTO VERKAUF VALUES (2, '19951014', 345)!
 
Enter command:
SELECT A.BEZEICHNUNG,
       FIXED(SUM(P.PREIS * V.ANZAHL), 8,2) SUMME
  FROM ARTIKEL A, VERKAUF V, PREIS P
 WHERE A.NUMMER = V.NUMMER
   AND V.NUMMER = P.NUMMER
   AND P.START_DATUM =
                     (SELECT MAX (PR.START_DATUM)
                        FROM PREIS PR
                       WHERE PR.NUMMER = V.NUMMER
                         AND PR.START_DATUM <= V.DATUM)
GROUP BY A.BEZEICHNUNG !
 
resultcount :                     2
 
Enter command:
FETCH INTO :A, :B !
 
BEZEICHNUNG                    | SUMME
-------------------------------+-----------
Bier                           |     158.50
Wein                           |    1139.50
 
resultcount :                     2
 
Enter command:
SELECT A.BEZEICHNUNG,
       FIXED(SUM(P.PREIS * V.ANZAHL), 8,2) SUMME
  FROM ARTIKEL A, VERKAUF V, PREIS P
 WHERE A.NUMMER = V.NUMMER
   AND V.NUMMER = P.NUMMER
   AND P.START_DATUM <= V.DATUM
   AND NOT EXISTS (SELECT 1
                     FROM PREIS PR
                    WHERE PR.NUMMER = V.NUMMER
                      AND PR.START_DATUM > P.START_DATUM
                      AND PR.START_DATUM <= V.DATUM)
GROUP BY A.BEZEICHNUNG !
 
resultcount :                     2
 
Enter command:
FETCH INTO :A, :B !
 
BEZEICHNUNG                    | SUMME
-------------------------------+-----------
Bier                           |     158.50
Wein                           |    1139.50
 
resultcount :                     2
 
Enter command:
DROP TABLE ARTIKEL !
 
Enter command:
DROP TABLE PREIS !
 
Enter command:
DROP TABLE VERKAUF !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST SQLMODE INTERNAL !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE INTERNAL ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE PERSONAL (
ID   INTEGER PRIMARY KEY,
NAME VARCHAR (10))!
 
Enter command:
INSERT INTO PERSONAL VALUES (1, 'Ofer')!
 
Enter command:
INSERT INTO PERSONAL VALUES (2, 'Hansen')!
 
Enter command:
INSERT INTO PERSONAL VALUES (3, 'Meyer')!
 
Enter command:
INSERT INTO PERSONAL VALUES (4, 'Albrecht')!
 
Enter command:
INSERT INTO PERSONAL VALUES (5, 'Linke')!
 
Enter command:
CREATE TABLE RENTE (
ID     INTEGER REFERENCES PERSONAL,
JAHR   INTEGER,
MONATE INTEGER NOT NULL CHECK (MONATE BETWEEN 1 AND 12),
LOHN   INTEGER NOT NULL,
PRIMARY KEY (ID, JAHR))!
 
Enter command:
INSERT INTO RENTE VALUES (1, 1989,  2, 1500)!
 
Enter command:
INSERT INTO RENTE VALUES (2, 1989, 12, 2200)!
 
Enter command:
INSERT INTO RENTE VALUES (4, 1989,  3, 1200)!
 
Enter command:
INSERT INTO RENTE VALUES (3, 1989,  2, 1700)!
 
Enter command:
INSERT INTO RENTE VALUES (2, 1990, 12, 2300)!
 
Enter command:
INSERT INTO RENTE VALUES (3, 1990,  2, 1900)!
 
Enter command:
INSERT INTO RENTE VALUES (4, 1990,  3, 1400)!
 
Enter command:
INSERT INTO RENTE VALUES (2, 1991, 12, 2400)!
 
Enter command:
INSERT INTO RENTE VALUES (1, 1992,  2, 2100)!
 
Enter command:
INSERT INTO RENTE VALUES (4, 1992,  3, 1900)!
 
Enter command:
INSERT INTO RENTE VALUES (3, 1992,  2, 2100)!
 
Enter command:
INSERT INTO RENTE VALUES (2, 1992, 12, 2500)!
 
Enter command:
INSERT INTO RENTE VALUES (1, 1993,  2, 2200)!
 
Enter command:
INSERT INTO RENTE VALUES (4, 1993,  3, 2100)!
 
Enter command:
INSERT INTO RENTE VALUES (5, 1993,  6, 3000)!
 
Enter command:
INSERT INTO RENTE VALUES (2, 1993, 12, 2600)!
 
Enter command:
INSERT INTO RENTE VALUES (1, 1994,  2, 2300)!
 
Enter command:
INSERT INTO RENTE VALUES (2, 1994, 12, 2700)!
 
Enter command:
INSERT INTO RENTE VALUES (3, 1994,  2, 2300)!
 
Enter command:
SELECT P.NAME, FIXED(MIN(R1.JAHR),4,0) BEG,
       FIXED(MAX(R1.JAHR),4,0) ENDE,
       FIXED(SUM(R1.MONATE),4,0) SUM_MONATE,
       FIXED(SUM(R1.LOHN * R1.MONATE) / SUM(R1.MONATE), 6,0) AVG_LOHN
  FROM RENTE R1, PERSONAL P
 WHERE R1.ID = P.ID
   AND R1.JAHR >= (SELECT MIN (R2.JAHR)
                     FROM RENTE R2
                    WHERE R1.ID = R2.ID
                      AND EXISTS
                               (SELECT COUNT(*)
                                  FROM RENTE R3
                                 WHERE R1.ID = R3.ID
                                   AND R2.JAHR <= R3.JAHR
                                GROUP BY R3.ID
                                HAVING COUNT(R3.JAHR) =
                                     MAX(R3.JAHR) - R2.JAHR + 1
                                   AND SUM(R3.MONATE) >= 6)
                 )
GROUP BY P.NAME !
 
resultcount :                     4
 
Enter command:
FETCH INTO :A, :B, :C, :D, :E !
 
NAME       | BEG   | ENDE  | SUM_MONATE | AVG_LOHN
-----------+-------+-------+------------+---------
Albrecht   |  1992 |  1993 |     6      |    2000
Hansen     |  1989 |  1994 |    72      |    2450
Linke      |  1993 |  1993 |     6      |    3000
Ofer       |  1992 |  1994 |     6      |    2200
 
resultcount :                     4
 
Enter command:
SELECT P.NAME, FIXED(MIN(R1.JAHR),4,0) BEG,
       FIXED(MAX(R1.JAHR),4,0) ENDE,
       FIXED(SUM(R1.MONATE),4,0) SUM_MONATE,
       FIXED(SUM(R1.LOHN * R1.MONATE) / SUM(R1.MONATE), 6,0) AVG_LOHN
  FROM RENTE R1, PERSONAL P
 WHERE R1.ID = P.ID
   AND (  R1.JAHR IN (SELECT R2.JAHR + 1
                        FROM RENTE R2
                       WHERE R1.ID = R2.ID)
        OR
          R1.JAHR IN (SELECT R3.JAHR - 1
                        FROM RENTE R3
                       WHERE R1.ID = R3.ID)
        OR
          R1.MONATE >= 6)
GROUP BY P.NAME, R1.ID
HAVING SUM(MONATE) >= 6 !
 
resultcount :                     4
 
Enter command:
FETCH INTO :A, :B, :C, :D, :E !
 
NAME       | BEG   | ENDE  | SUM_MONATE | AVG_LOHN
-----------+-------+-------+------------+---------
Albrecht   |  1989 |  1993 |    12      |    1650
Hansen     |  1989 |  1994 |    72      |    2450
Linke      |  1993 |  1993 |     6      |    3000
Ofer       |  1992 |  1994 |     6      |    2200
 
resultcount :                     4
 
Enter command:
DROP TABLE RENTE !
 
Enter command:
DROP TABLE PERSONAL !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST SQLMODE INTERNAL !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE INTERNAL ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE ARTIKEL (
ARTIKEL_NR  INTEGER PRIMARY KEY,
BEZEICHNUNG VARCHAR(12) NOT NULL)!
 
Enter command:
INSERT INTO ARTIKEL VALUES (1, 'Brot')!
 
Enter command:
INSERT INTO ARTIKEL VALUES (2, 'Fisch')!
 
Enter command:
INSERT INTO ARTIKEL VALUES (3, 'Nudeln')!
 
Enter command:
INSERT INTO ARTIKEL VALUES (4, 'Milch')!
 
Enter command:
INSERT INTO ARTIKEL VALUES (5, 'Tomatensosse')!
 
Enter command:
CREATE TABLE SCANNER_HEADER (
BON_ID  INTEGER PRIMARY KEY,
DATUM   DATE NOT NULL) !
 
Enter command:
INSERT INTO SCANNER_HEADER VALUES (1, '19951220')!
 
Enter command:
INSERT INTO SCANNER_HEADER VALUES (2, '19951220')!
 
Enter command:
INSERT INTO SCANNER_HEADER VALUES (3, '19951220')!
 
Enter command:
INSERT INTO SCANNER_HEADER VALUES (4, '19951220')!
 
Enter command:
INSERT INTO SCANNER_HEADER VALUES (5, '19951220')!
 
Enter command:
INSERT INTO SCANNER_HEADER VALUES (6, '19951220')!
 
Enter command:
INSERT INTO SCANNER_HEADER VALUES (7, '19951220')!
 
Enter command:
INSERT INTO SCANNER_HEADER VALUES (8, '19951220')!
 
Enter command:
CREATE TABLE SCANNER_LINE (
BON_ID     INTEGER
           CONSTRAINT SCANNER_HEADER_LINE_REF REFERENCES SCANNER_HEADER,
ZEILE      INTEGER,
ARTIKEL_NR INTEGER NOT NULL
           CONSTRAINT SCANNER_ARTIKEL_REF REFERENCES ARTIKEL,
MENGE      INTEGER NOT NULL
           CONSTRAINT MENGEN_CHECK CHECK (MENGE > 0),
CONSTRAINT SCANNER_KEY PRIMARY KEY (BON_ID, ZEILE))!
 
Enter command:
INSERT INTO SCANNER_LINE VALUES (1,1,1,1)!
 
Enter command:
INSERT INTO SCANNER_LINE VALUES (1,2,2,1)!
 
Enter command:
INSERT INTO SCANNER_LINE VALUES (1,3,3,1)!
 
Enter command:
INSERT INTO SCANNER_LINE VALUES (1,4,4,1)!
 
Enter command:
INSERT INTO SCANNER_LINE VALUES (1,5,5,1)!
 
Enter command:
INSERT INTO SCANNER_LINE VALUES (2,1,2,1)!
 
Enter command:
INSERT INTO SCANNER_LINE VALUES (2,2,4,2)!
 
Enter command:
INSERT INTO SCANNER_LINE VALUES (3,1,1,4)!
 
Enter command:
INSERT INTO SCANNER_LINE VALUES (3,2,3,3)!
 
Enter command:
INSERT INTO SCANNER_LINE VALUES (3,3,5,1)!
 
Enter command:
INSERT INTO SCANNER_LINE VALUES (4,1,1,1)!
 
Enter command:
INSERT INTO SCANNER_LINE VALUES (4,2,3,2)!
 
Enter command:
INSERT INTO SCANNER_LINE VALUES (4,3,4,2)!
 
Enter command:
INSERT INTO SCANNER_LINE VALUES (5,1,2,1)!
 
Enter command:
INSERT INTO SCANNER_LINE VALUES (5,2,4,2)!
 
Enter command:
INSERT INTO SCANNER_LINE VALUES (5,3,5,2)!
 
Enter command:
INSERT INTO SCANNER_LINE VALUES (6,1,3,2)!
 
Enter command:
INSERT INTO SCANNER_LINE VALUES (6,2,5,1)!
 
Enter command:
INSERT INTO SCANNER_LINE VALUES (7,1,1,1)!
 
Enter command:
INSERT INTO SCANNER_LINE VALUES (8,1,3,2)!
 
Enter command:
INSERT INTO SCANNER_LINE VALUES (8,2,5,3)!
 
Enter command:
SELECT EINS.BEZEICHNUNG, ZWEI.BEZEICHNUNG
  FROM ARTIKEL EINS, ARTIKEL ZWEI,
       SCANNER_LINE SC1,  SCANNER_LINE SC2
 WHERE SC1.BON_ID = SC2.BON_ID
   AND SC1.ARTIKEL_NR  = EINS.ARTIKEL_NR
   AND SC2.ARTIKEL_NR  = ZWEI.ARTIKEL_NR
GROUP BY EINS.BEZEICHNUNG, EINS.ARTIKEL_NR,
         ZWEI.BEZEICHNUNG, ZWEI.ARTIKEL_NR
HAVING COUNT(EINS.ARTIKEL_NR) >=
           (SELECT 0.5 * COUNT(*)
              FROM SCANNER_LINE SC
             WHERE SC.ARTIKEL_NR = EINS.ARTIKEL_NR)
    OR COUNT(ZWEI.ARTIKEL_NR) >=
           (SELECT 0.5 * COUNT(*)
              FROM SCANNER_LINE SC
             WHERE SC.ARTIKEL_NR = ZWEI.ARTIKEL_NR)
!
 
resultcount :                    21
 
Enter command:
FETCH INTO :A, :B !
 
BEZEICHNUNG  | BEZEICHNUNG
-------------+-------------
Brot         | Brot
Brot         | Milch
Brot         | Nudeln
Brot         | Tomatensosse
Fisch        | Fisch
Fisch        | Milch
Fisch        | Tomatensosse
Milch        | Brot
Milch        | Fisch
Milch        | Milch
Milch        | Nudeln
Milch        | Tomatensosse
Nudeln       | Brot
Nudeln       | Milch
Nudeln       | Nudeln
Nudeln       | Tomatensosse
Tomatensosse | Brot
 
BEZEICHNUNG  | BEZEICHNUNG
-------------+-------------
Tomatensosse | Fisch
Tomatensosse | Milch
Tomatensosse | Nudeln
Tomatensosse | Tomatensosse
 
resultcount :                    21
 
Enter command:
SELECT EINS.BEZEICHNUNG, ZWEI.BEZEICHNUNG
  FROM ARTIKEL EINS, ARTIKEL ZWEI,
       SCANNER_LINE SC1,  SCANNER_LINE SC2
 WHERE SC1.BON_ID = SC2.BON_ID
   AND SC1.ARTIKEL_NR  = EINS.ARTIKEL_NR
   AND SC2.ARTIKEL_NR  = ZWEI.ARTIKEL_NR
   AND EINS.ARTIKEL_NR < ZWEI.ARTIKEL_NR
GROUP BY EINS.BEZEICHNUNG, EINS.ARTIKEL_NR,
         ZWEI.BEZEICHNUNG, ZWEI.ARTIKEL_NR
HAVING COUNT(*) >
           (SELECT 0.5 * COUNT(DISTINCT SC.BON_ID)
              FROM SCANNER_LINE SC
             WHERE SC.ARTIKEL_NR IN (EINS.ARTIKEL_NR, ZWEI.ARTIKEL_NR))
!
 
resultcount :                     2
 
Enter command:
FETCH INTO :A, :B !
 
BEZEICHNUNG  | BEZEICHNUNG
-------------+-------------
Fisch        | Milch
Nudeln       | Tomatensosse
 
resultcount :                     2
 
Enter command:
SELECT EINS.BEZEICHNUNG, ZWEI.BEZEICHNUNG
  FROM ARTIKEL EINS, ARTIKEL ZWEI,
       SCANNER_LINE SC1,  SCANNER_LINE SC2
 WHERE SC1.BON_ID = SC2.BON_ID
   AND SC1.ARTIKEL_NR  = EINS.ARTIKEL_NR
   AND SC2.ARTIKEL_NR  = ZWEI.ARTIKEL_NR
   AND EINS.ARTIKEL_NR < ZWEI.ARTIKEL_NR
GROUP BY EINS.BEZEICHNUNG, EINS.ARTIKEL_NR,
         ZWEI.BEZEICHNUNG, ZWEI.ARTIKEL_NR
HAVING COUNT(*) * 3 >
           (SELECT COUNT(SC.BON_ID)
              FROM SCANNER_LINE SC
             WHERE SC.ARTIKEL_NR IN (EINS.ARTIKEL_NR, ZWEI.ARTIKEL_NR))
!
 
resultcount :                     2
 
Enter command:
FETCH INTO :A, :B !
 
BEZEICHNUNG  | BEZEICHNUNG
-------------+-------------
Fisch        | Milch
Nudeln       | Tomatensosse
 
resultcount :                     2
 
Enter command:
DROP TABLE ARTIKEL !
 
Enter command:
DROP TABLE SCANNER_HEADER !
 
Enter command:
DROP TABLE SCANNER_LINE !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST SQLMODE INTERNAL !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE INTERNAL ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE ZAEHLUNGEN (
ZAEHLUNGS_ID   INTEGER,
TIER           VARCHAR (30),
ANZAHL         INTEGER NOT NULL,
PRIMARY KEY (ZAEHLUNGS_ID, TIER))!
 
Enter command:
INSERT INTO ZAEHLUNGEN VALUES (1, 'Frosch    ', 12)!
 
Enter command:
INSERT INTO ZAEHLUNGEN VALUES (1, 'Kaulquappe', 16)!
 
Enter command:
INSERT INTO ZAEHLUNGEN VALUES (1, 'Lurch     ', 10)!
 
Enter command:
INSERT INTO ZAEHLUNGEN VALUES (2, 'Frosch    ',  2)!
 
Enter command:
INSERT INTO ZAEHLUNGEN VALUES (2, 'Lurch     ',  1)!
 
Enter command:
INSERT INTO ZAEHLUNGEN VALUES (2, 'Kroete    ',  3)!
 
Enter command:
INSERT INTO ZAEHLUNGEN VALUES (3, 'Frosch    ',  3)!
 
Enter command:
CREATE TABLE ZAEHLUNGSGRUPPEN (
GRUPPEN_ID    INTEGER,
ZAEHLUNGS_ID  INTEGER,
PRIMARY KEY (GRUPPEN_ID, ZAEHLUNGS_ID))!
 
Enter command:
INSERT INTO ZAEHLUNGSGRUPPEN VALUES (1,1)!
 
Enter command:
INSERT INTO ZAEHLUNGSGRUPPEN VALUES (1,2)!
 
Enter command:
INSERT INTO ZAEHLUNGSGRUPPEN VALUES (2,1)!
 
Enter command:
INSERT INTO ZAEHLUNGSGRUPPEN VALUES (2,3)!
 
Enter command:
INSERT INTO ZAEHLUNGSGRUPPEN VALUES (3,3)!
 
Enter command:
SELECT TIER, FIXED(SUM(ANZAHL) / X.NR, 4,1)
  FROM (SELECT COUNT(GRUPPEN_ID) NR
          FROM ZAEHLUNGSGRUPPEN
         WHERE GRUPPEN_ID = 1) X,
       ZAEHLUNGEN Z,
       ZAEHLUNGSGRUPPEN ZG
 WHERE ZG.GRUPPEN_ID = 1
   AND ZG.ZAEHLUNGS_ID = Z.ZAEHLUNGS_ID
GROUP BY TIER, X.NR !
 
resultcount :                     4
 
Enter command:
FETCH INTO :A, :B!
 
TIER                           | EXPRESSION1
-------------------------------+------------
Frosch                         |    7.0
Kaulquappe                     |    8.0
Kroete                         |    1.5
Lurch                          |    5.5
 
resultcount :                     4
 
Enter command:
DROP TABLE ZAEHLUNGEN !
 
Enter command:
DROP TABLE ZAEHLUNGSGRUPPEN !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST SQLMODE INTERNAL !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE INTERNAL ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE PATIENTEN (
ID      INTEGER PRIMARY KEY,
NAME    VARCHAR (30))!
 
Enter command:
INSERT INTO PATIENTEN VALUES (1, 'Albrecht')!
 
Enter command:
INSERT INTO PATIENTEN VALUES (2, 'Ladewig')!
 
Enter command:
INSERT INTO PATIENTEN VALUES (3, 'Weiss')!
 
Enter command:
INSERT INTO PATIENTEN VALUES (4, 'Suhr')!
 
Enter command:
INSERT INTO PATIENTEN VALUES (5, 'Medinger')!
 
Enter command:
INSERT INTO PATIENTEN VALUES (6, 'Linke')!
 
Enter command:
CREATE TABLE MESSUNGEN (
ID    INTEGER REFERENCES PATIENTEN,
DATUM DATE,
WERT  FIXED(3,1) NOT NULL,
PRIMARY KEY (ID, DATUM))!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (1, '19960208', 38.4)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (2, '19960208', 36.7)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (3, '19960208', 37.5)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (6, '19960208', 40.7)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (5, '19960208', 39.5)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (4, '19960208', 40.8)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (1, '19960209', 40.6)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (6, '19960209', 37.3)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (5, '19960209', 41.8)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (4, '19960209', 38.7)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (3, '19960209', 42.2)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (2, '19960209', 38.1)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (1, '19960210', 40.5)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (6, '19960210', 38.1)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (5, '19960210', 37.5)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (4, '19960210', 41.7)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (3, '19960210', 36.5)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (2, '19960210', 36.1)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (1, '19960211', 38.1)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (4, '19960211', 42.3)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (3, '19960211', 41.7)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (6, '19960211', 36.0)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (5, '19960211', 40.8)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (2, '19960211', 37.8)!
 
Enter command:
SELECT NAME, FIXED(AVG(M.WERT), 5, 3) AVG_WERT, MW.WERT
  FROM (SELECT WERT, ID, DATUM FROM MESSUNGEN ME1
         WHERE DATUM = (SELECT MAX(DATUM)
                          FROM MESSUNGEN ME2
                         WHERE ME2.ID = ME1.ID)
       ) MW,
                     PATIENTEN P, MESSUNGEN M
 WHERE P.ID  = M.ID
   AND MW.ID = M.ID
GROUP BY NAME, MW.WERT
HAVING MW.WERT > AVG(M.WERT) !
 
resultcount :                     4
 
Enter command:
FETCH INTO :A, :B, :C !
 
NAME                           | AVG_WERT | WERT
-------------------------------+----------+------
Ladewig                        |  37.175  |  37.8
Medinger                       |  39.900  |  40.8
Suhr                           |  40.875  |  42.3
Weiss                          |  39.475  |  41.7
 
resultcount :                     4
 
Enter command:
SELECT P.NAME, AVG (M1.WERT) AVG_WERT, M2.WERT
  FROM PATIENTEN P, MESSUNGEN M1, MESSUNGEN M2
 WHERE P.ID = M1.ID
   AND P.ID = M2.ID
   AND M2.DATUM = (SELECT MAX(MI.DATUM)
                     FROM MESSUNGEN MI
                    WHERE MI.ID = M2.ID)
GROUP BY P.NAME, M2.WERT
HAVING M2.WERT > AVG (M1.WERT)!
 
resultcount :                     4
 
Enter command:
FETCH INTO :A, :B, :C !
 
NAME              :  Ladewig
AVG_WERT          :   3.7175000000000000000000000000000000000E+01
WERT              :   37.8
-----------------------------------------------------------------
NAME              :  Medinger
AVG_WERT          :   3.9900000000000000000000000000000000000E+01
WERT              :   40.8
-----------------------------------------------------------------
NAME              :  Suhr
AVG_WERT          :   4.0875000000000000000000000000000000000E+01
WERT              :   42.3
-----------------------------------------------------------------
NAME              :  Weiss
AVG_WERT          :   3.9475000000000000000000000000000000000E+01
WERT              :   41.7
 
resultcount :                     4
 
Enter command:
SELECT P.NAME, MESS.AVG_WERT, M.WERT
  FROM PATIENTEN P, MESSUNGEN M,
       (SELECT MAV.ID, AVG(MAV.WERT) AVG_WERT,
                       MAX(MAV.DATUM) MAX_DATUM
          FROM MESSUNGEN MAV
        GROUP BY MAV.ID) MESS
 WHERE P.ID = M.ID
   AND P.ID = MESS.ID
   AND M.DATUM = MESS.MAX_DATUM
   AND M.WERT > MESS.AVG_WERT !
 
resultcount :                     4
 
Enter command:
FETCH INTO :A, :B, :C !
 
NAME              :  Ladewig
AVG_WERT          :   3.7175000000000000000000000000000000000E+01
WERT              :   37.8
-----------------------------------------------------------------
NAME              :  Weiss
AVG_WERT          :   3.9475000000000000000000000000000000000E+01
WERT              :   41.7
-----------------------------------------------------------------
NAME              :  Suhr
AVG_WERT          :   4.0875000000000000000000000000000000000E+01
WERT              :   42.3
-----------------------------------------------------------------
NAME              :  Medinger
AVG_WERT          :   3.9900000000000000000000000000000000000E+01
WERT              :   40.8
 
resultcount :                     4
 
Enter command:
DROP TABLE PATIENTEN !
 
Enter command:
DROP TABLE MESSUNGEN!
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST SQLMODE ORACLE !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE ORACLE ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE FLUGPLAN
 (FLUG_NR VARCHAR(10) CONSTRAINT FLUGPLAN_PK PRIMARY KEY,
  AB_ORT  VARCHAR(30) NOT NULL,
  AN_ORT  VARCHAR(30) NOT NULL)!
 
Enter command:
INSERT INTO FLUGPLAN VALUES ('IT001', 'Hamburg  ', 'Berlin   ')!
 
Enter command:
INSERT INTO FLUGPLAN VALUES ('IT002', 'Berlin   ', 'Hamburg  ')!
 
Enter command:
INSERT INTO FLUGPLAN VALUES ('IT003', 'Hamburg  ', 'Berlin   ')!
 
Enter command:
INSERT INTO FLUGPLAN VALUES ('IT004', 'Berlin   ', 'Hamburg  ')!
 
Enter command:
INSERT INTO FLUGPLAN VALUES ('IT005', 'Hamburg  ', 'Bremen   ')!
 
Enter command:
INSERT INTO FLUGPLAN VALUES ('IT006', 'Bremen   ', 'Hamburg  ')!
 
Enter command:
INSERT INTO FLUGPLAN VALUES ('IT007', 'Bremen   ', 'Berlin   ')!
 
Enter command:
INSERT INTO FLUGPLAN VALUES ('IT008', 'Berlin   ', 'Bremen   ')!
 
Enter command:
INSERT INTO FLUGPLAN VALUES ('IT009', 'Bremen   ', 'Frankfurt')!
 
Enter command:
INSERT INTO FLUGPLAN VALUES ('IT010', 'Frankfurt', 'Bremen   ')!
 
Enter command:
CREATE TABLE FLUG
 (FLUG_NR  VARCHAR(10) CONSTRAINT FLUGPLAN_FK REFERENCES FLUGPLAN,
  DATUM    DATE,
  PERSONEN NUMBER NOT NULL,
      CONSTRAINT FLUG_PK PRIMARY KEY (FLUG_NR, DATUM)) !
 
Enter command:
INSERT INTO FLUG VALUES ('IT001', '20-APR-96',  60)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT002', '20-APR-96',  72)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT003', '20-APR-96',  37)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT004', '20-APR-96',  61)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT005', '20-APR-96',  38)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT006', '20-APR-96',  21)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT007', '20-APR-96',  63)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT008', '20-APR-96',  58)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT009', '20-APR-96',  59)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT010', '20-APR-96',  66)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT001', '21-APR-96',  55)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT002', '21-APR-96',  26)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT003', '21-APR-96',  68)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT004', '21-APR-96',  67)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT005', '21-APR-96',  23)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT006', '21-APR-96',  50)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT007', '21-APR-96',  34)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT008', '21-APR-96',  32)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT009', '21-APR-96',  44)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT010', '21-APR-96',  70)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT001', '22-APR-96',  47)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT002', '22-APR-96',  91)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT003', '22-APR-96',  34)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT004', '22-APR-96', 122)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT005', '22-APR-96', 109)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT006', '22-APR-96', 118)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT007', '22-APR-96',  26)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT008', '22-APR-96',  79)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT009', '22-APR-96',  31)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT010', '22-APR-96', 128)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT001', '23-APR-96',  82)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT002', '23-APR-96',  63)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT003', '23-APR-96',  70)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT004', '23-APR-96',  32)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT005', '23-APR-96',  91)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT006', '23-APR-96',  34)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT007', '23-APR-96',  74)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT008', '23-APR-96',  69)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT009', '23-APR-96',  90)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT010', '23-APR-96',  66)!
 
Enter command:
SELECT SUBSTR(AB_ORT, 1, 10), DATUM, SUM(PERSONEN) SUMME_S
  FROM FLUGPLAN FP, FLUG F
 WHERE FP.FLUG_NR = F.FLUG_NR
GROUP BY AB_ORT, DATUM
HAVING (AB_ORT, SUM(PERSONEN)) = ANY
   (SELECT AB_ORT, MIN(SUM_P)
      FROM
          (SELECT AB_ORT, SUM(PERSONEN) SUM_P
             FROM FLUGPLAN FP1, FLUG F1
            WHERE FP1.FLUG_NR = F1.FLUG_NR
           GROUP BY AB_ORT, DATUM) S
      GROUP BY AB_ORT
   )!
 
resultcount :                     0
 
Enter command:
FETCH INTO :A, :B, :C !
 
EXPRESSION1       :  Berlin
DATUM             :  21-APR-96
SUMME_S           :   1.2500000000000000000000000000000000000E+02
-----------------------------------------------------------------
EXPRESSION1       :  Bremen
DATUM             :  21-APR-96
SUMME_S           :   1.2800000000000000000000000000000000000E+02
-----------------------------------------------------------------
EXPRESSION1       :  Frankfurt
DATUM             :  20-APR-96
SUMME_S           :   6.6000000000000000000000000000000000000E+01
-----------------------------------------------------------------
EXPRESSION1       :  Frankfurt
DATUM             :  23-APR-96
SUMME_S           :   6.6000000000000000000000000000000000000E+01
-----------------------------------------------------------------
EXPRESSION1       :  Hamburg
DATUM             :  20-APR-96
SUMME_S           :   1.3500000000000000000000000000000000000E+02
 
resultcount :                     5
 
Enter command:
SELECT SUBSTR(AB_ORT, 1, 10), DATUM, SUM(PERSONEN) SUMME_S
  FROM FLUGPLAN FP, FLUG F
 WHERE FP.FLUG_NR = F.FLUG_NR
GROUP BY AB_ORT, DATUM
HAVING (AB_ORT, SUM(PERSONEN)) IN
   (SELECT AB_ORT, MIN(SUM_P)
      FROM
          (SELECT AB_ORT, SUM(PERSONEN) SUM_P
             FROM FLUGPLAN FP1, FLUG F1
            WHERE FP1.FLUG_NR = F1.FLUG_NR
           GROUP BY AB_ORT, DATUM) S
      GROUP BY AB_ORT
   )!
 
resultcount :                     0
 
Enter command:
FETCH INTO :A, :B, :C !
 
EXPRESSION1       :  Berlin
DATUM             :  21-APR-96
SUMME_S           :   1.2500000000000000000000000000000000000E+02
-----------------------------------------------------------------
EXPRESSION1       :  Bremen
DATUM             :  21-APR-96
SUMME_S           :   1.2800000000000000000000000000000000000E+02
-----------------------------------------------------------------
EXPRESSION1       :  Frankfurt
DATUM             :  20-APR-96
SUMME_S           :   6.6000000000000000000000000000000000000E+01
-----------------------------------------------------------------
EXPRESSION1       :  Frankfurt
DATUM             :  23-APR-96
SUMME_S           :   6.6000000000000000000000000000000000000E+01
-----------------------------------------------------------------
EXPRESSION1       :  Hamburg
DATUM             :  20-APR-96
SUMME_S           :   1.3500000000000000000000000000000000000E+02
 
resultcount :                     5
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST SQLMODE ANSI !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE ANSI ISOLATION LEVEL 1 !
 
Enter command:
DECLARE C CURSOR FOR
SELECT AB_ORT, DATUM, SUM(PERSONEN) SUMME_S
  FROM FLUGPLAN FP, FLUG F
 WHERE FP.FLUG_NR = F.FLUG_NR
GROUP BY AB_ORT, DATUM
HAVING SUM(PERSONEN) <= ALL
   (SELECT SUM(FI.PERSONEN)
      FROM FLUGPLAN FPI, FLUG FI
     WHERE FPI.FLUG_NR = FI.FLUG_NR
       AND FPI.AB_ORT = MIN(FP.AB_ORT)
    GROUP BY DATUM )
   !
 
resultcount :                     5
 
Enter command:
FETCH C INTO :A, :B, :C !
 
AB_ORT            :  Berlin
DATUM             :  YYYY-MM-DD 00:00:00.000000
SUMME_S           :   1.2500000000000000000000000000000000000E+02
-----------------------------------------------------------------
AB_ORT            :  Bremen
DATUM             :  YYYY-MM-DD 00:00:00.000000
SUMME_S           :   1.2800000000000000000000000000000000000E+02
-----------------------------------------------------------------
AB_ORT            :  Frankfurt
DATUM             :  YYYY-MM-DD 00:00:00.000000
SUMME_S           :   6.6000000000000000000000000000000000000E+01
-----------------------------------------------------------------
AB_ORT            :  Frankfurt
DATUM             :  YYYY-MM-DD 00:00:00.000000
SUMME_S           :   6.6000000000000000000000000000000000000E+01
-----------------------------------------------------------------
AB_ORT            :  Hamburg
DATUM             :  YYYY-MM-DD 00:00:00.000000
SUMME_S           :   1.3500000000000000000000000000000000000E+02
 
resultcount :                     5
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
FILE CONNECT ( KERN TEST SQLMODE ORACLE !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE ORACLE ISOLATION LEVEL 1 !
 
Enter command:
DECLARE C CURSOR FOR
SELECT AB_ORT, DATUM, SUM(PERSONEN) SUMME_S
  FROM FLUGPLAN FP, FLUG F
 WHERE FP.FLUG_NR = F.FLUG_NR
GROUP BY AB_ORT, DATUM
HAVING SUM(PERSONEN) <= ALL
   (SELECT SUM(FI.PERSONEN)
      FROM FLUGPLAN FPI, FLUG FI
     WHERE FPI.FLUG_NR = FI.FLUG_NR
       AND FPI.AB_ORT = FP.AB_ORT
    GROUP BY DATUM )
   !
 
resultcount :                     0
 
Enter command:
FETCH C INTO :A, :B, :C !
 
AB_ORT            :  Berlin
DATUM             :  21-APR-96
SUMME_S           :   1.2500000000000000000000000000000000000E+02
-----------------------------------------------------------------
AB_ORT            :  Bremen
DATUM             :  21-APR-96
SUMME_S           :   1.2800000000000000000000000000000000000E+02
-----------------------------------------------------------------
AB_ORT            :  Frankfurt
DATUM             :  20-APR-96
SUMME_S           :   6.6000000000000000000000000000000000000E+01
-----------------------------------------------------------------
AB_ORT            :  Frankfurt
DATUM             :  23-APR-96
SUMME_S           :   6.6000000000000000000000000000000000000E+01
-----------------------------------------------------------------
AB_ORT            :  Hamburg
DATUM             :  20-APR-96
SUMME_S           :   1.3500000000000000000000000000000000000E+02
 
resultcount :                     5
 
Enter command:
DECLARE C CURSOR FOR
SELECT SUBSTR(AB_ORT, 1, 10), DATUM, SUM(PERSONEN) SUMME_S
  FROM FLUGPLAN FP, FLUG F
 WHERE FP.FLUG_NR = F.FLUG_NR
GROUP BY AB_ORT, DATUM
HAVING SUM(PERSONEN) <= ALL
   (SELECT SUM(FI.PERSONEN)
      FROM FLUGPLAN FPI, FLUG FI
     WHERE FPI.FLUG_NR = FI.FLUG_NR
       AND FPI.AB_ORT = FP.AB_ORT
    GROUP BY DATUM )
   !
 
resultcount :                     0
 
Enter command:
FETCH C INTO :A, :B, :C !
 
EXPRESSION1       :  Berlin
DATUM             :  21-APR-96
SUMME_S           :   1.2500000000000000000000000000000000000E+02
-----------------------------------------------------------------
EXPRESSION1       :  Bremen
DATUM             :  21-APR-96
SUMME_S           :   1.2800000000000000000000000000000000000E+02
-----------------------------------------------------------------
EXPRESSION1       :  Frankfurt
DATUM             :  20-APR-96
SUMME_S           :   6.6000000000000000000000000000000000000E+01
-----------------------------------------------------------------
EXPRESSION1       :  Frankfurt
DATUM             :  23-APR-96
SUMME_S           :   6.6000000000000000000000000000000000000E+01
-----------------------------------------------------------------
EXPRESSION1       :  Hamburg
DATUM             :  20-APR-96
SUMME_S           :   1.3500000000000000000000000000000000000E+02
 
resultcount :                     5
 
Enter command:
DROP TABLE FLUGPLAN!
 
Enter command:
DROP TABLE FLUG !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST SQLMODE ORACLE !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE ORACLE ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE ABTEILUNGEN (
ABT_NR      NUMBER  ( 3) CONSTRAINT ABTEILUNGEN_PK PRIMARY KEY,
BEZEICHNUNG VARCHAR (20) NOT NULL) !
 
Enter command:
INSERT INTO ABTEILUNGEN VALUES (10, 'EDV      ')!
 
Enter command:
INSERT INTO ABTEILUNGEN VALUES (20, 'Vertrieb ')!
 
Enter command:
INSERT INTO ABTEILUNGEN VALUES (30, 'Marketing')!
 
Enter command:
INSERT INTO ABTEILUNGEN VALUES (40, 'Personal ')!
 
Enter command:
CREATE TABLE ANGESTELLTE (
MA_NR       NUMBER   (3) CONSTRAINT ANGESTELLTE_PK PRIMARY KEY,
NAME        VARCHAR (30) NOT NULL,
POSITION    VARCHAR (30),
ABT_NR      NUMBER  ( 3) CONSTRAINT ANGESTELLTE_FK_ABT
                               REFERENCES ABTEILUNGEN) !
 
Enter command:
INSERT INTO ANGESTELLTE VALUES ( 1, 'Moeller', 'Systemanalytiker', 10)!
 
Enter command:
INSERT INTO ANGESTELLTE VALUES ( 2, 'Meyer  ', 'EDV-Spezialist  ', 10)!
 
Enter command:
INSERT INTO ANGESTELLTE VALUES ( 5, 'Chall  ', 'Verkaeufer      ', 20)!
 
Enter command:
INSERT INTO ANGESTELLTE VALUES ( 6, 'Kunze  ', NULL              , 20)!
 
Enter command:
INSERT INTO ANGESTELLTE VALUES ( 7, 'Peter  ', 'Verkaeuferin    ', 20)!
 
Enter command:
INSERT INTO ANGESTELLTE VALUES ( 8, 'Hagner ', 'EDV-Spezialist  ',NULL)!
 
Enter command:
INSERT INTO ANGESTELLTE VALUES ( 9, 'Hansen ', 'Berater         ', 30)!
 
Enter command:
INSERT INTO ANGESTELLTE VALUES (10, 'Klasen ', 'EDV-Spezialist  ', 30)!
 
Enter command:
INSERT INTO ANGESTELLTE VALUES (12, 'Bauer  ', 'Sachbearbeiter  ', 40)!
 
Enter command:
CREATE TABLE KURSE (
KURS_NR     NUMBER  ( 3) CONSTRAINT KURS_PK PRIMARY KEY,
BEZEICHNUNG VARCHAR (20) NOT NULL) !
 
Enter command:
INSERT INTO KURSE VALUES (10, 'Rhetorik')!
 
Enter command:
INSERT INTO KURSE VALUES (20, 'SQL     ')!
 
Enter command:
CREATE TABLE KURSTEILNEHMER (
KURS_NR     NUMBER  ( 3) CONSTRAINT KTN_FK_KURS
                                 REFERENCES KURSE,
MA_NR       NUMBER  ( 3) CONSTRAINT KTN_FK_MA
                                 REFERENCES ANGESTELLTE,
DATUM       DATE,
CONSTRAINT KURSTEILNEHMER_PK PRIMARY KEY (KURS_NR, MA_NR, DATUM)) !
 
Enter command:
INSERT INTO KURSTEILNEHMER VALUES (10,  1, '20-NOV-95')!
 
Enter command:
INSERT INTO KURSTEILNEHMER VALUES (10,  5, '20-OCT-95')!
 
Enter command:
INSERT INTO KURSTEILNEHMER VALUES (10,  6, '20-DEC-95')!
 
Enter command:
INSERT INTO KURSTEILNEHMER VALUES (10, 10, '20-SEP-95')!
 
Enter command:
INSERT INTO KURSTEILNEHMER VALUES (10,  9, '20-NOV-95')!
 
Enter command:
INSERT INTO KURSTEILNEHMER VALUES (20,  2, '10-MAY-95')!
 
Enter command:
INSERT INTO KURSTEILNEHMER VALUES (20,  8, '11-JUL-95')!
 
Enter command:
INSERT INTO KURSTEILNEHMER VALUES (20,  6, '02-FEB-96')!
 
Enter command:
INSERT INTO KURSTEILNEHMER VALUES (20,  7, '20-APR-96')!
 
Enter command:
SELECT BEZEICHNUNG
  FROM ABTEILUNGEN
 WHERE ABT_NR NOT IN
          (SELECT ABT_NR
             FROM KURSTEILNEHMER KT,
                  KURSE K,
                  ANGESTELLTE A
            WHERE K.BEZEICHNUNG = 'SQL'
              AND K.KURS_NR     = KT.KURS_NR
              AND KT.MA_NR      = A.MA_NR
              AND A.ABT_NR IS NOT NULL
          ) !
 
resultcount :                     0
 
Enter command:
FETCH INTO :A !
 
BEZEICHNUNG
--------------------
Marketing
Personal
 
resultcount :                     2
 
Enter command:
SELECT BEZEICHNUNG
  FROM ABTEILUNGEN
 WHERE NOT EXISTS
          (SELECT 'a'
             FROM KURSTEILNEHMER KT,
                  KURSE K,
                  ANGESTELLTE A
            WHERE K.BEZEICHNUNG = 'SQL'
              AND K.KURS_NR     = KT.KURS_NR
              AND KT.MA_NR      = A.MA_NR
              AND A.ABT_NR      = ABTEILUNGEN.ABT_NR )!
 
resultcount :                     0
 
Enter command:
FETCH INTO :A !
 
BEZEICHNUNG
--------------------
Marketing
Personal
 
resultcount :                     2
 
Enter command:
DROP TABLE ABTEILUNGEN !
 
Enter command:
DROP TABLE ANGESTELLTE !
 
Enter command:
DROP TABLE KURSE !
 
Enter command:
DROP TABLE KURSTEILNEHMER !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST   ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE PERSONAL (
PERS_NO FIXED (3) PRIMARY KEY,
NAME VARCHAR (10) NOT NULL)!
 
Enter command:
INSERT INTO PERSONAL VALUES (1, 'Gehner')!
 
Enter command:
INSERT INTO PERSONAL VALUES (2, 'Jonas')!
 
Enter command:
INSERT INTO PERSONAL VALUES (3, 'Hansen')!
 
Enter command:
INSERT INTO PERSONAL VALUES (4, 'Clausen')!
 
Enter command:
CREATE TABLE PRAEMIE (
PR_ID        FIXED (3) PRIMARY KEY,
BESCHREIBUNG VARCHAR (10) NOT NULL,
WERT         FIXED (10) NOT NULL)!
 
Enter command:
INSERT INTO PRAEMIE VALUES (2, 'Restaurant',   200)!
 
Enter command:
INSERT INTO PRAEMIE VALUES (3, '1100 DM   ',  1100)!
 
Enter command:
INSERT INTO PRAEMIE VALUES (4, '3100 DM   ',  3100)!
 
Enter command:
INSERT INTO PRAEMIE VALUES (5, '1000 DM   ',  1000)!
 
Enter command:
INSERT INTO PRAEMIE VALUES (6, '3000 DM   ',  3000)!
 
Enter command:
INSERT INTO PRAEMIE VALUES (1, 'Reise     ', 10000)!
 
Enter command:
CREATE TABLE ZIEL (
ZIEL_ID      FIXED (3) PRIMARY KEY,
BESCHREIBUNG VARCHAR(10) NOT NULL)!
 
Enter command:
INSERT INTO ZIEL VALUES (1, '80% Umsatz')!
 
Enter command:
INSERT INTO ZIEL VALUES (2, '90% Umsatz')!
 
Enter command:
INSERT INTO ZIEL VALUES (3, '100% Ums. ')!
 
Enter command:
INSERT INTO ZIEL VALUES (4, '120% Ums. ')!
 
Enter command:
INSERT INTO ZIEL VALUES (5, '5 neue Kd.')!
 
Enter command:
INSERT INTO ZIEL VALUES (6, '10 neu Kd.')!
 
Enter command:
INSERT INTO ZIEL VALUES (7, 'Kurs 1    ')!
 
Enter command:
INSERT INTO ZIEL VALUES (8, 'Kurs 2    ')!
 
Enter command:
INSERT INTO ZIEL VALUES (9, 'Gr. Auftr.')!
 
Enter command:
COMMIT !
 
Enter command:
CREATE TABLE ERREICHTES_ZIEL (
PERS_NO    FIXED (3) REFERENCES PERSONAL,
ZIEL_ID    FIXED (3) REFERENCES ZIEL,
PRIMARY KEY (PERS_NO, ZIEL_ID))!
 
Enter command:
INSERT INTO ERREICHTES_ZIEL VALUES (4, 1)!
 
Enter command:
INSERT INTO ERREICHTES_ZIEL VALUES (3, 1)!
 
Enter command:
INSERT INTO ERREICHTES_ZIEL VALUES (2, 1)!
 
Enter command:
INSERT INTO ERREICHTES_ZIEL VALUES (1, 1)!
 
Enter command:
INSERT INTO ERREICHTES_ZIEL VALUES (4, 2)!
 
Enter command:
INSERT INTO ERREICHTES_ZIEL VALUES (3, 2)!
 
Enter command:
INSERT INTO ERREICHTES_ZIEL VALUES (2, 2)!
 
Enter command:
INSERT INTO ERREICHTES_ZIEL VALUES (1, 2)!
 
Enter command:
INSERT INTO ERREICHTES_ZIEL VALUES (4, 3)!
 
Enter command:
INSERT INTO ERREICHTES_ZIEL VALUES (3, 3)!
 
Enter command:
INSERT INTO ERREICHTES_ZIEL VALUES (1, 3)!
 
Enter command:
INSERT INTO ERREICHTES_ZIEL VALUES (1, 4)!
 
Enter command:
INSERT INTO ERREICHTES_ZIEL VALUES (4, 5)!
 
Enter command:
INSERT INTO ERREICHTES_ZIEL VALUES (3, 5)!
 
Enter command:
INSERT INTO ERREICHTES_ZIEL VALUES (2, 5)!
 
Enter command:
INSERT INTO ERREICHTES_ZIEL VALUES (1, 5)!
 
Enter command:
INSERT INTO ERREICHTES_ZIEL VALUES (2, 6)!
 
Enter command:
INSERT INTO ERREICHTES_ZIEL VALUES (1, 6)!
 
Enter command:
INSERT INTO ERREICHTES_ZIEL VALUES (4, 7)!
 
Enter command:
INSERT INTO ERREICHTES_ZIEL VALUES (2, 7)!
 
Enter command:
INSERT INTO ERREICHTES_ZIEL VALUES (1, 7)!
 
Enter command:
INSERT INTO ERREICHTES_ZIEL VALUES (3, 8)!
 
Enter command:
INSERT INTO ERREICHTES_ZIEL VALUES (1, 8)!
 
Enter command:
INSERT INTO ERREICHTES_ZIEL VALUES (4, 9)!
 
Enter command:
INSERT INTO ERREICHTES_ZIEL VALUES (1, 9)!
 
Enter command:
CREATE TABLE NOTWENDIGES_ZIEL (
PR_ID     FIXED (3) REFERENCES PRAEMIE,
ZIEL_ID   FIXED (3) REFERENCES ZIEL,
PRIMARY KEY (PR_ID, ZIEL_ID))!
 
Enter command:
INSERT NOTWENDIGES_ZIEL VALUES (2, 1)!
 
Enter command:
INSERT NOTWENDIGES_ZIEL VALUES (2, 5)!
 
Enter command:
INSERT NOTWENDIGES_ZIEL VALUES (2, 7)!
 
Enter command:
INSERT NOTWENDIGES_ZIEL VALUES (3, 2)!
 
Enter command:
INSERT NOTWENDIGES_ZIEL VALUES (3, 5)!
 
Enter command:
INSERT NOTWENDIGES_ZIEL VALUES (3, 7)!
 
Enter command:
INSERT NOTWENDIGES_ZIEL VALUES (5, 1)!
 
Enter command:
INSERT NOTWENDIGES_ZIEL VALUES (5, 6)!
 
Enter command:
INSERT NOTWENDIGES_ZIEL VALUES (5, 8)!
 
Enter command:
INSERT NOTWENDIGES_ZIEL VALUES (4, 3)!
 
Enter command:
INSERT NOTWENDIGES_ZIEL VALUES (4, 5)!
 
Enter command:
INSERT NOTWENDIGES_ZIEL VALUES (4, 7)!
 
Enter command:
INSERT NOTWENDIGES_ZIEL VALUES (6, 2)!
 
Enter command:
INSERT NOTWENDIGES_ZIEL VALUES (6, 6)!
 
Enter command:
INSERT NOTWENDIGES_ZIEL VALUES (6, 8)!
 
Enter command:
INSERT NOTWENDIGES_ZIEL VALUES (6, 9)!
 
Enter command:
INSERT NOTWENDIGES_ZIEL VALUES (1, 4)!
 
Enter command:
INSERT NOTWENDIGES_ZIEL VALUES (1, 6)!
 
Enter command:
INSERT NOTWENDIGES_ZIEL VALUES (1, 8)!
 
Enter command:
INSERT NOTWENDIGES_ZIEL VALUES (1, 9)!
 
Enter command:
COMMIT !
 
Enter command:
SELECT NAME, BESCHREIBUNG, WERT
FROM PERSONAL, PRAEMIE
WHERE WERT =
       (SELECT MAX(WERT)
         FROM PRAEMIE
        WHERE PR_ID IN
                  (SELECT PR_ID
                     FROM NOTWENDIGES_ZIEL
                    GROUP BY PR_ID
                   HAVING (PR_ID, COUNT(*)) IN
                               (SELECT PR_ID, COUNT(*)
                                  FROM NOTWENDIGES_ZIEL NZ,
                                       ERREICHTES_ZIEL EZ
                                 WHERE NZ.ZIEL_ID = EZ.ZIEL_ID
                                   AND EZ.PERS_NO = PERSONAL.PERS_NO
                                 GROUP BY PR_ID
                               )
                  )
       )
ORDER BY WERT !
 
resultcount :                     3
 
Enter command:
FETCH INTO :A, :B, :C !
 
NAME       | BESCHREIBUNG | WERT
-----------+--------------+------------
Jonas      | 1100 DM      |        1100
Clausen    | 3100 DM      |        3100
Gehner     | Reise        |       10000
 
resultcount :                     3
 
Enter command:
SELECT NAME, BESCHREIBUNG, WERT
FROM PERSONAL, PRAEMIE
WHERE WERT =
       (SELECT MAX(WERT)
         FROM PRAEMIE
        WHERE PR_ID IN
                  (SELECT PR_ID
                     FROM NOTWENDIGES_ZIEL
                    GROUP BY PR_ID
                   HAVING (PR_ID, COUNT(*)) IN
                               (SELECT PR_ID, COUNT(*)
                                  FROM NOTWENDIGES_ZIEL NZ,
                                       ERREICHTES_ZIEL EZ
                                 WHERE NZ.ZIEL_ID = EZ.ZIEL_ID
                                   AND EZ.PERS_NO = PERSONAL.PERS_NO
                                 GROUP BY PR_ID
                               )
                  )
       )
ORDER BY 3 !
 
resultcount :                     3
 
Enter command:
FETCH INTO :A, :B, :C !
 
NAME       | BESCHREIBUNG | WERT
-----------+--------------+------------
Jonas      | 1100 DM      |        1100
Clausen    | 3100 DM      |        3100
Gehner     | Reise        |       10000
 
resultcount :                     3
 
Enter command:
SELECT PE1.NAME,
       PR1.BESCHREIBUNG,
       PR1.WERT
  FROM PERSONAL PE1,
       PRAEMIE PR1
 WHERE PR1.WERT IN
             (SELECT MAX (PR2.WERT)
                FROM PRAEMIE PR2
               WHERE PR2.PR_ID NOT IN
                      (SELECT NZ1.PR_ID
                         FROM NOTWENDIGES_ZIEL NZ1
                        WHERE NZ1.ZIEL_ID NOT IN
                              (SELECT EZ1.ZIEL_ID
                                 FROM ERREICHTES_ZIEL EZ1
                                WHERE EZ1.PERS_NO = PE1.PERS_NO
                              )
                       )
             )!
 
resultcount :                     3
 
Enter command:
FETCH INTO :A, :B, :C !
 
NAME       | BESCHREIBUNG | WERT
-----------+--------------+------------
Gehner     | Reise        |       10000
Jonas      | 1100 DM      |        1100
Clausen    | 3100 DM      |        3100
 
resultcount :                     3
 
Enter command:
DROP TABLE PERSONAL !
 
Enter command:
DROP TABLE PRAEMIE !
 
Enter command:
DROP TABLE ZIEL !
 
Enter command:
DROP TABLE ERREICHTES_ZIEL !
 
Enter command:
DROP TABLE NOTWENDIGES_ZIEL !
 
Enter command:
COMMIT RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST SQLMODE ORACLE!
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE ORACLE ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE KUNDEN (
KDNR NUMBER (6,0) CONSTRAINT KUNDEN_PK PRIMARY KEY,
NAME VARCHAR (30))!
 
Enter command:
INSERT INTO KUNDEN VALUES (1, 'Meyer    ')!
 
Enter command:
INSERT INTO KUNDEN VALUES (2, 'Schmidt  ')!
 
Enter command:
INSERT INTO KUNDEN VALUES (3, 'Clausen  ')!
 
Enter command:
INSERT INTO KUNDEN VALUES (4, 'Fischer  ')!
 
Enter command:
INSERT INTO KUNDEN VALUES (5, 'Feddersen')!
 
Enter command:
CREATE TABLE AUSGABEN (
TITEL VARCHAR (30) CONSTRAINT AUSGABEN_PK PRIMARY KEY,
DATUM DATE NOT NULL)!
 
Enter command:
INSERT INTO AUSGABEN VALUES ('7/96', '05-JUL-96')!
 
Enter command:
INSERT INTO AUSGABEN VALUES ('8/96', '05-AUG-96')!
 
Enter command:
INSERT INTO AUSGABEN VALUES ('9/96', '05-SEP-96')!
 
Enter command:
CREATE TABLE ANZEIGEN (
KDNR    NUMBER (6,0) CONSTRAINT ANZ_KD_FK REFERENCES KUNDEN,
TITEL   VARCHAR (30) CONSTRAINT ANZ_AUSG_FK REFERENCES AUSGABEN,
SEITE   NUMBER (3,0),
GROESSE NUMBER (3,2) CONSTRAINT GROESSE_CHECK
        CHECK (GROESSE > 0 AND GROESSE <= 1),
COLOR   CHAR (1) CONSTRAINT COLOR_CHECK CHECK (COLOR IN ('J','N')),
CONSTRAINT ANZEIGEN_PK PRIMARY KEY (KDNR, TITEL, SEITE))!
 
Enter command:
INSERT INTO ANZEIGEN VALUES (1, '7/96', 15, 0.50, 'J')!
 
Enter command:
INSERT INTO ANZEIGEN VALUES (2, '7/96', 22, 0.50, 'J')!
 
Enter command:
INSERT INTO ANZEIGEN VALUES (5, '7/96', 33, 1.00, 'N')!
 
Enter command:
INSERT INTO ANZEIGEN VALUES (3, '7/96', 41, 1.00, 'N')!
 
Enter command:
INSERT INTO ANZEIGEN VALUES (4, '7/96', 45, 1.00, 'N')!
 
Enter command:
INSERT INTO ANZEIGEN VALUES (4, '7/96', 46, 1.00, 'N')!
 
Enter command:
INSERT INTO ANZEIGEN VALUES (1, '8/96', 15, 0.50, 'J')!
 
Enter command:
INSERT INTO ANZEIGEN VALUES (2, '8/96', 22, 0.50, 'J')!
 
Enter command:
INSERT INTO ANZEIGEN VALUES (5, '8/96', 33, 1.00, 'N')!
 
Enter command:
INSERT INTO ANZEIGEN VALUES (1, '9/96', 15, 0.50, 'J')!
 
Enter command:
INSERT INTO ANZEIGEN VALUES (2, '9/96', 22, 1.00, 'N')!
 
Enter command:
INSERT INTO ANZEIGEN VALUES (5, '9/96', 33, 1.00, 'N')!
 
Enter command:
INSERT INTO ANZEIGEN VALUES (3, '9/96', 41, 1.00, 'J')!
 
Enter command:
SELECT KD.NAME
  FROM KUNDEN KD, ANZEIGEN AZ
 WHERE AZ.KDNR = KD.KDNR
GROUP BY KD.NAME
HAVING SUM (AZ.GROESSE * DECODE (AZ.COLOR, 'J', 2, 1)) >= 3 !
 
resultcount :                     0
 
Enter command:
FETCH INTO :A !
 
NAME
------------------------------
Clausen
Feddersen
Meyer
Schmidt
 
resultcount :                     4
 
Enter command:
SELECT KD.NAME
  FROM KUNDEN KD
 WHERE EXISTS
      (SELECT SUM (AZ_ALL.GROESSE),
              SUM (AZ_COL.GROESSE)
         FROM ANZEIGEN AZ_ALL, ANZEIGEN AZ_COL
        WHERE KD.KDNR        = AZ_ALL.KDNR
          AND AZ_ALL.KDNR    = AZ_COL.KDNR(+)
          AND AZ_ALL.TITEL   = AZ_COL.TITEL(+)
          AND AZ_ALL.SEITE   = AZ_COL.SEITE(+)
          AND AZ_COL.COLOR   = 'J'
        HAVING SUM (AZ_ALL.GROESSE) +
               SUM (AZ_COL.GROESSE) >= 3.0
            OR SUM (AZ_ALL.GROESSE) >= 3.0) !
 
resultcount :                     0
 
Enter command:
FETCH INTO :A !
 
NAME
------------------------------
Meyer
 
resultcount :                     1
 
Enter command:
DROP TABLE KUNDEN !
 
Enter command:
DROP TABLE AUSGABEN !
 
Enter command:
DROP TABLE ANZEIGEN!
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST   ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE BAHNHOF (
NAME              VARCHAR (10) PRIMARY KEY,
MIN_UMSTEIGE_ZEIT FIXED (5) NOT NULL)!
 
Enter command:
INSERT INTO BAHNHOF VALUES ('Muenchen' , 10)!
 
Enter command:
INSERT INTO BAHNHOF VALUES ('Hamburg ' , 10)!
 
Enter command:
INSERT INTO BAHNHOF VALUES ('Frankfurt', 15)!
 
Enter command:
CREATE TABLE ZUG (
NUMMER       VARCHAR (6) PRIMARY KEY,
VON_BAHNHOF  VARCHAR (10) REFERENCES BAHNHOF,
BIS_BAHNHOF  VARCHAR (10) REFERENCES BAHNHOF,
START_ZEIT   TIME NOT NULL,
ANKUNFT_ZEIT TIME NOT NULL,
PREIS        FIXED (6,2) NOT NULL)!
 
Enter command:
INSERT ZUG VALUES('ICE111','Muenchen ','Frankfurt','00090000','00130000',120)!
 
Enter command:
INSERT ZUG VALUES('IC121 ','Muenchen ','Frankfurt','00091000','00134000', 90)!
 
Enter command:
INSERT ZUG VALUES('ICE112','Muenchen ','Frankfurt','00102000','00141500',120)!
 
Enter command:
INSERT ZUG VALUES('IC122 ','Muenchen ','Frankfurt','00111100','00154000', 90)!
 
Enter command:
INSERT ZUG VALUES('ICE211','Frankfurt','Hamburg  ','00131000','00160000',100)!
 
Enter command:
INSERT ZUG VALUES('ICE113','Muenchen ','Frankfurt','00131200','00172000',120)!
 
Enter command:
INSERT ZUG VALUES('IC123 ','Muenchen ','Frankfurt','00132300','00180000', 90)!
 
Enter command:
INSERT ZUG VALUES('ICE124','Muenchen ','Frankfurt','00135000','00175000',120)!
 
Enter command:
INSERT ZUG VALUES('IC221 ','Frankfurt','Hamburg  ','00135000','00172000', 80)!
 
Enter command:
INSERT ZUG VALUES('ICE212','Frankfurt','Hamburg  ','00141000','00170000',100)!
 
Enter command:
INSERT ZUG VALUES('IC222 ','Frankfurt','Hamburg  ','00145000','00183000', 80)!
 
Enter command:
INSERT ZUG VALUES('IC223 ','Frankfurt','Hamburg  ','00171000','00204000', 80)!
 
Enter command:
INSERT ZUG VALUES('ICE213','Frankfurt','Hamburg  ','00173000','00204000',100)!
 
Enter command:
INSERT ZUG VALUES('IC224 ','Frankfurt','Hamburg  ','00182300','00220000', 80)!
 
Enter command:
INSERT ZUG VALUES('ICE214','Frankfurt','Hamburg  ','00190000','00220000',100)!
 
Enter command:
SELECT * FROM
(SELECT ZUG1.NUMMER NUM1,
       ZUG1.START_ZEIT START_M,
       ZUG1.ANKUNFT_ZEIT END_F,
       ZUG2.NUMMER NUM2,
       ZUG2.START_ZEIT START_F,
       ZUG2.ANKUNFT_ZEIT END_H,
       FIXED(HOUR  (ZUG2.ANKUNFT_ZEIT) * 60 +
       MINUTE(ZUG2.ANKUNFT_ZEIT)          -
       (HOUR (ZUG1.START_ZEIT) * 60 +
       MINUTE(ZUG1.START_ZEIT)), 3) DAUER,
       FIXED(ZUG1.PREIS + ZUG2.PREIS, 3) PREIS
  FROM ZUG ZUG1, ZUG ZUG2, BAHNHOF
 WHERE ZUG1.VON_BAHNHOF = 'Muenchen'
   AND (HOUR (ZUG1.ANKUNFT_ZEIT) * 60 +
       MINUTE(ZUG1.ANKUNFT_ZEIT)) + BAHNHOF.MIN_UMSTEIGE_ZEIT
         <= (HOUR(ZUG2.START_ZEIT) * 60 + MINUTE(ZUG2.START_ZEIT))
   AND ZUG2.VON_BAHNHOF = 'Frankfurt'
   AND ZUG1.BIS_BAHNHOF = BAHNHOF.NAME) XX
ORDER BY (DAUER+PREIS)
!
 
resultcount :                    28
 
Enter command:
FETCH INTO :A, :B, :C, :D, :E, :F, :G, :H!
 
NUM1   | START_M  | END_F    | NUM2   | START_F  | END_H    | DAUER | PREIS
-------+----------+----------+--------+----------+----------+-------+------
IC121  | TIMEYYYY | TIMEYYYY | ICE212 | TIMEYYYY | TIMEYYYY |  470  |  190
IC123  | TIMEYYYY | TIMEYYYY | IC224  | TIMEYYYY | TIMEYYYY |  517  |  170
ICE112 | TIMEYYYY | TIMEYYYY | IC222  | TIMEYYYY | TIMEYYYY |  490  |  200
ICE124 | TIMEYYYY | TIMEYYYY | IC224  | TIMEYYYY | TIMEYYYY |  490  |  200
ICE111 | TIMEYYYY | TIMEYYYY | IC221  | TIMEYYYY | TIMEYYYY |  500  |  200
ICE111 | TIMEYYYY | TIMEYYYY | ICE212 | TIMEYYYY | TIMEYYYY |  480  |  220
IC123  | TIMEYYYY | TIMEYYYY | ICE214 | TIMEYYYY | TIMEYYYY |  517  |  190
ICE124 | TIMEYYYY | TIMEYYYY | ICE214 | TIMEYYYY | TIMEYYYY |  490  |  220
ICE113 | TIMEYYYY | TIMEYYYY | IC224  | TIMEYYYY | TIMEYYYY |  528  |  200
IC121  | TIMEYYYY | TIMEYYYY | IC222  | TIMEYYYY | TIMEYYYY |  560  |  170
IC122  | TIMEYYYY | TIMEYYYY | IC223  | TIMEYYYY | TIMEYYYY |  569  |  170
ICE113 | TIMEYYYY | TIMEYYYY | ICE214 | TIMEYYYY | TIMEYYYY |  528  |  220
IC122  | TIMEYYYY | TIMEYYYY | ICE213 | TIMEYYYY | TIMEYYYY |  569  |  190
ICE111 | TIMEYYYY | TIMEYYYY | IC222  | TIMEYYYY | TIMEYYYY |  570  |  200
IC122  | TIMEYYYY | TIMEYYYY | IC224  | TIMEYYYY | TIMEYYYY |  649  |  170
ICE112 | TIMEYYYY | TIMEYYYY | IC223  | TIMEYYYY | TIMEYYYY |  620  |  200
IC122  | TIMEYYYY | TIMEYYYY | ICE214 | TIMEYYYY | TIMEYYYY |  649  |  190
 
NUM1   | START_M  | END_F    | NUM2   | START_F  | END_H    | DAUER | PREIS
-------+----------+----------+--------+----------+----------+-------+------
ICE112 | TIMEYYYY | TIMEYYYY | ICE213 | TIMEYYYY | TIMEYYYY |  620  |  220
IC121  | TIMEYYYY | TIMEYYYY | IC223  | TIMEYYYY | TIMEYYYY |  690  |  170
IC121  | TIMEYYYY | TIMEYYYY | ICE213 | TIMEYYYY | TIMEYYYY |  690  |  190
ICE111 | TIMEYYYY | TIMEYYYY | IC223  | TIMEYYYY | TIMEYYYY |  700  |  200
ICE112 | TIMEYYYY | TIMEYYYY | IC224  | TIMEYYYY | TIMEYYYY |  700  |  200
ICE111 | TIMEYYYY | TIMEYYYY | ICE213 | TIMEYYYY | TIMEYYYY |  700  |  220
ICE112 | TIMEYYYY | TIMEYYYY | ICE214 | TIMEYYYY | TIMEYYYY |  700  |  220
IC121  | TIMEYYYY | TIMEYYYY | IC224  | TIMEYYYY | TIMEYYYY |  770  |  170
IC121  | TIMEYYYY | TIMEYYYY | ICE214 | TIMEYYYY | TIMEYYYY |  770  |  190
ICE111 | TIMEYYYY | TIMEYYYY | IC224  | TIMEYYYY | TIMEYYYY |  780  |  200
ICE111 | TIMEYYYY | TIMEYYYY | ICE214 | TIMEYYYY | TIMEYYYY |  780  |  220
 
resultcount :                    28
 
Enter command:
COMMIT WORK RELEASE!
 
Enter command:
 
FILE CONNECT ( KERN TEST SQLMODE ORACLE !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE ORACLE ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE TABELLEN (
TABELLE      VARCHAR (30),
BESCHREIBUNG VARCHAR(100),
CONSTRAINT TABELLEN_PK PRIMARY KEY ( TABELLE))!
 
Enter command:
INSERT INTO TABELLEN VALUES ('Tabellen', 'Beschreibung aller Tabellen')!
 
Enter command:
INSERT INTO TABELLEN VALUES ('Spalten',
            'Beschreibung aller Tabellenspalten')!
 
Enter command:
INSERT INTO TABELLEN VALUES ('Indices', 'Beschreibung aller Indices')!
 
Enter command:
INSERT INTO TABELLEN VALUES ('Index_Spalten',
            'Beschreibung der Index Spalten')!
 
Enter command:
CREATE TABLE SPALTEN (
TABELLE    VARCHAR (30) CONSTRAINT SPTABFK
                              REFERENCES TABELLEN,
SPALTE     VARCHAR (30),
IS_KEY     VARCHAR(1) NOT NULL CONSTRAINT IS_KEY_CHECK
                              CHECK (IS_KEY IN ('Y', 'N')),
FREMDSCHL  VARCHAR (30) CONSTRAINT SPTABFK2
                              REFERENCES TABELLEN,
CONSTRAINT SPALTEN_PK PRIMARY KEY (TABELLE, SPALTE)) !
 
Enter command:
INSERT INTO SPALTEN VALUES ('Tabellen     ', 'Beschreibung', 'N', NULL)!
 
Enter command:
INSERT INTO SPALTEN VALUES ('Spalten      ', 'Fremdschl   ', 'N', 'Tabellen')!
 
Enter command:
INSERT INTO SPALTEN VALUES ('Indices      ', 'Index_Name  ', 'Y', NULL)!
 
Enter command:
INSERT INTO SPALTEN VALUES ('Index_Spalten', 'Index_Name  ', 'Y', 'Indices')!
 
Enter command:
INSERT INTO SPALTEN VALUES ('Spalten      ', 'Is_Key      ', 'N', NULL)!
 
Enter command:
INSERT INTO SPALTEN VALUES ('Index_Spalten', 'Sortierung  ', 'N', NULL)!
 
Enter command:
INSERT INTO SPALTEN VALUES ('Spalten      ', 'Spalte      ', 'Y', NULL)!
 
Enter command:
INSERT INTO SPALTEN VALUES ('Index_Spalten', 'Spalte      ', 'Y', NULL)!
 
Enter command:
INSERT INTO SPALTEN VALUES ('Index_Spalten', 'Tabelle     ', 'Y', 'Indices')!
 
Enter command:
INSERT INTO SPALTEN VALUES ('Tabellen     ', 'Tabelle     ', 'Y', NULL)!
 
Enter command:
INSERT INTO SPALTEN VALUES ('Spalten      ', 'Tabelle     ', 'Y', 'Tabellen')!
 
Enter command:
INSERT INTO SPALTEN VALUES ('Indices      ', 'Tabelle     ', 'Y', 'Tabellen')!
 
Enter command:
INSERT INTO SPALTEN VALUES ('Indices      ', 'Unique      ', 'N', NULL)!
 
Enter command:
PARS_THEN_EX !
 
Enter command:
DATA !
 
Enter command:
SELECT S1.TABELLE || '.' || S1.SPALTE || ' = ' ||
       S2.TABELLE || '.' || S1.SPALTE BEDINGUNG
FROM SPALTEN S1, SPALTEN S2
WHERE S1.TABELLE = :A
  AND S2.TABELLE = :B
  AND S1.FREMDSCHL = S2.TABELLE
  AND S1.SPALTE = S2.SPALTE
  AND NOT EXISTS
    (SELECT *
       FROM SPALTEN S3
      WHERE S1.TABELLE = S3.TABELLE
        AND S1.FREMDSCHL = S3.FREMDSCHL
        AND S3.SPALTE NOT IN
                (SELECT S4.SPALTE
                   FROM SPALTEN S4
                  WHERE S2.TABELLE = S4.TABELLE
                )
    )
UNION
SELECT S1.TABELLE || '.' || S1.SPALTE || ' = ' ||
       S2.TABELLE || '.' || S1.SPALTE BEDINGUNG
FROM SPALTEN S1, SPALTEN S2
WHERE S2.TABELLE = :A
  AND S1.TABELLE = :B
  AND S1.FREMDSCHL = S2.TABELLE
  AND S1.SPALTE = S2.SPALTE
  AND NOT EXISTS
    (SELECT *
       FROM SPALTEN S3
      WHERE S1.TABELLE = S3.TABELLE
        AND S1.FREMDSCHL = S3.FREMDSCHL
        AND S3.SPALTE NOT IN
                (SELECT S4.SPALTE
                   FROM SPALTEN S4
                  WHERE S2.TABELLE = S4.TABELLE
                )
    )!
 
c 30 'Tabellen' c 30 'Spalten'
c 30 'Tabellen' c 30 'Spalten'
 
***ERROR    100 Row not found                                              0001
 
Enter command:
NODATA !
 
Enter command:
FETCH INTO :A !
 
***ERROR    100 Row not found                                              0001
 
Enter command:
DATA !
 
Enter command:
SELECT S1.TABELLE || '.' || S1.SPALTE || ' = ' ||
       S2.TABELLE || '.' || S1.SPALTE BEDINGUNG
FROM SPALTEN S1, SPALTEN S2
WHERE S1.TABELLE = :A
  AND S2.TABELLE = :B
  AND S1.FREMDSCHL = S2.TABELLE
  AND S1.SPALTE = S2.SPALTE
  AND NOT EXISTS
    (SELECT *
       FROM SPALTEN S3
      WHERE S1.TABELLE = S3.TABELLE
        AND S1.FREMDSCHL = S3.FREMDSCHL
        AND S3.SPALTE NOT IN
                (SELECT S4.SPALTE
                   FROM SPALTEN S4
                  WHERE S2.TABELLE = S4.TABELLE
                )
    )
UNION
SELECT S1.TABELLE || '.' || S1.SPALTE || ' = ' ||
       S2.TABELLE || '.' || S1.SPALTE BEDINGUNG
FROM SPALTEN S1, SPALTEN S2
WHERE S2.TABELLE = :A
  AND S1.TABELLE = :B
  AND S1.FREMDSCHL = S2.TABELLE
  AND S1.SPALTE = S2.SPALTE
  AND NOT EXISTS
    (SELECT *
       FROM SPALTEN S3
      WHERE S1.TABELLE = S3.TABELLE
        AND S1.FREMDSCHL = S3.FREMDSCHL
        AND S3.SPALTE NOT IN
                (SELECT S4.SPALTE
                   FROM SPALTEN S4
                  WHERE S2.TABELLE = S4.TABELLE
                )
    )!
 
c 30 'Tabellen' c 30 'Indices'
c 30 'Tabellen' c 30 'Indices'
 
resultcount :                     0
 
Enter command:
NODATA !
 
Enter command:
FETCH INTO :A !
 
BEDINGUNG         :  Indices.Tabelle = Tabellen.Tabelle
 
resultcount :                     1
 
Enter command:
DATA !
 
Enter command:
SELECT S1.TABELLE || '.' || S1.SPALTE || ' = ' ||
       S2.TABELLE || '.' || S1.SPALTE BEDINGUNG
FROM SPALTEN S1, SPALTEN S2
WHERE S1.TABELLE = :A
  AND S2.TABELLE = :B
  AND S1.FREMDSCHL = S2.TABELLE
  AND S1.SPALTE = S2.SPALTE
  AND NOT EXISTS
    (SELECT *
       FROM SPALTEN S3
      WHERE S1.TABELLE = S3.TABELLE
        AND S1.FREMDSCHL = S3.FREMDSCHL
        AND S3.SPALTE NOT IN
                (SELECT S4.SPALTE
                   FROM SPALTEN S4
                  WHERE S2.TABELLE = S4.TABELLE
                )
    )
UNION
SELECT S1.TABELLE || '.' || S1.SPALTE || ' = ' ||
       S2.TABELLE || '.' || S1.SPALTE BEDINGUNG
FROM SPALTEN S1, SPALTEN S2
WHERE S2.TABELLE = :A
  AND S1.TABELLE = :B
  AND S1.FREMDSCHL = S2.TABELLE
  AND S1.SPALTE = S2.SPALTE
  AND NOT EXISTS
    (SELECT *
       FROM SPALTEN S3
      WHERE S1.TABELLE = S3.TABELLE
        AND S1.FREMDSCHL = S3.FREMDSCHL
        AND S3.SPALTE NOT IN
                (SELECT S4.SPALTE
                   FROM SPALTEN S4
                  WHERE S2.TABELLE = S4.TABELLE
                )
    )!
 
c 30 'Index_Spalten' c 30 'Indices'
c 30 'Index_Spalten' c 30 'Indices'
 
resultcount :                     0
 
Enter command:
NODATA !
 
Enter command:
FETCH INTO :A !
 
BEDINGUNG         :  Index_Spalten.Tabelle = Indices.Tabelle
--------------------------------------------------------------------------------
BEDINGUNG         :  Index_Spalten.Index_Name = Indices.Index_Name
 
resultcount :                     2
 
Enter command:
DATA !
 
Enter command:
SELECT S1.TABELLE || '.' || S1.SPALTE || ' = ' ||
       S2.TABELLE || '.' || S1.SPALTE BEDINGUNG
FROM SPALTEN S1, SPALTEN S2
WHERE S1.TABELLE = :A
  AND S2.TABELLE = :B
  AND S1.SPALTE = S2.SPALTE
  AND (S1.FREMDSCHL = S2.TABELLE
  AND NOT EXISTS
    (SELECT *
       FROM SPALTEN S3
      WHERE S1.TABELLE = S3.TABELLE
        AND S1.FREMDSCHL = S3.FREMDSCHL
        AND S3.SPALTE NOT IN
                (SELECT S4.SPALTE
                   FROM SPALTEN S4
                  WHERE S2.TABELLE = S4.TABELLE
                )
    )
OR
    S2.FREMDSCHL = S1.TABELLE
AND NOT EXISTS
   (SELECT *
      FROM SPALTEN S3
     WHERE S2.TABELLE = S3.TABELLE
       AND S2.FREMDSCHL = S3.FREMDSCHL
       AND S3.SPALTE NOT IN
           (SELECT S4.SPALTE
              FROM SPALTEN S4
             WHERE S1.TABELLE = S4.TABELLE
           )
   )
)!
 
c 30 'Tabellen' c 30 'Spalten'
 
***ERROR    100 Row not found                                              0001
 
Enter command:
NODATA !
 
Enter command:
FETCH INTO :A !
 
***ERROR    100 Row not found                                              0001
 
Enter command:
DATA !
 
Enter command:
SELECT S1.TABELLE || '.' || S1.SPALTE || ' = ' ||
       S2.TABELLE || '.' || S1.SPALTE BEDINGUNG
FROM SPALTEN S1, SPALTEN S2
WHERE S1.TABELLE = :A
  AND S2.TABELLE = :B
  AND S1.SPALTE = S2.SPALTE
  AND (S1.FREMDSCHL = S2.TABELLE
  AND NOT EXISTS
    (SELECT *
       FROM SPALTEN S3
      WHERE S1.TABELLE = S3.TABELLE
        AND S1.FREMDSCHL = S3.FREMDSCHL
        AND S3.SPALTE NOT IN
                (SELECT S4.SPALTE
                   FROM SPALTEN S4
                  WHERE S2.TABELLE = S4.TABELLE
                )
    )
OR
    S2.FREMDSCHL = S1.TABELLE
AND NOT EXISTS
   (SELECT *
      FROM SPALTEN S3
     WHERE S2.TABELLE = S3.TABELLE
       AND S2.FREMDSCHL = S3.FREMDSCHL
       AND S3.SPALTE NOT IN
           (SELECT S4.SPALTE
              FROM SPALTEN S4
             WHERE S1.TABELLE = S4.TABELLE
           )
   )
)!
 
c 30 'Tabellen' c 30 'Indices'
 
resultcount :                     0
 
Enter command:
NODATA !
 
Enter command:
FETCH INTO :A !
 
BEDINGUNG         :  Tabellen.Tabelle = Indices.Tabelle
 
resultcount :                     1
 
Enter command:
DATA !
 
Enter command:
SELECT S1.TABELLE || '.' || S1.SPALTE || ' = ' ||
       S2.TABELLE || '.' || S1.SPALTE BEDINGUNG
FROM SPALTEN S1, SPALTEN S2
WHERE S1.TABELLE = :A
  AND S2.TABELLE = :B
  AND S1.SPALTE = S2.SPALTE
  AND (S1.FREMDSCHL = S2.TABELLE
  AND NOT EXISTS
    (SELECT *
       FROM SPALTEN S3
      WHERE S1.TABELLE = S3.TABELLE
        AND S1.FREMDSCHL = S3.FREMDSCHL
        AND S3.SPALTE NOT IN
                (SELECT S4.SPALTE
                   FROM SPALTEN S4
                  WHERE S2.TABELLE = S4.TABELLE
                )
    )
OR
    S2.FREMDSCHL = S1.TABELLE
AND NOT EXISTS
   (SELECT *
      FROM SPALTEN S3
     WHERE S2.TABELLE = S3.TABELLE
       AND S2.FREMDSCHL = S3.FREMDSCHL
       AND S3.SPALTE NOT IN
           (SELECT S4.SPALTE
              FROM SPALTEN S4
             WHERE S1.TABELLE = S4.TABELLE
           )
   )
)!
 
c 30 'Index_Spalten' c 30 'Indices'
 
resultcount :                     0
 
Enter command:
NODATA !
 
Enter command:
FETCH INTO :A !
 
BEDINGUNG         :  Index_Spalten.Tabelle = Indices.Tabelle
--------------------------------------------------------------------------------
BEDINGUNG         :  Index_Spalten.Index_Name = Indices.Index_Name
 
resultcount :                     2
 
Enter command:
PARS_EXECUTE!
 
Enter command:
DROP TABLE TABELLEN !
 
Enter command:
DROP TABLE SPALTEN !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
FILE CONNECT ( SUT SUT !
 
Enter command:
CONNECT SUT IDENTIFIED BY SUT   ISOLATION LEVEL 1 !
 
Enter command:
DROP USER KERN !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( SUT SUT !
 
Enter command:
CONNECT SUT IDENTIFIED BY SUT   ISOLATION LEVEL 1 !
 
Enter command:
CREATE USER KERN PASSWORD TEST DBA NOT EXCLUSIVE !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST SQLMODE ORACLE !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE ORACLE ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE AUTOREN (
AUT_ID NUMBER CONSTRAINT AUTOREN_PK PRIMARY KEY,
NAME   VARCHAR(20))!
 
Enter command:
INSERT INTO AUTOREN VALUES (1, 'Bartels   ')!
 
Enter command:
INSERT INTO AUTOREN VALUES (2, 'Lenz      ')!
 
Enter command:
INSERT INTO AUTOREN VALUES (3, 'Unbescheid')!
 
Enter command:
INSERT INTO AUTOREN VALUES (4, 'Hermann   ')!
 
Enter command:
INSERT INTO AUTOREN VALUES (5, 'Stuerner  ')!
 
Enter command:
INSERT INTO AUTOREN VALUES (6, 'Wiesmeier ')!
 
Enter command:
CREATE TABLE BUECHER (
BUCH_ID NUMBER CONSTRAINT BUECHER_PK PRIMARY KEY,
TITEL   VARCHAR(20))!
 
Enter command:
INSERT INTO BUECHER VALUES (1, 'Oracle7    ')!
 
Enter command:
INSERT INTO BUECHER VALUES (2, 'SQL*Net    ')!
 
Enter command:
INSERT INTO BUECHER VALUES (3, 'Datenbanken')!
 
Enter command:
INSERT INTO BUECHER VALUES (4, 'Objekte    ')!
 
Enter command:
CREATE TABLE AUTOREN_REFERENZ (
BUCH_ID NUMBER CONSTRAINT REF_BUCH_FK REFERENCES BUECHER,
AUT_ID  NUMBER CONSTRAINT REF_AUTOR_FK REFERENCES AUTOREN,
LFD_NR  NUMBER,
CONSTRAINT AUTOREN_REFERENZ_PK PRIMARY KEY (BUCH_ID, AUT_ID, LFD_NR))!
 
Enter command:
INSERT INTO AUTOREN_REFERENZ VALUES (1, 1, 1)!
 
Enter command:
INSERT INTO AUTOREN_REFERENZ VALUES (2, 3, 2)!
 
Enter command:
INSERT INTO AUTOREN_REFERENZ VALUES (4, 3, 1)!
 
Enter command:
INSERT INTO AUTOREN_REFERENZ VALUES (3, 3, 3)!
 
Enter command:
INSERT INTO AUTOREN_REFERENZ VALUES (3, 4, 2)!
 
Enter command:
INSERT INTO AUTOREN_REFERENZ VALUES (3, 5, 1)!
 
Enter command:
INSERT INTO AUTOREN_REFERENZ VALUES (2, 6, 1)!
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
FILE CONNECT ( KERN TEST !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST   ISOLATION LEVEL 1 !
 
Enter command:
SELECT DECODE (ANZ_AUTOREN, 1, AUT1.NAME,
                            2, AUT1.NAME || ', ' || AUT2.NAME,
                               AUT1.NAME || ' et al') NAME,
       TITEL
FROM (SELECT BUCH_ID, COUNT(*) ANZ_AUTOREN
        FROM AUTOREN_REFERENZ
       GROUP BY BUCH_ID) CNTTAB,
      AUTOREN_REFERENZ AR,
      (SELECT BUCH_ID, NAME
         FROM AUTOREN_REFERENZ, AUTOREN
        WHERE AUTOREN_REFERENZ.AUT_ID = AUTOREN.AUT_ID
          AND LFD_NR = 1) AUT1,
      (SELECT BUCH_ID, NAME
         FROM AUTOREN_REFERENZ, AUTOREN
        WHERE AUTOREN_REFERENZ.AUT_ID = AUTOREN.AUT_ID
          AND (BUCH_ID, LFD_NR) = ANY (SELECT BUCH_ID, MAX(LFD_NR)
                                         FROM AUTOREN_REFERENZ
                                        GROUP BY BUCH_ID)) AUT2,
      BUECHER
WHERE AR.BUCH_ID = CNTTAB.BUCH_ID
  AND AR.BUCH_ID = AUT1.BUCH_ID
  AND AR.BUCH_ID = AUT2.BUCH_ID
  AND AR.BUCH_ID = BUECHER.BUCH_ID
  AND AR.LFD_NR  = 1
ORDER BY AR.BUCH_ID !
 
resultcount :                     4
 
Enter command:
FETCH!
 
NAME                                       | TITEL
-------------------------------------------+---------------------
Bartels                                    | Oracle7
Wiesmeier, Unbescheid                      | SQL*Net
Stuerner et al                             | Datenbanken
Unbescheid                                 | Objekte
 
resultcount :                     4
 
Enter command:
 
SELECT A.NAME, B.TITEL
  FROM BUECHER B,
       AUTOREN A,
       AUTOREN_REFERENZ R
 WHERE A.AUT_ID = R.AUT_ID
  AND B.BUCH_ID = R.BUCH_ID
  AND R.LFD_NR = 1
  AND 1 = (SELECT COUNT (*)
             FROM AUTOREN_REFERENZ RI
            WHERE B.BUCH_ID = RI.BUCH_ID)
UNION
SELECT A1.NAME || ', ' || A2.NAME NAME, B.TITEL
  FROM BUECHER B,
       AUTOREN A1,
       AUTOREN A2,
       AUTOREN_REFERENZ R1,
       AUTOREN_REFERENZ R2
 WHERE A1.AUT_ID = R1.AUT_ID
   AND A2.AUT_ID = R2.AUT_ID
   AND B.BUCH_ID = R1.BUCH_ID
   AND B.BUCH_ID = R2.BUCH_ID
   AND R1.LFD_NR = 1
   AND R2.LFD_NR = 2
   AND R1.BUCH_ID IN
          (SELECT RI.BUCH_ID
             FROM AUTOREN_REFERENZ RI
            GROUP BY RI.BUCH_ID
            HAVING COUNT(*) = 2 )
UNION
SELECT A.NAME || ' et. al.' NAME, B.TITEL
  FROM BUECHER B,
       AUTOREN A,
       AUTOREN_REFERENZ R
 WHERE A.AUT_ID = R.AUT_ID
   AND B.BUCH_ID = R.BUCH_ID
   AND R.LFD_NR = 1
   AND EXISTS (SELECT *
                 FROM AUTOREN_REFERENZ RI
                WHERE B.BUCH_ID = RI.BUCH_ID
                  AND RI.LFD_NR = 3)
ORDER BY 1 !
 
resultcount :                     4
 
Enter command:
FETCH INTO :A, :B !
 
NAME                                       | TITEL
-------------------------------------------+---------------------
Bartels                                    | Oracle7
Stuerner et. al.                           | Datenbanken
Unbescheid                                 | Objekte
Wiesmeier, Unbescheid                      | SQL*Net
 
resultcount :                     4
 
Enter command:
 
SELECT DECODE (AUT_ANZ.ANZAHL,
               1, A1.NAME,
               2, A1.NAME || ', ' || A2.NAME,
               A1.NAME || ' et. al.') NAME,
       B.TITEL
  FROM BUECHER B,
       AUTOREN A1,
       AUTOREN A2,
       AUTOREN_REFERENZ R1,
       AUTOREN_REFERENZ R2,
       (SELECT RI.BUCH_ID, COUNT(*) ANZAHL
          FROM AUTOREN_REFERENZ RI
         WHERE RI.LFD_NR <= 3
         GROUP BY RI.BUCH_ID) AUT_ANZ
 WHERE A1.AUT_ID      = R1.AUT_ID
   AND A2.AUT_ID (+)  = R2.AUT_ID
   AND B.BUCH_ID      = R1.BUCH_ID
   AND B.BUCH_ID      = R2.BUCH_ID (+)
   AND R1.LFD_NR      = 1
   AND R2.LFD_NR (+)  = 2
   AND R1.BUCH_ID     = AUT_ANZ.BUCH_ID
ORDER BY 1 !
 
resultcount :                     2
 
Enter command:
FETCH INTO :A, :B !
 
NAME                                       | TITEL
-------------------------------------------+---------------------
Stuerner et. al.                           | Datenbanken
Wiesmeier, Unbescheid                      | SQL*Net
 
resultcount :                     2
 
Enter command:
DROP TABLE AUTOREN !
 
Enter command:
DROP TABLE BUECHER !
 
Enter command:
DROP TABLE AUTOREN_REFERENZ !
 
Enter command:
COMMIT RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST SQLMODE ORACLE !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE ORACLE ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE FIRMEN (
F_ID   NUMBER CONSTRAINT FIRMEN_PK PRIMARY KEY,
F_NAME VARCHAR (20))!
 
Enter command:
INSERT INTO FIRMEN VALUES (1, 'Autohaus Meyer  ')!
 
Enter command:
INSERT INTO FIRMEN VALUES (8, 'Friseur Schulz  ')!
 
Enter command:
INSERT INTO FIRMEN VALUES (5, 'Klempner Schmidt')!
 
Enter command:
INSERT INTO FIRMEN VALUES (9, 'Werkstatt Grefe ')!
 
Enter command:
COMMIT !
 
Enter command:
CREATE TABLE PERSONEN (
P_ID    NUMBER CONSTRAINT PERSONEN_PK PRIMARY KEY,
P_F_ID  NUMBER CONSTRAINT PERSONEN_FIRMEN_FK REFERENCES FIRMEN,
P_NAME  VARCHAR (20))!
 
Enter command:
INSERT INTO PERSONEN VALUES (11, 5, 'Albrecht   ')!
 
Enter command:
INSERT INTO PERSONEN VALUES (22, 5, 'Clausen    ')!
 
Enter command:
INSERT INTO PERSONEN VALUES (55, 1, 'Fritz      ')!
 
Enter command:
INSERT INTO PERSONEN VALUES ( 9, 5, 'Graber     ')!
 
Enter command:
INSERT INTO PERSONEN VALUES (36, 9, 'Hansen     ')!
 
Enter command:
INSERT INTO PERSONEN VALUES (44, 9, 'Herrmann   ')!
 
Enter command:
INSERT INTO PERSONEN VALUES (77, 5, 'Jensen     ')!
 
Enter command:
INSERT INTO PERSONEN VALUES ( 2, 5, 'Kunz       ')!
 
Enter command:
INSERT INTO PERSONEN VALUES (56, 5, 'Linke      ')!
 
Enter command:
INSERT INTO PERSONEN VALUES (23, 8, 'Linkwitz   ')!
 
Enter command:
INSERT INTO PERSONEN VALUES (14, 1, 'Paulsen    ')!
 
Enter command:
INSERT INTO PERSONEN VALUES (12, 5, 'Petersen   ')!
 
Enter command:
INSERT INTO PERSONEN VALUES (25, 9, 'Rackwitz   ')!
 
Enter command:
INSERT INTO PERSONEN VALUES ( 5, 1, 'Schweizer  ')!
 
Enter command:
INSERT INTO PERSONEN VALUES (13, 5, 'Weidert    ')!
 
Enter command:
INSERT INTO PERSONEN VALUES (33, 9, 'Zimmer     ')!
 
Enter command:
COMMIT !
 
Enter command:
SELECT F_NAME, P_NAME, X.NUMMER
  FROM FIRMEN, PERSONEN,
       (SELECT COUNT(*) NUMMER, P1.P_ID
          FROM PERSONEN P1, PERSONEN P2
         WHERE P1.P_ID  >= P2.P_ID
           AND P1.P_F_ID = P2.P_F_ID
         GROUP BY P1.P_ID
       ) X
 WHERE FIRMEN.F_ID = PERSONEN.P_F_ID
   AND X.P_ID = PERSONEN.P_ID
   AND MOD (X.NUMMER, 3) = 1
ORDER BY 1,3 !
 
resultcount :                     0
 
Enter command:
FETCH INTO :A, :B, :C !
 
F_NAME               | P_NAME               | NUMMER
---------------------+----------------------+------------
Autohaus Meyer       | Schweizer            |           1
Friseur Schulz       | Linkwitz             |           1
Klempner Schmidt     | Kunz                 |           1
Klempner Schmidt     | Petersen             |           4
Klempner Schmidt     | Linke                |           7
Werkstatt Grefe      | Rackwitz             |           1
Werkstatt Grefe      | Herrmann             |           4
 
resultcount :                     7
 
Enter command:
SELECT F.F_NAME, P.P_NAME, COUNT(*) NUMMER
  FROM FIRMEN F,
       PERSONEN P,
       PERSONEN PZ
 WHERE F.F_ID   = P.P_F_ID
   AND P.P_F_ID = PZ.P_F_ID
   AND P.P_ID  >= PZ.P_ID
GROUP BY F.F_NAME, F.F_ID, P.P_NAME, P.P_ID
HAVING MOD(COUNT(*), 3) = 1
ORDER BY F_NAME, NUMMER !
 
resultcount :                     0
 
Enter command:
FETCH INTO :A, :B, :C !
 
F_NAME               | P_NAME               | NUMMER
---------------------+----------------------+------------
Autohaus Meyer       | Schweizer            |           1
Friseur Schulz       | Linkwitz             |           1
Klempner Schmidt     | Kunz                 |           1
Klempner Schmidt     | Petersen             |           4
Klempner Schmidt     | Linke                |           7
Werkstatt Grefe      | Rackwitz             |           1
Werkstatt Grefe      | Herrmann             |           4
 
resultcount :                     7
 
Enter command:
DROP TABLE FIRMEN !
 
Enter command:
DROP TABLE PERSONEN !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST SQLMODE ORACLE !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE ORACLE ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE MITARBEITER (
M_ID   NUMBER CONSTRAINT MA_PK PRIMARY KEY,
NAME   VARCHAR (10) NOT NULL)!
 
Enter command:
INSERT INTO MITARBEITER VALUES (2, 'Fitz')!
 
Enter command:
INSERT INTO MITARBEITER VALUES (3, 'Lenz')!
 
Enter command:
INSERT INTO MITARBEITER VALUES (1, 'Ofer')!
 
Enter command:
COMMIT WORK !
 
Enter command:
CREATE TABLE KENNTNISSE (
M_ID           NUMBER CONSTRAINT K_MA_FK REFERENCES MITARBEITER,
BEZEICHNUNG    VARCHAR (10),
CONSTRAINT K_PK PRIMARY KEY (M_ID, BEZEICHNUNG)) !
 
Enter command:
INSERT INTO KENNTNISSE VALUES (1, '4GL       ')!
 
Enter command:
INSERT INTO KENNTNISSE VALUES (3, 'C         ')!
 
Enter command:
INSERT INTO KENNTNISSE VALUES (3, 'C++       ')!
 
Enter command:
INSERT INTO KENNTNISSE VALUES (2, 'CICS      ')!
 
Enter command:
INSERT INTO KENNTNISSE VALUES (2, 'COBOL     ')!
 
Enter command:
INSERT INTO KENNTNISSE VALUES (3, 'DB-LIB    ')!
 
Enter command:
INSERT INTO KENNTNISSE VALUES (2, 'DB2 DBA   ')!
 
Enter command:
INSERT INTO KENNTNISSE VALUES (2, 'JCL       ')!
 
Enter command:
INSERT INTO KENNTNISSE VALUES (1, 'ORACLE DBA')!
 
Enter command:
INSERT INTO KENNTNISSE VALUES (3, 'SQL       ')!
 
Enter command:
INSERT INTO KENNTNISSE VALUES (1, 'SQL*NET   ')!
 
Enter command:
INSERT INTO KENNTNISSE VALUES (3, 'SYBASE DBA')!
 
Enter command:
COMMIT WORK !
 
Enter command:
CREATE TABLE OFFENE_POSITIONEN (
POS_ID       NUMBER,
BEZEICHNUNG  VARCHAR (10),
CONSTRAINT OP_PK PRIMARY KEY (POS_ID))!
 
Enter command:
INSERT INTO OFFENE_POSITIONEN VALUES (1, 'Entwickler')!
 
Enter command:
INSERT INTO OFFENE_POSITIONEN VALUES (2, 'WEB Spezi ')!
 
Enter command:
INSERT INTO OFFENE_POSITIONEN VALUES (3, 'Entwickler')!
 
Enter command:
INSERT INTO OFFENE_POSITIONEN VALUES (4, 'Entwickler')!
 
Enter command:
COMMIT !
 
Enter command:
CREATE TABLE NOTWENDIGE_KENNTNISSE (
POS_ID        NUMBER,
BEZEICHNUNG   VARCHAR (10),
CONSTRAINT NK_PK PRIMARY KEY (POS_ID, BEZEICHNUNG),
CONSTRAINT NK_OP_FK FOREIGN KEY (POS_ID) REFERENCES OFFENE_POSITIONEN)!
 
Enter command:
INSERT INTO NOTWENDIGE_KENNTNISSE VALUES (1, '4GL       ')!
 
Enter command:
INSERT INTO NOTWENDIGE_KENNTNISSE VALUES (2, 'C++       ')!
 
Enter command:
INSERT INTO NOTWENDIGE_KENNTNISSE VALUES (3, 'CICS      ')!
 
Enter command:
INSERT INTO NOTWENDIGE_KENNTNISSE VALUES (3, 'COBOL     ')!
 
Enter command:
INSERT INTO NOTWENDIGE_KENNTNISSE VALUES (2, 'DB2 DBA   ')!
 
Enter command:
INSERT INTO NOTWENDIGE_KENNTNISSE VALUES (2, 'JAVA      ')!
 
Enter command:
INSERT INTO NOTWENDIGE_KENNTNISSE VALUES (1, 'ORACLE DBA')!
 
Enter command:
INSERT INTO NOTWENDIGE_KENNTNISSE VALUES (2, 'SQL       ')!
 
Enter command:
INSERT INTO NOTWENDIGE_KENNTNISSE VALUES (4, 'ORACLE DBA')!
 
Enter command:
INSERT INTO NOTWENDIGE_KENNTNISSE VALUES (4, 'COBOL     ')!
 
Enter command:
INSERT INTO NOTWENDIGE_KENNTNISSE VALUES (4, 'SQL       ')!
 
Enter command:
COMMIT WORK !
 
Enter command:
SELECT OP.POS_ID, OP.BEZEICHNUNG
  FROM OFFENE_POSITIONEN OP, NOTWENDIGE_KENNTNISSE NOT_K
 WHERE OP.POS_ID = NOT_K.POS_ID
GROUP BY OP.POS_ID, OP.BEZEICHNUNG
HAVING COUNT(*) > ALL (SELECT COUNT(K.BEZEICHNUNG)
                         FROM KENNTNISSE K, NOTWENDIGE_KENNTNISSE NK
                        WHERE K.BEZEICHNUNG = NK.BEZEICHNUNG
                          AND NK.POS_ID = OP.POS_ID
                        GROUP BY K.M_ID)!
 
resultcount :                     0
 
Enter command:
FETCH INTO :A, :B !
 
POS_ID                     | BEZEICHNUNG
---------------------------+------------
 2.0000000000000000000E+00 | WEB Spezi
 4.0000000000000000000E+00 | Entwickler
 
resultcount :                     2
 
Enter command:
SELECT POS_ID, BEZEICHNUNG
  FROM OFFENE_POSITIONEN O
 WHERE NOT EXISTS
       (SELECT K.M_ID, COUNT(NK.BEZEICHNUNG)
          FROM NOTWENDIGE_KENNTNISSE NK,
               KENNTNISSE K
         WHERE NK.BEZEICHNUNG = K.BEZEICHNUNG
           AND NK.POS_ID = O.POS_ID
          GROUP BY NK.POS_ID, K.M_ID
          HAVING COUNT (NK.BEZEICHNUNG) =
                              (SELECT COUNT (NK2.BEZEICHNUNG)
                                 FROM NOTWENDIGE_KENNTNISSE NK2
                                WHERE NK.POS_ID = NK2.POS_ID
                              )
       ) !
 
resultcount :                     0
 
Enter command:
FETCH INTO :A, :B !
 
POS_ID                     | BEZEICHNUNG
---------------------------+------------
 2.0000000000000000000E+00 | WEB Spezi
 4.0000000000000000000E+00 | Entwickler
 
resultcount :                     2
 
Enter command:
DROP TABLE MITARBEITER !
 
Enter command:
DROP TABLE KENNTNISSE !
 
Enter command:
DROP TABLE OFFENE_POSITIONEN !
 
Enter command:
DROP TABLE NOTWENDIGE_KENNTNISSE !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
 
FILE CONNECT ( KERN TEST SQLMODE ORACLE !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE ORACLE ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE AUFTRAG (
AUF_ID  INTEGER CONSTRAINT AUFTRAG_PK PRIMARY KEY,
KD_NAME VARCHAR (10) NOT NULL)!
 
Enter command:
INSERT INTO AUFTRAG VALUES (1, 'Parthier')!
 
Enter command:
INSERT INTO AUFTRAG VALUES (2, 'Jansen')!
 
Enter command:
INSERT INTO AUFTRAG VALUES (3, 'Hagner')!
 
Enter command:
CREATE TABLE POSITION (
AUF_ID       INTEGER CONSTRAINT POS_AUF_FK REFERENCES AUFTRAG,
POSITION     INTEGER,
MENGE        INTEGER NOT NULL,
BEZEICHNUNG  VARCHAR(10) NOT NULL,
CONSTRAINT POSITION_PK PRIMARY KEY (AUF_ID, POSITION))!
 
Enter command:
INSERT INTO POSITION VALUES (1,1,5,'Blech')!
 
Enter command:
INSERT INTO POSITION VALUES (1,2,3,'Stuetze')!
 
Enter command:
INSERT INTO POSITION VALUES (1,3,2,'Halter')!
 
Enter command:
INSERT INTO POSITION VALUES (2,1,1,'Gehaeuse')!
 
Enter command:
INSERT INTO POSITION VALUES (2,2,4,'Lager')!
 
Enter command:
INSERT INTO POSITION VALUES (2,3,5,'Korpus')!
 
Enter command:
INSERT INTO POSITION VALUES (3,1,3,'Blech')!
 
Enter command:
INSERT INTO POSITION VALUES (3,2,1,'Lager')!
 
Enter command:
CREATE TABLE MASCHINE (
M_ID        INTEGER CONSTRAINT MASCHINE_PK PRIMARY KEY,
BEZEICHNUNG VARCHAR (10) NOT NULL,
DM_STUNDE   DECIMAL (8,2) NOT NULL)!
 
Enter command:
INSERT INTO MASCHINE VALUES (1, 'M1', 998.98)!
 
Enter command:
INSERT INTO MASCHINE VALUES (2, 'M2', 899.98)!
 
Enter command:
INSERT INTO MASCHINE VALUES (3, 'M3', 699.98)!
 
Enter command:
CREATE TABLE WERKZEUG (
W_ID        INTEGER CONSTRAINT WERKZEUG_PK PRIMARY KEY,
BEZEICHNUNG VARCHAR (10) NOT NULL,
DM_STUNDE   DECIMAL (8,2) NOT NULL)!
 
Enter command:
INSERT INTO WERKZEUG VALUES (1, 'Bohrer  ', 20.22)!
 
Enter command:
INSERT INTO WERKZEUG VALUES (2, 'Saege   ', 30.33)!
 
Enter command:
INSERT INTO WERKZEUG VALUES (3, 'Fraese  ', 40.44)!
 
Enter command:
INSERT INTO WERKZEUG VALUES (4, 'Schleifer',50.55)!
 
Enter command:
INSERT INTO WERKZEUG VALUES (5, 'Dreher  ', 60.66)!
 
Enter command:
CREATE TABLE MASCHINE_WERKZEUG (
M_ID        INTEGER CONSTRAINT MASCH_WK_MASCH_FK REFERENCES MASCHINE,
W_ID        INTEGER CONSTRAINT MASCH_WK_WK_FK REFERENCES WERKZEUG,
MAX_MASS    DECIMAL (8,2) NOT NULL,
CONSTRAINT MASCHINE_WERKZEUG_PK PRIMARY KEY (M_ID, W_ID))!
 
Enter command:
INSERT INTO MASCHINE_WERKZEUG VALUES (1,1,20.5)!
 
Enter command:
INSERT INTO MASCHINE_WERKZEUG VALUES (1,2,30.5)!
 
Enter command:
INSERT INTO MASCHINE_WERKZEUG VALUES (1,3,40.5)!
 
Enter command:
INSERT INTO MASCHINE_WERKZEUG VALUES (1,4,10.5)!
 
Enter command:
INSERT INTO MASCHINE_WERKZEUG VALUES (1,5,20.5)!
 
Enter command:
INSERT INTO MASCHINE_WERKZEUG VALUES (2,1,30.5)!
 
Enter command:
INSERT INTO MASCHINE_WERKZEUG VALUES (2,2,20.5)!
 
Enter command:
INSERT INTO MASCHINE_WERKZEUG VALUES (2,3,20.5)!
 
Enter command:
INSERT INTO MASCHINE_WERKZEUG VALUES (2,4,22.5)!
 
Enter command:
INSERT INTO MASCHINE_WERKZEUG VALUES (2,5,20.5)!
 
Enter command:
INSERT INTO MASCHINE_WERKZEUG VALUES (3,1,20.5)!
 
Enter command:
INSERT INTO MASCHINE_WERKZEUG VALUES (3,3,20.5)!
 
Enter command:
INSERT INTO MASCHINE_WERKZEUG VALUES (3,5,20.5)!
 
Enter command:
CREATE TABLE BEARBEITUNG (
AUF_ID     INTEGER,
POSITION   INTEGER,
SCHRITT    INTEGER,
W_ID       INTEGER NOT NULL CONSTRAINT BEARB_WK_FK REFERENCES WERKZEUG,
MASS       DECIMAL (8,2) NOT NULL,
DAUER      DECIMAL (4,2) NOT NULL,
CONSTRAINT BEARBEITUNG_PK PRIMARY KEY (AUF_ID, POSITION, SCHRITT),
CONSTRAINT BEARB_POS_FK FOREIGN KEY (AUF_ID, POSITION)
                       REFERENCES POSITION)!
 
Enter command:
INSERT INTO BEARBEITUNG VALUES (1,1,1,1,20.2,0.3)!
 
Enter command:
INSERT INTO BEARBEITUNG VALUES (1,1,2,3,20.2,0.1)!
 
Enter command:
INSERT INTO BEARBEITUNG VALUES (1,2,1,5,20.3,0.4)!
 
Enter command:
INSERT INTO BEARBEITUNG VALUES (1,2,2,3,20.1,0.3)!
 
Enter command:
INSERT INTO BEARBEITUNG VALUES (1,3,1,1,20.2,0.5)!
 
Enter command:
INSERT INTO BEARBEITUNG VALUES (1,3,2,5,20.1,0.6)!
 
Enter command:
INSERT INTO BEARBEITUNG VALUES (2,1,1,1,20.2,0.3)!
 
Enter command:
INSERT INTO BEARBEITUNG VALUES (2,1,2,3,20.2,0.1)!
 
Enter command:
INSERT INTO BEARBEITUNG VALUES (2,2,1,5,20.3,0.4)!
 
Enter command:
INSERT INTO BEARBEITUNG VALUES (2,2,2,3,40.1,0.7)!
 
Enter command:
INSERT INTO BEARBEITUNG VALUES (2,3,1,1,20.2,0.5)!
 
Enter command:
INSERT INTO BEARBEITUNG VALUES (2,3,2,5,20.1,0.6)!
 
Enter command:
INSERT INTO BEARBEITUNG VALUES (3,1,1,1,20.2,0.3)!
 
Enter command:
INSERT INTO BEARBEITUNG VALUES (3,1,2,3,20.2,0.1)!
 
Enter command:
INSERT INTO BEARBEITUNG VALUES (3,2,1,4,20.3,0.4)!
 
Enter command:
INSERT INTO BEARBEITUNG VALUES (3,2,2,3,40.1,0.7)!
 
Enter command:
COMMIT WORK RELEASE!
 
Enter command:
FILE CONNECT ( KERN TEST !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST   ISOLATION LEVEL 1 !
 
Enter command:
SELECT A.AUF_ID, M.M_ID, M.BEZEICHNUNG,
 FIXED (SUM(P.MENGE*B.DAUER*(M.DM_STUNDE+W.DM_STUNDE)),10,3)
FROM  AUFTRAG A,
      POSITION P,
      BEARBEITUNG B,
      WERKZEUG W,
      MASCHINE_WERKZEUG M_W,
      MASCHINE M
WHERE A.AUF_ID = P.AUF_ID
  AND P.AUF_ID = B.AUF_ID
  AND P.POSITION = B.POSITION
  AND B.W_ID = W.W_ID
  AND W.W_ID = M_W.W_ID
  AND B.MASS <= M_W.MAX_MASS
  AND M_W.M_ID = M.M_ID
GROUP BY A.AUF_ID, M.M_ID, M.BEZEICHNUNG
HAVING (COUNT(*) , A.AUF_ID) =
     ANY ( SELECT COUNT(*), AUF_ID FROM BEARBEITUNG GROUP BY AUF_ID)!
 
resultcount :                     4
 
Enter command:
FETCH INTO :A, :B, :C, :D !
 
AUF_ID                | M_ID                  | BEZEICHNUNG | EXPRESSION1
----------------------+-----------------------+-------------+-------------
                    1 |                     1 | M1          |     6546.324
                    1 |                     2 | M2          |     5922.624
                    1 |                     3 | M3          |     4662.624
                    2 |                     1 | M1          |    10742.422
 
resultcount :                     4
 
Enter command:
 
SELECT B.AUF_ID, M.M_ID, M.BEZEICHNUNG "Maschine",
       FIXED(SUM(P.MENGE*B.DAUER*(M.DM_STUNDE+W.DM_STUNDE)),7,2) "Preis"
FROM BEARBEITUNG B, WERKZEUG W, MASCHINE M, MASCHINE_WERKZEUG MW,
     POSITION P
WHERE
    B.W_ID = W.W_ID AND
    MW.W_ID = W.W_ID AND
    MW.M_ID = M.M_ID AND
    B.MASS <= MW.MAX_MASS AND
    P.AUF_ID = B.AUF_ID AND
    P.POSITION = B.POSITION
GROUP BY B.AUF_ID, M.M_ID, M.BEZEICHNUNG
HAVING COUNT(B.SCHRITT) = (
  SELECT COUNT(B1.SCHRITT)
  FROM BEARBEITUNG B1
  WHERE B1.AUF_ID = B.AUF_ID
)
ORDER BY B.AUF_ID, M.M_ID!
 
resultcount :                     4
 
Enter command:
FETCH INTO :A, :B, :C, :D !
 
AUF_ID                | M_ID                  | Maschine   | Preis
----------------------+-----------------------+------------+----------
                    1 |                     1 | M1         |   6546.32
                    1 |                     2 | M2         |   5922.62
                    1 |                     3 | M3         |   4662.62
                    2 |                     1 | M1         |  10742.42
 
resultcount :                     4
 
Enter command:
DROP TABLE AUFTRAG !
 
Enter command:
DROP TABLE POSITION !
 
Enter command:
DROP TABLE BEARBEITUNG !
 
Enter command:
DROP TABLE WERKZEUG !
 
Enter command:
DROP TABLE MASCHINE_WERKZEUG !
 
Enter command:
DROP TABLE MASCHINE!
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST SQLMODE ORACLE !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE ORACLE ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE MITARBEITER (
M_ID   NUMBER CONSTRAINT MA_PK PRIMARY KEY,
NAME   VARCHAR (10) NOT NULL)!
 
Enter command:
INSERT INTO MITARBEITER VALUES (2, 'Fitz')!
 
Enter command:
INSERT INTO MITARBEITER VALUES (3, 'Lenz')!
 
Enter command:
INSERT INTO MITARBEITER VALUES (1, 'Ofer')!
 
Enter command:
COMMIT WORK !
 
Enter command:
CREATE TABLE KENNTNISSE (
K_ID           NUMBER CONSTRAINT K_PK PRIMARY KEY,
BEZEICHNUNG    VARCHAR (10))!
 
Enter command:
INSERT INTO KENNTNISSE VALUES (1, '4GL       ')!
 
Enter command:
INSERT INTO KENNTNISSE VALUES (2, 'C         ')!
 
Enter command:
INSERT INTO KENNTNISSE VALUES (3, 'C++       ')!
 
Enter command:
INSERT INTO KENNTNISSE VALUES (4, 'CICS      ')!
 
Enter command:
INSERT INTO KENNTNISSE VALUES (5, 'COBOL     ')!
 
Enter command:
INSERT INTO KENNTNISSE VALUES (6, 'DB-LIB    ')!
 
Enter command:
INSERT INTO KENNTNISSE VALUES (7, 'DB2 DBA   ')!
 
Enter command:
INSERT INTO KENNTNISSE VALUES (8, 'JAVA      ')!
 
Enter command:
INSERT INTO KENNTNISSE VALUES (9, 'JCL       ')!
 
Enter command:
INSERT INTO KENNTNISSE VALUES (10, 'ORACLE DBA')!
 
Enter command:
INSERT INTO KENNTNISSE VALUES (11, 'SQL       ')!
 
Enter command:
INSERT INTO KENNTNISSE VALUES (12, 'SQL*NET   ')!
 
Enter command:
INSERT INTO KENNTNISSE VALUES (13, 'SYBASE DBA')!
 
Enter command:
COMMIT WORK !
 
Enter command:
CREATE TABLE VORHANDENE_KENNTNISSE (
M_ID         NUMBER CONSTRAINT VK_M_FK REFERENCES MITARBEITER,
K_ID         NUMBER CONSTRAINT VK_K_FK REFERENCES KENNTNISSE,
CONSTRAINT NK_PK PRIMARY KEY (M_ID, K_ID)) !
 
Enter command:
INSERT INTO VORHANDENE_KENNTNISSE VALUES (1, 1)!
 
Enter command:
INSERT INTO VORHANDENE_KENNTNISSE VALUES (3, 2)!
 
Enter command:
INSERT INTO VORHANDENE_KENNTNISSE VALUES (3, 3)!
 
Enter command:
INSERT INTO VORHANDENE_KENNTNISSE VALUES (2, 4)!
 
Enter command:
INSERT INTO VORHANDENE_KENNTNISSE VALUES (2, 5)!
 
Enter command:
INSERT INTO VORHANDENE_KENNTNISSE VALUES (3, 6)!
 
Enter command:
INSERT INTO VORHANDENE_KENNTNISSE VALUES (2, 7)!
 
Enter command:
INSERT INTO VORHANDENE_KENNTNISSE VALUES (2, 9)!
 
Enter command:
INSERT INTO VORHANDENE_KENNTNISSE VALUES (1,10)!
 
Enter command:
INSERT INTO VORHANDENE_KENNTNISSE VALUES (3,11)!
 
Enter command:
INSERT INTO VORHANDENE_KENNTNISSE VALUES (1,12)!
 
Enter command:
INSERT INTO VORHANDENE_KENNTNISSE VALUES (3,13)!
 
Enter command:
COMMIT WORK !
 
Enter command:
CREATE TABLE OFFENE_POSITIONEN (
POS_ID       NUMBER,
BEZEICHNUNG  VARCHAR (10),
CONSTRAINT OP_PK PRIMARY KEY (POS_ID))!
 
Enter command:
INSERT INTO OFFENE_POSITIONEN VALUES (1, 'Entwickler')!
 
Enter command:
INSERT INTO OFFENE_POSITIONEN VALUES (2, 'WEB Spezi ')!
 
Enter command:
INSERT INTO OFFENE_POSITIONEN VALUES (3, 'Entwickler')!
 
Enter command:
INSERT INTO OFFENE_POSITIONEN VALUES (4, 'Entwickler')!
 
Enter command:
COMMIT !
 
Enter command:
CREATE TABLE NOTWENDIGE_KENNTNISSE (
POS_ID        NUMBER CONSTRAINT NK_OP_FK REFERENCES OFFENE_POSITIONEN,
K_ID          NUMBER CONSTRAINT NK_K__FK REFERENCES KENNTNISSE,
CONSTRAINT NK_PK PRIMARY KEY (POS_ID, K_ID))!
 
Enter command:
INSERT INTO NOTWENDIGE_KENNTNISSE VALUES (1, 1)!
 
Enter command:
INSERT INTO NOTWENDIGE_KENNTNISSE VALUES (2, 3)!
 
Enter command:
INSERT INTO NOTWENDIGE_KENNTNISSE VALUES (3, 4)!
 
Enter command:
INSERT INTO NOTWENDIGE_KENNTNISSE VALUES (3, 5)!
 
Enter command:
INSERT INTO NOTWENDIGE_KENNTNISSE VALUES (4, 5)!
 
Enter command:
INSERT INTO NOTWENDIGE_KENNTNISSE VALUES (2, 7)!
 
Enter command:
INSERT INTO NOTWENDIGE_KENNTNISSE VALUES (2, 8)!
 
Enter command:
INSERT INTO NOTWENDIGE_KENNTNISSE VALUES (1,10)!
 
Enter command:
INSERT INTO NOTWENDIGE_KENNTNISSE VALUES (4,10)!
 
Enter command:
INSERT INTO NOTWENDIGE_KENNTNISSE VALUES (2,11)!
 
Enter command:
INSERT INTO NOTWENDIGE_KENNTNISSE VALUES (4,11)!
 
Enter command:
COMMIT WORK !
 
Enter command:
SELECT OP.POS_ID, OP.BEZEICHNUNG, NAME
  FROM OFFENE_POSITIONEN OP,
       MITARBEITER M,
       VORHANDENE_KENNTNISSE VK,
       NOTWENDIGE_KENNTNISSE NK
 WHERE OP.POS_ID = NK.POS_ID
   AND NK.K_ID   = VK.K_ID
   AND M.M_ID    = VK.M_ID
GROUP BY OP.POS_ID, OP.BEZEICHNUNG, NAME
HAVING COUNT(*) >= ALL ( SELECT COUNT(*)
                  FROM VORHANDENE_KENNTNISSE VK,
                       NOTWENDIGE_KENNTNISSE NK
                 WHERE NK.POS_ID  = OP.POS_ID
                   AND NK.K_ID   = VK.K_ID
                GROUP BY VK.M_ID
                  ) !
 
resultcount :                     0
 
Enter command:
FETCH INTO :A, :B, :C !
 
POS_ID                     | BEZEICHNUNG | NAME
---------------------------+-------------+-----------
 1.0000000000000000000E+00 | Entwickler  | Ofer
 2.0000000000000000000E+00 | WEB Spezi   | Lenz
 3.0000000000000000000E+00 | Entwickler  | Fitz
 4.0000000000000000000E+00 | Entwickler  | Fitz
 4.0000000000000000000E+00 | Entwickler  | Lenz
 4.0000000000000000000E+00 | Entwickler  | Ofer
 
resultcount :                     6
 
Enter command:
SELECT OP.POS_ID, OP.BEZEICHNUNG, NAME
  FROM OFFENE_POSITIONEN OP,
       MITARBEITER M,
       VORHANDENE_KENNTNISSE VK,
       NOTWENDIGE_KENNTNISSE NK
 WHERE OP.POS_ID = NK.POS_ID
   AND NK.K_ID   = VK.K_ID
   AND M.M_ID    = VK.M_ID
GROUP BY OP.POS_ID, OP.BEZEICHNUNG, NAME
HAVING NOT EXISTS (SELECT VK1.M_ID
                  FROM VORHANDENE_KENNTNISSE VK1,
                       NOTWENDIGE_KENNTNISSE NK1
                 WHERE NK1.POS_ID = OP.POS_ID
                   AND NK1.K_ID   = VK1.K_ID
                GROUP BY VK1.M_ID
    HAVING COUNT (VK1.K_ID) > COUNT (VK.K_ID)
                  ) !
 
resultcount :                     0
 
Enter command:
PARS_EXECUTE!
 
Enter command:
FETCH INTO :A, :B, :C !
 
POS_ID                     | BEZEICHNUNG | NAME
---------------------------+-------------+-----------
 1.0000000000000000000E+00 | Entwickler  | Ofer
 2.0000000000000000000E+00 | WEB Spezi   | Lenz
 3.0000000000000000000E+00 | Entwickler  | Fitz
 4.0000000000000000000E+00 | Entwickler  | Fitz
 4.0000000000000000000E+00 | Entwickler  | Lenz
 4.0000000000000000000E+00 | Entwickler  | Ofer
 
resultcount :                     6
 
Enter command:
DROP TABLE MITARBEITER !
 
Enter command:
DROP TABLE KENNTNISSE !
 
Enter command:
DROP TABLE VORHANDENE_KENNTNISSE !
 
Enter command:
DROP TABLE OFFENE_POSITIONEN !
 
Enter command:
DROP TABLE NOTWENDIGE_KENNTNISSE !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST   ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE KFZ (
KENNZEICHEN   VARCHAR (20) PRIMARY KEY,
AVG_VERBRAUCH DECIMAL)!
 
Enter command:
INSERT INTO KFZ VALUES ('HH-XY 1224', 10)!
 
Enter command:
INSERT INTO KFZ VALUES ('M-OC 5447', 12)!
 
Enter command:
INSERT INTO KFZ VALUES ('XQ-BZ 9090', 11)!
 
Enter command:
INSERT INTO KFZ VALUES ('QU-AA 0815', 13)!
 
Enter command:
CREATE TABLE TANKEN (
KENNZEICHEN VARCHAR (20) CONSTRAINT T_K_FK REFERENCES KFZ,
DAT         DATE NOT NULL,
KM          INTEGER CONSTRAINT T_KM_CHECK CHECK (KM > 0),
MENGE       DECIMAL NOT NULL CONSTRAINT T_M_CHECK CHECK (MENGE > 0),
PRIMARY KEY (KENNZEICHEN, KM))!
 
Enter command:
COMMIT RELEASE !
 
Enter command:
FILE CONNECT ( KERN TEST !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST   ISOLATION LEVEL 1 !
 
Enter command:
SET FORMAT EUR !
 
Enter command:
INSERT INTO TANKEN VALUES ('HH-XY 1224', '10.03.1997', 13100, 40)!
 
Enter command:
INSERT INTO TANKEN VALUES ('HH-XY 1224', '11.04.1997', 13800, 40)!
 
Enter command:
INSERT INTO TANKEN VALUES ('XQ-BZ 9090', '13.03.1997', 46720, 55)!
 
Enter command:
INSERT INTO TANKEN VALUES ('XQ-BZ 9090', '17.03.1997', 47320, 65)!
 
Enter command:
INSERT INTO TANKEN VALUES ('M-OC 5447' , '20.02.1997', 12345, 55)!
 
Enter command:
INSERT INTO TANKEN VALUES ('HH-XY 1224', '20.03.1997', 13420, 40)!
 
Enter command:
INSERT INTO TANKEN VALUES ('M-OC 5447' , '20.04.1997', 13870, 62)!
 
Enter command:
INSERT INTO TANKEN VALUES ('HH-XY 1224', '22.02.1997', 12345, 55)!
 
Enter command:
INSERT INTO TANKEN VALUES ('QU-AA 0815', '22.02.1997', 44556, 50)!
 
Enter command:
INSERT INTO TANKEN VALUES ('XQ-BZ 9090', '22.02.1997', 45678, 70)!
 
Enter command:
INSERT INTO TANKEN VALUES ('M-OC 5447' , '22.02.1997',128451, 62)!
 
Enter command:
INSERT INTO TANKEN VALUES ('M-OC 5447' , '22.04.1997', 14350, 58)!
 
Enter command:
INSERT INTO TANKEN VALUES ('QU-AA 0815', '22.04.1997', 45500, 60)!
 
Enter command:
INSERT INTO TANKEN VALUES ('QU-AA 0815', '23.04.1997', 46000, 65)!
 
Enter command:
INSERT INTO TANKEN VALUES ('QU-AA 0815', '24.02.1997',  5000, 65)!
 
Enter command:
INSERT INTO TANKEN VALUES ('HH-XY 1224', '25.02.1997', 12750, 40)!
 
Enter command:
INSERT INTO TANKEN VALUES ('XQ-BZ 9090', '25.02.1997', 45865, 60)!
 
Enter command:
INSERT INTO TANKEN VALUES ('QU-AA 0815', '27.03.1997', 45400, 50)!
 
Enter command:
INSERT INTO TANKEN VALUES ('QU-AA 0815', '27.04.1997', 46400, 60)!
 
Enter command:
INSERT INTO TANKEN VALUES ('XQ-BZ 9090', '28.02.1997', 46223, 50)!
 
Enter command:
INSERT INTO TANKEN VALUES ('M-OC 5447' , '30.03.1997', 13320, 63)!
 
Enter command:
SET FORMAT INTERNAL!
 
Enter command:
ALTER TABLE TANKEN ADD DATUM TIMESTAMP!
 
Enter command:
UPDATE TANKEN SET DATUM = TIMESTAMP (DAT, TIME)!
 
resultcount :                    21
 
Enter command:
COMMIT RELEASE !
 
Enter command:
FILE CONNECT ( KERN TEST !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST   ISOLATION LEVEL 1 !
 
Enter command:
SELECT K.KENNZEICHEN, K.AVG_VERBRAUCH,
T2.DAT AS LETZT_DATUM, T1.DAT AS AKT_DATUM,
DATEDIFF(T1.DAT, T2.DAT) AS TAGE,
T2.KM AS LETZT_KM, T1.KM AS AKT_KM
FROM KFZ K, TANKEN T1, TANKEN T2
WHERE
(T1.KENNZEICHEN = K.KENNZEICHEN) AND
(T2.KENNZEICHEN = K.KENNZEICHEN) AND
(T2.DAT < T1.DAT) AND
(T2.DAT = (SELECT MAX(DAT) FROM TANKEN
 EXCEPT (SELECT MAX(DAT) FROM TANKEN)))!
 
***ERROR    100 Row not found                                              0001
 
Enter command:
FETCH !
 
***ERROR    100 Row not found                                              0001
 
Enter command:
COMMIT RELEASE !
 
Enter command:
FILE CONNECT ( KERN TEST SQLMODE ORACLE !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE ORACLE ISOLATION LEVEL 1 !
 
Enter command:
SELECT K.KENNZEICHEN, K.AVG_VERBRAUCH AVG,
       T.DATUM DATUM_VON, TB.DATUM DATUM_BIS,
    T.DATUM - TB.DATUM TAGE,
    TB.KM KM_VON, T.KM KM_BIS,
    T.KM - TB.KM DISTANZ, T.MENGE,
    ROUND (T.MENGE / (T.KM - TB.KM) * 100, 2) VERBRAUCH,
       ROUND ((T.MENGE / (T.KM - TB.KM) * 100 - K.AVG_VERBRAUCH )
    / K.AVG_VERBRAUCH * 100, 2) "%Abw."
FROM KFZ K, TANKEN T,
       (SELECT MIN (TANK1.DATUM - TANK2.DATUM) MIN_TAGE,
    TANK2.KENNZEICHEN, TANK2.DATUM, TANK2.KM
    FROM TANKEN TANK1, TANKEN TANK2
    WHERE TANK1.KENNZEICHEN = TANK2.KENNZEICHEN
      AND TANK1.DATUM > TANK2.DATUM
   GROUP BY TANK2.KENNZEICHEN, TANK2.DATUM, TANK2.KM) TB
WHERE K.KENNZEICHEN = T.KENNZEICHEN
AND   K.KENNZEICHEN = TB.KENNZEICHEN
AND   T.DATUM > TB.DATUM
AND   T.DATUM - TB.DATUM = TB.MIN_TAGE
AND   ABS(ROUND((T.MENGE / (T.KM - TB.KM) * 100
       / K.AVG_VERBRAUCH - 1) * 100, 2)) > 50 !
 
resultcount :                     0
 
Enter command:
FETCH INTO :A, :B, :C, :D, :E, :F, :G, :H, :I, :J, :K !
 
KENNZEICHEN       :  M-OC 5447
AVG               :      12
DATUM_VON         :  30-MAR-97
DATUM_BIS         :  22-FEB-97
TAGE              :   3.6000000000000000000000000000000000000E+01
KM_VON            :       128451
KM_BIS            :        13320
DISTANZ           :       -115131
MENGE             :      63
VERBRAUCH         :  -5.0000000000000000000000000000000000000E-02
%Abw.             :  -1.0046000000000000000000000000000000000E+02
-----------------------------------------------------------------
KENNZEICHEN       :  M-OC 5447
AVG               :      12
DATUM_VON         :  22-FEB-97
DATUM_BIS         :  20-FEB-97
TAGE              :   2.0000000000000000000000000000000000000E+00
KM_VON            :        12345
KM_BIS            :       128451
DISTANZ           :        116106
MENGE             :      62
VERBRAUCH         :   5.0000000000000000000000000000000000000E-02
%Abw.             :  -9.9560000000000000000000000000000000000E+01
-----------------------------------------------------------------
KENNZEICHEN       :  QU-AA 0815
AVG               :      13
DATUM_VON         :  24-FEB-97
DATUM_BIS         :  22-FEB-97
TAGE              :   2.0000000000000000000000000000000000000E+00
KM_VON            :        44556
KM_BIS            :         5000
DISTANZ           :        -39556
MENGE             :      65
VERBRAUCH         :  -1.6000000000000000000000000000000000000E-01
%Abw.             :  -1.0126000000000000000000000000000000000E+02
-----------------------------------------------------------------
KENNZEICHEN       :  QU-AA 0815
AVG               :      13
DATUM_VON         :  27-MAR-97
DATUM_BIS         :  24-FEB-97
TAGE              :   3.1000000000000000000000000000000000000E+01
KM_VON            :         5000
KM_BIS            :        45400
DISTANZ           :         40400
MENGE             :      50
VERBRAUCH         :   1.2000000000000000000000000000000000000E-01
%Abw.             :  -9.9050000000000000000000000000000000000E+01
-----------------------------------------------------------------
KENNZEICHEN       :  QU-AA 0815
AVG               :      13
DATUM_VON         :  22-APR-97
DATUM_BIS         :  27-MAR-97
TAGE              :   2.6000000000000000000000000000000000000E+01
KM_VON            :        45400
KM_BIS            :        45500
DISTANZ           :           100
MENGE             :      60
VERBRAUCH         :   6.0000000000000000000000000000000000000E+01
%Abw.             :   3.6154000000000000000000000000000000000E+02
-----------------------------------------------------------------
KENNZEICHEN       :  XQ-BZ 9090
AVG               :      11
DATUM_VON         :  25-FEB-97
DATUM_BIS         :  22-FEB-97
TAGE              :   3.0000000000000000000000000000000000000E+00
KM_VON            :        45678
KM_BIS            :        45865
DISTANZ           :           187
MENGE             :      60
VERBRAUCH         :   3.2090000000000000000000000000000000000E+01
%Abw.             :   1.9169000000000000000000000000000000000E+02
 
resultcount :                     6
 
Enter command:
DROP TABLE TANKEN !
 
Enter command:
DROP TABLE KFZ !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST SQLMODE ORACLE !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE ORACLE ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE ARTIKEL (
ART_NR      INTEGER CONSTRAINT ARTIKEL_PK PRIMARY KEY,
BEZEICHNUNG VARCHAR (20) NOT NULL)!
 
Enter command:
INSERT INTO ARTIKEL VALUES (1, 'Apfelsaft')!
 
Enter command:
INSERT INTO ARTIKEL VALUES (2, 'Orangensaft')!
 
Enter command:
COMMIT WORK !
 
Enter command:
CREATE TABLE FLASCHEN (
FL_NR        INTEGER CONSTRAINT FLASCHEN_PK PRIMARY KEY,
BEZEICHNUNG  VARCHAR (20) NOT NULL,
INHALT       DECIMAL (5,2) NOT NULL
             CONSTRAINT INHALT_CHECK CHECK (INHALT > 0))!
 
Enter command:
INSERT INTO FLASCHEN VALUES (1, 'Pfandflasche', 1.0)!
 
Enter command:
INSERT INTO FLASCHEN VALUES (2, 'Flschchen'  , 0.2)!
 
Enter command:
INSERT INTO FLASCHEN VALUES (3, 'Halber'      , 0.5)!
 
Enter command:
COMMIT WORK !
 
Enter command:
CREATE TABLE KUNDEN (
KN_NR INTEGER CONSTRAINT KUNDEN_PK PRIMARY KEY,
NAME  VARCHAR (20) NOT NULL)!
 
Enter command:
INSERT INTO KUNDEN VALUES (1, 'Durstig')!
 
Enter command:
INSERT INTO KUNDEN VALUES (2, 'Saufaus')!
 
Enter command:
COMMIT WORK !
 
Enter command:
CREATE TABLE BESTELLUNG (
BESTELL_NR   INTEGER CONSTRAINT BESTELLUNG_PK PRIMARY KEY,
KD_NR        INTEGER
              CONSTRAINT BEST_KD_FK REFERENCES KUNDEN NOT NULL,
LIEFER_DATUM DATE NOT NULL)!
 
Enter command:
INSERT INTO BESTELLUNG VALUES (1, 1, '01-JAN-97')!
 
Enter command:
INSERT INTO BESTELLUNG VALUES (2, 1, '01-MAY-97')!
 
Enter command:
INSERT INTO BESTELLUNG VALUES (3, 1, '11-DEC-97')!
 
Enter command:
INSERT INTO BESTELLUNG VALUES (4, 2, '22-JUN-97')!
 
Enter command:
INSERT INTO BESTELLUNG VALUES (5, 2, '21-AUG-97')!
 
Enter command:
INSERT INTO BESTELLUNG VALUES (6, 1, '20-DEC-97')!
 
Enter command:
INSERT INTO BESTELLUNG VALUES (7, 2, '24-DEC-97')!
 
Enter command:
COMMIT WORK !
 
Enter command:
CREATE TABLE BESTELL_POS (
BESTELL_NR INTEGER,
POS        INTEGER,
ART_NR     INTEGER NOT NULL CONSTRAINT BP_ART_FK REFERENCES ARTIKEL,
FL_NR      INTEGER NOT NULL CONSTRAINT BP_FLA_FK REFERENCES FLASCHEN,
MENGE      INTEGER NOT NULL CONSTRAINT MENGE_CHECK CHECK (MENGE > 0),
CONSTRAINT BESTELL_POS_PK PRIMARY KEY (BESTELL_NR, POS),
CONSTRAINT BES_POS_U1 UNIQUE (BESTELL_NR, ART_NR, FL_NR))!
 
Enter command:
INSERT INTO BESTELL_POS VALUES (1,1,1,1, 100)!
 
Enter command:
INSERT INTO BESTELL_POS VALUES (1,2,2,3,  20)!
 
Enter command:
INSERT INTO BESTELL_POS VALUES (1,3,1,2, 200)!
 
Enter command:
INSERT INTO BESTELL_POS VALUES (2,1,2,2, 200)!
 
Enter command:
INSERT INTO BESTELL_POS VALUES (2,2,1,3,  15)!
 
Enter command:
INSERT INTO BESTELL_POS VALUES (2,3,2,1,  22)!
 
Enter command:
INSERT INTO BESTELL_POS VALUES (3,1,1,1,  11)!
 
Enter command:
INSERT INTO BESTELL_POS VALUES (3,2,2,1,  33)!
 
Enter command:
INSERT INTO BESTELL_POS VALUES (3,3,1,2,  44)!
 
Enter command:
INSERT INTO BESTELL_POS VALUES (3,4,1,3,  25)!
 
Enter command:
INSERT INTO BESTELL_POS VALUES (3,5,2,2,  37)!
 
Enter command:
INSERT INTO BESTELL_POS VALUES (3,6,2,3, 234)!
 
Enter command:
INSERT INTO BESTELL_POS VALUES (4,1,1,1,1111)!
 
Enter command:
INSERT INTO BESTELL_POS VALUES (4,2,2,2, 222)!
 
Enter command:
INSERT INTO BESTELL_POS VALUES (5,1,1,3, 234)!
 
Enter command:
INSERT INTO BESTELL_POS VALUES (6,1,2,3,1000)!
 
Enter command:
INSERT INTO BESTELL_POS VALUES (6,2,2,2, 100)!
 
Enter command:
INSERT INTO BESTELL_POS VALUES (7,1,1,1, 300)!
 
Enter command:
INSERT INTO BESTELL_POS VALUES (7,2,1,2, 300)!
 
Enter command:
INSERT INTO BESTELL_POS VALUES (7,3,1,3, 200)!
 
Enter command:
COMMIT WORK !
 
Enter command:
CREATE TABLE PRODUKTION (
ART_NR      INTEGER,
PROD_DATUM  DATE,
MENGE       DECIMAL (10,2) NOT NULL
             CONSTRAINT PROD_MENGE_CHECK CHECK (MENGE > 0),
CONSTRAINT PRODUKTION_PK PRIMARY KEY (ART_NR, PROD_DATUM))!
 
Enter command:
INSERT INTO PRODUKTION VALUES (1,'01-OCT-97',1000)!
 
Enter command:
INSERT INTO PRODUKTION VALUES (2,'01-OCT-97', 677)!
 
Enter command:
COMMIT WORK !
 
Enter command:
SELECT BP.ART_NR, BP.FL_NR,
       TO_CHAR(ROUND(SUM (BP.MENGE * F.INHALT) /
             SUM.SUMME * 100, 2), '99.99') PROZENT,
       TO_CHAR(ROUND(SUM (BP.MENGE * F.INHALT) /
             SUM.SUMME * P.MENGE), '9999') MENGE,
       TO_CHAR(ROUND(SUM (BP.MENGE * F.INHALT) /
             SUM.SUMME * P.MENGE / F.INHALT), '9999') FLASCHEN
  FROM BESTELL_POS BP,
       FLASCHEN F,
       PRODUKTION P,
       (SELECT BP.ART_NR,
               SUM (BP.MENGE * F.INHALT) SUMME
          FROM BESTELL_POS BP, FLASCHEN F
         WHERE BP.FL_NR = F.FL_NR
         GROUP BY BP.ART_NR)                      SUM
 WHERE BP.ART_NR = SUM.ART_NR
   AND BP.FL_NR  = F.FL_NR
   AND BP.ART_NR = P.ART_NR
   AND P.PROD_DATUM = '01-OCT-97'
 GROUP BY BP.ART_NR, BP.FL_NR, SUM.SUMME,
               F.INHALT, P.MENGE !
 
resultcount :                     0
 
Enter command:
FETCH INTO :A, :B, :C, :D, :E !
 
ART_NR                | FL_NR                 | PROZENT | MENGE | FLASCHEN
----------------------+-----------------------+---------+-------+---------
                    1 |                     1 |  81.49  |   815 |   815
                    1 |                     2 |   5.83  |    58 |   291
                    1 |                     3 |  12.69  |   127 |   254
                    2 |                     1 |   6.93  |    47 |    47
                    2 |                     2 |  14.08  |    95 |   477
                    2 |                     3 |  78.99  |   535 |  1069
 
resultcount :                     6
 
Enter command:
DROP TABLE ARTIKEL !
 
Enter command:
DROP TABLE FLASCHEN !
 
Enter command:
DROP TABLE KUNDEN !
 
Enter command:
DROP TABLE BESTELLUNG !
 
Enter command:
DROP TABLE BESTELL_POS !
 
Enter command:
DROP TABLE PRODUKTION !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST SQLMODE ORACLE !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE ORACLE ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE MESSUNGEN (
MESSUNG INTEGER CONSTRAINT MESSUNG_PK PRIMARY KEY,
WERT    DECIMAL (4,1) NOT NULL)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES ( 4, 11.3)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES ( 6, 11.7)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES ( 2, 12.2)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES ( 9, 12.8)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (11, 12.9)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (13, 13.3)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES ( 5, 13.4)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (18, 13.4)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES ( 8, 13.9)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (15, 13.9)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (20, 13.9)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (17, 14.0)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (10, 14.3)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (22, 14.5)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (25, 15.0)!
 
Enter command:
COMMIT RELEASE !
 
Enter command:
FILE CONNECT ( KERN TEST !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST   ISOLATION LEVEL 1 !
 
Enter command:
SELECT M1.MESSUNG, M1.WERT, FIXED(ROUND (AVG(M2.WERT),2),4,2),
       FIXED(ROUND((AVG(M2.WERT) - M1.WERT) * 100 / AVG(M2.WERT), 2),4,2)
FROM
           (SELECT ROWNO NR1, MESSUNG, WERT
              FROM MESSUNGEN
     GROUP BY MESSUNG, WERT) M1,
           (SELECT ROWNO NR2, MESSUNG, WERT
              FROM MESSUNGEN
     GROUP BY MESSUNG, WERT) M2
WHERE M2.NR2 BETWEEN M1.NR1-3 AND M1.NR1+3
GROUP BY M1.MESSUNG, M1.WERT
HAVING ABS(ROUND((AVG(M2.WERT) - M1.WERT) * 100 / AVG(M2.WERT), 2)) > 5!
 
resultcount :                     7
 
Enter command:
FETCH INTO :A, :B, :C, :D !
 
MESSUNG               | WERT   | EXPRESSION1 | EXPRESSION2
----------------------+--------+-------------+------------
                    4 |   11.3 |  12.50      |   9.60
                    5 |   13.4 |  12.55      |  -6.77
                    6 |   11.7 |  12.80      |   8.59
                    8 |   13.9 |  12.90      |  -7.75
                   10 |   14.3 |  13.26      |  -7.87
                   11 |   12.9 |  13.59      |   5.05
                   25 |   15.0 |  14.20      |  -5.63
 
resultcount :                     7
 
Enter command:
SELECT M1.MESSUNG, M1.WERT,
       FIXED(ROUND(AVG (M2.WERT), 2),4,2) AVGR,
       FIXED(ROUND((AVG(M2.WERT) - M1.WERT) /
                    AVG (M2.WERT) * 100, 2),4,2) ABW
  FROM MESSUNGEN M1, MESSUNGEN M2
 WHERE M1.MESSUNG <= M2.MESSUNG
   AND 4 >= (SELECT COUNT (*)
               FROM MESSUNGEN MI
              WHERE MI.MESSUNG BETWEEN M1.MESSUNG AND M2.MESSUNG
            )
    OR
       M1.MESSUNG >= M2.MESSUNG
   AND 4 >= (SELECT COUNT (*)
               FROM MESSUNGEN MI
              WHERE MI.MESSUNG BETWEEN M2.MESSUNG AND M1.MESSUNG
            )
 GROUP BY M1.MESSUNG, M1.WERT
HAVING ROUND ((AVG(M2.WERT) - M1.WERT) /
               AVG(M2.WERT) * 100, 2)
       NOT BETWEEN -5 AND 5 !
 
resultcount :                     7
 
Enter command:
FETCH INTO :A, :B, :C, :D !
 
MESSUNG               | WERT   | AVGR   | ABW
----------------------+--------+--------+-------
                    4 |   11.3 |  12.50 |   9.60
                    5 |   13.4 |  12.55 |  -6.77
                    6 |   11.7 |  12.80 |   8.59
                    8 |   13.9 |  12.90 |  -7.75
                   10 |   14.3 |  13.26 |  -7.87
                   11 |   12.9 |  13.59 |   5.05
                   25 |   15.0 |  14.20 |  -5.63
 
resultcount :                     7
 
Enter command:
SELECT C.MESSUNG1 AS MESSUNG,
       ROUND(C.WERT1,1) AS WERT,
       FIXED(ROUND(AVG(C.WERT2),2),4,2) AS AVGR,
       FIXED(ROUND(100-(C.WERT1*100 / AVG(C.WERT2)),2),4,2) AS ABW
  FROM (SELECT B.MESSUNG AS MESSUNG1, B.WERT AS WERT1,
               A.MESSUNG AS MESSUNG2, A.WERT AS WERT2
          FROM MESSUNGEN A, MESSUNGEN B
         WHERE A.MESSUNG = B.MESSUNG
        UNION
        SELECT B.MESSUNG AS MESSUNG1, B.WERT AS WERT1,
               A.MESSUNG AS MESSUNG2, A.WERT AS WERT2
          FROM MESSUNGEN A, MESSUNGEN B
         WHERE A.MESSUNG =
               (SELECT MIN(MESSUNG)
                  FROM MESSUNGEN
                 WHERE MESSUNG > B.MESSUNG)
        UNION
        SELECT B.MESSUNG AS MESSUNG1, B.WERT AS WERT1,
               A.MESSUNG AS MESSUNG2, A.WERT AS WERT2
          FROM MESSUNGEN A, MESSUNGEN B
         WHERE A.MESSUNG =
               (SELECT MIN(MESSUNG)
                  FROM MESSUNGEN
                 WHERE MESSUNG >
                       (SELECT MIN(MESSUNG)
                          FROM MESSUNGEN
                         WHERE MESSUNG > B.MESSUNG))
        UNION
        SELECT B.MESSUNG AS MESSUNG1, B.WERT AS WERT1,
               A.MESSUNG AS MESSUNG2, A.WERT AS WERT2
          FROM MESSUNGEN A, MESSUNGEN B
         WHERE A.MESSUNG =
               (SELECT MIN(MESSUNG)
                  FROM MESSUNGEN
                 WHERE MESSUNG >
                       (SELECT MIN(MESSUNG)
                          FROM MESSUNGEN
                         WHERE MESSUNG >
                               (SELECT MIN(MESSUNG)
                                  FROM MESSUNGEN
                                 WHERE MESSUNG > B.MESSUNG)))
        UNION
        SELECT B.MESSUNG AS MESSUNG1, B.WERT AS WERT1,
               A.MESSUNG AS MESSUNG2, A.WERT AS WERT2
          FROM MESSUNGEN A, MESSUNGEN B
         WHERE A.MESSUNG =
               (SELECT MAX(MESSUNG)
                  FROM MESSUNGEN
                 WHERE MESSUNG < B.MESSUNG)
        UNION
        SELECT B.MESSUNG AS MESSUNG1, B.WERT AS WERT1,
               A.MESSUNG AS MESSUNG2, A.WERT AS WERT2
          FROM MESSUNGEN A, MESSUNGEN B
         WHERE A.MESSUNG =
               (SELECT MAX(MESSUNG)
                  FROM MESSUNGEN
                 WHERE MESSUNG <
                       (SELECT MAX(MESSUNG)
                          FROM MESSUNGEN
                         WHERE MESSUNG < B.MESSUNG))
        UNION
        SELECT B.MESSUNG AS MESSUNG1, B.WERT AS WERT1,
               A.MESSUNG AS MESSUNG2, A.WERT AS WERT2
          FROM MESSUNGEN A, MESSUNGEN B
         WHERE A.MESSUNG =
               (SELECT MAX(MESSUNG)
                  FROM MESSUNGEN
                 WHERE MESSUNG <
                       (SELECT MAX(MESSUNG)
                          FROM MESSUNGEN
                         WHERE MESSUNG <
                               (SELECT MAX(MESSUNG)
                                  FROM MESSUNGEN
                                 WHERE MESSUNG < B.MESSUNG)))
         ) C
GROUP BY MESSUNG1,WERT1
HAVING ABS(100-(C.WERT1*100/AVG(C.WERT2))) > 5!
 
resultcount :                     7
 
Enter command:
FETCH INTO :A, :B, :C, :D !
 
MESSUNG               | WERT   | AVGR   | ABW
----------------------+--------+--------+-------
                    4 |   11.3 |  12.50 |   9.60
                    5 |   13.4 |  12.55 |  -6.77
                    6 |   11.7 |  12.80 |   8.59
                    8 |   13.9 |  12.90 |  -7.75
                   10 |   14.3 |  13.26 |  -7.87
                   11 |   12.9 |  13.59 |   5.05
                   25 |   15.0 |  14.20 |  -5.63
 
resultcount :                     7
 
Enter command:
DROP TABLE MESSUNGEN !
 
Enter command:
COMMIT RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST   ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE PERSONEN (
P_ID INTEGER PRIMARY KEY,
NAME CHAR (10) NOT NULL)!
 
Enter command:
INSERT INTO PERSONEN VALUES (1, 'Golf')!
 
Enter command:
INSERT INTO PERSONEN VALUES (2, 'John')!
 
Enter command:
INSERT INTO PERSONEN VALUES (3, 'Peter')!
 
Enter command:
COMMIT !
 
Enter command:
CREATE TABLE ACCOUNTING (
LOGIN_ID INTEGER PRIMARY KEY,
P_ID     INTEGER NOT NULL REFERENCES PERSONEN,
LOGIN    TIMESTAMP NOT NULL,
LOGOUT   TIMESTAMP NOT NULL,
CONSTRAINT DATE_CHECK CHECK (LOGIN < LOGOUT))!
 
Enter command:
INSERT INTO ACCOUNTING VALUES
 ( 1,1,'19971210100000000000','19971210120000000000')!
 
Enter command:
INSERT INTO ACCOUNTING VALUES
 ( 2,1,'19971210110000000000','19971210140000000000')!
 
Enter command:
INSERT INTO ACCOUNTING VALUES
 ( 3,1,'19971210150000000000','19971210190000000000')!
 
Enter command:
INSERT INTO ACCOUNTING VALUES
 ( 4,1,'19971210150000000000','19971210160000000000')!
 
Enter command:
INSERT INTO ACCOUNTING VALUES
 ( 5,1,'19971210170000000000','19971210180000000000')!
 
Enter command:
INSERT INTO ACCOUNTING VALUES
 ( 6,2,'19971210090000000000','19971210130000000000')!
 
Enter command:
INSERT INTO ACCOUNTING VALUES
 ( 7,2,'19971210150000000000','19971210160000000000')!
 
Enter command:
INSERT INTO ACCOUNTING VALUES
 ( 8,2,'19971210150000000000','19971210160000000000')!
 
Enter command:
INSERT INTO ACCOUNTING VALUES
 ( 9,3,'19971210100000000000','19971210140000000000')!
 
Enter command:
INSERT INTO ACCOUNTING VALUES
 (10,3,'19971210130000000000','19971210150000000000')!
 
Enter command:
INSERT INTO ACCOUNTING VALUES
 (11,3,'19971210130000000000','19971210150000000000')!
 
Enter command:
INSERT INTO ACCOUNTING VALUES
 (12,3,'19971210150000000000','19971210170000000000')!
 
Enter command:
COMMIT WORK !
 
Enter command:
CREATE TABLE PREISE (
ANZAHL INTEGER PRIMARY KEY,
BETRAG DECIMAL (10,2) NOT NULL)!
 
Enter command:
INSERT INTO PREISE VALUES (1, 1.00)!
 
Enter command:
INSERT INTO PREISE VALUES (2, 0.70)!
 
Enter command:
INSERT INTO PREISE VALUES (3, 0.55)!
 
Enter command:
INSERT INTO PREISE VALUES (4, 0.45)!
 
Enter command:
INSERT INTO PREISE VALUES (5, 0.40)!
 
Enter command:
COMMIT WORK !
 
Enter command:
SELECT P.NAME, A.LOGIN_ID, MAX(PR.BETRAG)
  FROM PERSONEN P,
       ACCOUNTING A,
       PREISE PR
 WHERE P.P_ID = A.P_ID
   AND PR.ANZAHL >= ALL
                (SELECT COUNT (*)
                   FROM ACCOUNTING A1,
                        ACCOUNTING A2
                  WHERE A1.LOGIN >= A.LOGIN
                    AND A1.LOGIN <  A.LOGOUT
                    AND A1.LOGIN >= A2.LOGIN
                    AND A1.LOGIN <  A2.LOGOUT
                    AND A1.P_ID  =  P.P_ID
                    AND A1.P_ID  =  A2.P_ID
                 GROUP BY A1.LOGIN_ID)
GROUP BY P.NAME, A.LOGIN_ID !
 
resultcount :                    12
 
Enter command:
FETCH INTO :A, :B, :C !
 
NAME       | LOGIN_ID    | EXPRESSION1
-----------+-------------+-------------
Golf       |           1 |         0.70
Golf       |           2 |         0.70
Golf       |           3 |         0.70
Golf       |           4 |         0.70
Golf       |           5 |         0.70
John       |           6 |         1.00
John       |           7 |         0.70
John       |           8 |         0.70
Peter      |           9 |         0.55
Peter      |          10 |         0.55
Peter      |          11 |         0.55
Peter      |          12 |         1.00
 
resultcount :                    12
 
Enter command:
DROP TABLE PERSONEN !
 
Enter command:
DROP TABLE ACCOUNTING !
 
Enter command:
DROP TABLE PREISE !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
FILE CONNECT ( SUT SUT !
 
Enter command:
CONNECT SUT IDENTIFIED BY SUT   ISOLATION LEVEL 1 !
 
Enter command:
DROP USER KERN !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( SUT SUT !
 
Enter command:
CONNECT SUT IDENTIFIED BY SUT   ISOLATION LEVEL 1 !
 
Enter command:
CREATE USER KERN PASSWORD TEST DBA NOT EXCLUSIVE !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST SQLMODE ORACLE !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE ORACLE ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE STEUERKLASSE (
KLASSE       INTEGER CONSTRAINT STEUERKLASSE_PK PRIMARY KEY,
BESCHREIBUNG VARCHAR (30))!
 
Enter command:
INSERT INTO STEUERKLASSE VALUES (1, 'Alleinstehend')!
 
Enter command:
INSERT INTO STEUERKLASSE VALUES (2, 'Alleinerziehend')!
 
Enter command:
INSERT INTO STEUERKLASSE VALUES (3, 'Verheiratet')!
 
Enter command:
COMMIT WORK!
 
Enter command:
CREATE TABLE EINKOMMEN (
NAME   VARCHAR (10) CONSTRAINT EINKOMMEN_PK PRIMARY KEY,
KLASSE INTEGER NOT NULL
         CONSTRAINT EIN_KLASSE_FK REFERENCES STEUERKLASSE,
BETRAG DECIMAL NOT NULL)!
 
Enter command:
INSERT INTO EINKOMMEN VALUES ('Mayer',   1, 32123)!
 
Enter command:
INSERT INTO EINKOMMEN VALUES ('Schmidt', 2, 33333)!
 
Enter command:
INSERT INTO EINKOMMEN VALUES ('Franz',   3, 34567)!
 
Enter command:
INSERT INTO EINKOMMEN VALUES ('Fredl',   2, 39876)!
 
Enter command:
COMMIT WORK !
 
Enter command:
CREATE TABLE STEUER (
KLASSE        INTEGER NOT NULL
              CONSTRAINT STEUER_KLASSE_FK REFERENCES STEUERKLASSE,
OBER_GRENZE   DECIMAL NOT NULL
              CONSTRAINT ST_OBER_CHECK CHECK (OBER_GRENZE > 0),
STEUER_BETRAG DECIMAL NOT NULL
              CONSTRAINT ST_BETRAG_CHECK CHECK (STEUER_BETRAG >= 0))!
 
Enter command:
INSERT INTO STEUER VALUES (1,31000, 7610)!
 
Enter command:
INSERT INTO STEUER VALUES (1,32000, 8240)!
 
Enter command:
INSERT INTO STEUER VALUES (1,33000, 8890)!
 
Enter command:
INSERT INTO STEUER VALUES (1,34000, 9560)!
 
Enter command:
INSERT INTO STEUER VALUES (1,35000,10250)!
 
Enter command:
INSERT INTO STEUER VALUES (1,36000,10960)!
 
Enter command:
INSERT INTO STEUER VALUES (1,37000,11690)!
 
Enter command:
INSERT INTO STEUER VALUES (1,38000,12440)!
 
Enter command:
INSERT INTO STEUER VALUES (1,39000,13210)!
 
Enter command:
INSERT INTO STEUER VALUES (1,40000,14000)!
 
Enter command:
INSERT INTO STEUER VALUES (2,31000, 6370)!
 
Enter command:
INSERT INTO STEUER VALUES (2,32000, 6960)!
 
Enter command:
INSERT INTO STEUER VALUES (2,33000, 7570)!
 
Enter command:
INSERT INTO STEUER VALUES (2,34000, 8200)!
 
Enter command:
INSERT INTO STEUER VALUES (2,35000, 8850)!
 
Enter command:
INSERT INTO STEUER VALUES (2,36000, 9520)!
 
Enter command:
INSERT INTO STEUER VALUES (2,37000,10210)!
 
Enter command:
INSERT INTO STEUER VALUES (2,38000,10920)!
 
Enter command:
INSERT INTO STEUER VALUES (2,39000,11650)!
 
Enter command:
INSERT INTO STEUER VALUES (2,40000,12400)!
 
Enter command:
INSERT INTO STEUER VALUES (3,31000, 5715)!
 
Enter command:
INSERT INTO STEUER VALUES (3,32000, 6210)!
 
Enter command:
INSERT INTO STEUER VALUES (3,33000, 6735)!
 
Enter command:
INSERT INTO STEUER VALUES (3,34000, 7290)!
 
Enter command:
INSERT INTO STEUER VALUES (3,35000, 7875)!
 
Enter command:
INSERT INTO STEUER VALUES (3,36000, 8490)!
 
Enter command:
INSERT INTO STEUER VALUES (3,37000, 9135)!
 
Enter command:
INSERT INTO STEUER VALUES (3,38000, 9810)!
 
Enter command:
INSERT INTO STEUER VALUES (3,39000,10515)!
 
Enter command:
INSERT INTO STEUER VALUES (3,40000,11250)!
 
Enter command:
COMMIT WORK !
 
Enter command:
SELECT E.NAME, TO_CHAR(E.KLASSE, '9'), TO_CHAR(E.BETRAG,'99999'),
       TO_CHAR(ST1.STEUER_BETRAG, '99999') STEUER_MIN,
       TO_CHAR(ST2.STEUER_BETRAG, '99999') STEUER_MAX,
       TO_CHAR(ROUND(
       ST1.STEUER_BETRAG +
       ((E.BETRAG - ST1.OBER_GRENZE) *
        (ST2.STEUER_BETRAG - ST1.STEUER_BETRAG)) /
       ( ST2.OBER_GRENZE - ST1.OBER_GRENZE), 2), '99999.99') STEUER
  FROM EINKOMMEN E,
       STEUER ST1,
       STEUER ST2
 WHERE E.KLASSE = ST1.KLASSE
   AND E.KLASSE = ST2.KLASSE
   AND ST1.OBER_GRENZE = (SELECT MAX(OBER_GRENZE)
                            FROM STEUER SX
                           WHERE E.BETRAG > SX.OBER_GRENZE
                             AND E.KLASSE = SX.KLASSE
                         )
   AND ST2.OBER_GRENZE = (SELECT MIN(OBER_GRENZE)
                            FROM STEUER SY
                           WHERE E.BETRAG < SY.OBER_GRENZE
                             AND E.KLASSE = SY.KLASSE
                         ) !
 
resultcount :                     0
 
Enter command:
FETCH INTO :A, :B, :C, :D, :E, :F !
 
NAME       | EXPRESSION1 | EXPRESSION2 | STEUER_MIN | STEUER_MAX | STEUER
-----------+-------------+-------------+------------+------------+----------
Mayer      |  1          |  32123      |   8240     |   8890     |   8319.95
Schmidt    |  2          |  33333      |   7570     |   8200     |   7779.79
Franz      |  3          |  34567      |   7290     |   7875     |   7621.70
Fredl      |  2          |  39876      |  11650     |  12400     |  12307.00
 
resultcount :                     4
 
Enter command:
SELECT E.NAME, TO_CHAR(E.KLASSE, '9'), TO_CHAR(E.BETRAG,'99999'),
       TO_CHAR (MAX (S2.STEUER_BETRAG), '99999') STEUER_MIN,
       TO_CHAR (MIN (S1.STEUER_BETRAG), '99999') STEUER_MAX,
       TO_CHAR (ROUND (
       MAX (S2.STEUER_BETRAG) +
       (MIN (S1.STEUER_BETRAG) - MAX (S2.STEUER_BETRAG)) /
       (MIN (S1.OBER_GRENZE) - MAX (S2.OBER_GRENZE)) *
       (E.BETRAG - MAX (S2.OBER_GRENZE)), 2), '99999.99') STEUER
  FROM EINKOMMEN E, STEUER S1, STEUER S2
 WHERE E.KLASSE = S1.KLASSE
   AND E.BETRAG <= S1.OBER_GRENZE
   AND E.KLASSE = S2.KLASSE
   AND E.BETRAG >= S2.OBER_GRENZE
GROUP BY E.NAME, E.KLASSE, E.BETRAG !
 
resultcount :                     0
 
Enter command:
FETCH INTO :A, :B, :C, :D, :E, :F !
 
NAME       | EXPRESSION1 | EXPRESSION2 | STEUER_MIN | STEUER_MAX | STEUER
-----------+-------------+-------------+------------+------------+----------
Franz      |  3          |  34567      |   7290     |   7875     |   7621.70
Fredl      |  2          |  39876      |  11650     |  12400     |  12307.00
Mayer      |  1          |  32123      |   8240     |   8890     |   8319.95
Schmidt    |  2          |  33333      |   7570     |   8200     |   7779.79
 
resultcount :                     4
 
Enter command:
DROP TABLE STEUERKLASSE!
 
Enter command:
DROP TABLE EINKOMMEN !
 
Enter command:
DROP TABLE STEUER !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST SQLMODE ORACLE !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE ORACLE ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE PERSONEN (
P_ID    INTEGER CONSTRAINT PERSONEN_PK PRIMARY KEY,
NAME    CHAR (10) NOT NULL,
GEB_DAT DATE NOT NULL)!
 
Enter command:
INSERT INTO PERSONEN VALUES ( 6, 'Albrecht ', '11-APR_67')!
 
Enter command:
INSERT INTO PERSONEN VALUES ( 8, 'Baader   ', '20-JUN_55')!
 
Enter command:
INSERT INTO PERSONEN VALUES (12, 'Hessen   ', '11-JAN_71')!
 
Enter command:
INSERT INTO PERSONEN VALUES ( 1, 'Jansen   ', '01-JAN_65')!
 
Enter command:
INSERT INTO PERSONEN VALUES ( 2, 'Johannsen', '02-FEB_66')!
 
Enter command:
INSERT INTO PERSONEN VALUES ( 3, 'Lenze    ', '05-AUG_60')!
 
Enter command:
INSERT INTO PERSONEN VALUES ( 7, 'Linke    ', '30-JUL_49')!
 
Enter command:
INSERT INTO PERSONEN VALUES ( 9, 'Orterer  ', '18-JAN_70')!
 
Enter command:
INSERT INTO PERSONEN VALUES (11, 'Pape     ', '20-JUN_55')!
 
Enter command:
INSERT INTO PERSONEN VALUES ( 4, 'Raupp    ', '09-SEP_58')!
 
Enter command:
INSERT INTO PERSONEN VALUES (10, 'Smith    ', '19-FEB_66')!
 
Enter command:
INSERT INTO PERSONEN VALUES ( 5, 'Weiss    ', '22-MAR_51')!
 
Enter command:
PARS_THEN_EX !
 
Enter command:
DATA !
 
Enter command:
SELECT TO_CHAR(P1.P_ID, '99') P_ID,
       P1.NAME,
       P1.GEB_DAT,
       COUNT(*) NUMMER,
       TO_CHAR (TRUNC (:ANZAHL_GRUPPEN * (COUNT(*) - 1) /
                 P_ANZ.ANZAHL) + 1, '99') GRUPPE
  FROM PERSONEN P1, PERSONEN P2,
       (SELECT COUNT(*) ANZAHL FROM PERSONEN) P_ANZ
 WHERE P2.GEB_DAT < P1.GEB_DAT
    OR (P2.GEB_DAT = P1.GEB_DAT AND
        P2.P_ID <= P1.P_ID)
GROUP BY P1.GEB_DAT, P1.P_ID, P1.NAME, P_ANZ.ANZAHL !
 
n 38 4
 
resultcount :                     0
 
Enter command:
FETCH INTO :A, :B, :C, :D, :E !
 
P_ID | NAME       | GEB_DAT                    | NUMMER      | GRUPPE
-----+------------+----------------------------+-------------+-------
  7  | Linke      | 30-JUL-49                  |           1 |   1
  5  | Weiss      | 22-MAR-51                  |           2 |   1
  8  | Baader     | 20-JUN-55                  |           3 |   1
 11  | Pape       | 20-JUN-55                  |           4 |   2
  4  | Raupp      | 09-SEP-58                  |           5 |   2
  3  | Lenze      | 05-AUG-60                  |           6 |   2
  1  | Jansen     | 01-JAN-65                  |           7 |   3
  2  | Johannsen  | 02-FEB-66                  |           8 |   3
 10  | Smith      | 19-FEB-66                  |           9 |   3
  6  | Albrecht   | 11-APR-67                  |          10 |   4
  9  | Orterer    | 18-JAN-70                  |          11 |   4
 12  | Hessen     | 11-JAN-71                  |          12 |   4
 
resultcount :                    12
 
Enter command:
SELECT TO_CHAR(P1.P_ID, '99') P_ID,
       P1.NAME,
       P1.GEB_DAT,
       COUNT(DISTINCT P2.P_ID) NUMMER,
       TO_CHAR (TRUNC ((COUNT (DISTINCT P2.P_ID) - 1) /
                (COUNT (DISTINCT P3.P_ID) /
                :ANZAHL_GRUPPEN)) + 1, '99') GRUPPE
  FROM PERSONEN P1, PERSONEN P2, PERSONEN P3
 WHERE P2.GEB_DAT < P1.GEB_DAT
    OR (P2.GEB_DAT = P1.GEB_DAT AND
        P2.P_ID <= P1.P_ID)
GROUP BY P1.P_ID, P1.NAME, P1.GEB_DAT
ORDER BY P1.GEB_DAT !
 
n 38 5
 
resultcount :                     0
 
Enter command:
FETCH INTO :A, :B, :C, :D, :E !
 
P_ID | NAME       | GEB_DAT                    | NUMMER      | GRUPPE
-----+------------+----------------------------+-------------+-------
  7  | Linke      | 30-JUL-49                  |           1 |   1
  5  | Weiss      | 22-MAR-51                  |           2 |   1
  8  | Baader     | 20-JUN-55                  |           3 |   1
 11  | Pape       | 20-JUN-55                  |           4 |   2
  4  | Raupp      | 09-SEP-58                  |           5 |   2
  3  | Lenze      | 05-AUG-60                  |           6 |   3
  1  | Jansen     | 01-JAN-65                  |           7 |   3
  2  | Johannsen  | 02-FEB-66                  |           8 |   3
 10  | Smith      | 19-FEB-66                  |           9 |   4
  6  | Albrecht   | 11-APR-67                  |          10 |   4
  9  | Orterer    | 18-JAN-70                  |          11 |   5
 12  | Hessen     | 11-JAN-71                  |          12 |   5
 
resultcount :                    12
 
Enter command:
PARS_EXECUTE!
 
Enter command:
NODATA!
 
Enter command:
DROP TABLE PERSONEN !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST SQLMODE ORACLE !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE ORACLE ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE ERGEBNISSE (
NAME   VARCHAR (10) NOT NULL,
ORT    VARCHAR (10) NOT NULL,
ANTEIL DECIMAL (3,1))!
 
Enter command:
INSERT INTO ERGEBNISSE VALUES ('Sagad    ', 'Verschwand', 34)!
 
Enter command:
INSERT INTO ERGEBNISSE VALUES ('Obergram ', 'Unterach  ', 92)!
 
Enter command:
INSERT INTO ERGEBNISSE VALUES ('Lakitz   ', 'Klamau    ', 67)!
 
Enter command:
INSERT INTO ERGEBNISSE VALUES ('Fitzken  ', 'Borkenbach', 55)!
 
Enter command:
INSERT INTO ERGEBNISSE VALUES ('Aberhoff ', 'Klegil    ', 84)!
 
Enter command:
INSERT INTO ERGEBNISSE VALUES ('Klabutz  ', 'Borstberg ', 23)!
 
Enter command:
SELECT N.NAME, O.ORT
FROM
  (SELECT E1.NAME, COUNT(*) NTEIL
    FROM ERGEBNISSE E1, ERGEBNISSE E2
   WHERE E1.ANTEIL >= E2.ANTEIL
   GROUP BY E1.NAME) N,
  (SELECT E1.ORT, COUNT(*) OTEIL
    FROM ERGEBNISSE E1, ERGEBNISSE E2
   WHERE E1.ANTEIL <= E2.ANTEIL
   GROUP BY E1.ORT) O
WHERE N.NTEIL = O.OTEIL
ORDER BY N.NTEIL DESC!
 
resultcount :                     0
 
Enter command:
FETCH INTO :A, :B!
 
NAME       | ORT
-----------+-----------
Obergram   | Borstberg
Aberhoff   | Verschwand
Lakitz     | Borkenbach
Fitzken    | Klamau
Sagad      | Klegil
Klabutz    | Unterach
 
resultcount :                     6
 
Enter command:
SELECT E1.NAME, E2.ORT
  FROM ERGEBNISSE E1, ERGEBNISSE E2
 WHERE NOT EXISTS
     (SELECT COUNT(*)
        FROM ERGEBNISSE E3
       WHERE E3.ANTEIL < E1.ANTEIL
      MINUS
      SELECT COUNT(*)
        FROM ERGEBNISSE E4
       WHERE E4.ANTEIL > E2.ANTEIL) !
 
***ERROR  -7011 Correlated subquery not allowed                            0129
 
Enter command:
FETCH INTO :A, :B!
 
***ERROR  -4000 Unknown result table                                       0001
 
Enter command:
DROP TABLE ERGEBNISSE !
 
Enter command:
COMMIT WORK RELEASE!
 
Enter command:
 
FILE CONNECT ( KERN TEST !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST   ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE LOGIN_VERSUCH (
MASCHINE VARCHAR (10),
LOGIN_NO INTEGER,
ZEIT     TIMESTAMP NOT NULL,
TERMINAL VARCHAR (10) NOT NULL,
USERNAME VARCHAR (10) NOT NULL,
CONSTRAINT LV_PK PRIMARY KEY (MASCHINE, LOGIN_NO))!
 
Enter command:
INSERT INTO LOGIN_VERSUCH VALUES
  ('UX1',  2, '19970220131111000000', 'MODEM1', 'HINZ')!
 
Enter command:
INSERT INTO LOGIN_VERSUCH VALUES
  ('UX1',  3, '19970220131123000000', 'MODEM2', 'HINZ')!
 
Enter command:
INSERT INTO LOGIN_VERSUCH VALUES
  ('UX1',  4, '19970220131137000000', 'MODEM3', 'HINZ')!
 
Enter command:
INSERT INTO LOGIN_VERSUCH VALUES
  ('UX1',  5, '19970220142200000000', 'PC1', 'KUNZ')!
 
Enter command:
INSERT INTO LOGIN_VERSUCH VALUES
  ('UX1',  6, '19970220142311000000', 'PC1', 'KUNZ')!
 
Enter command:
INSERT INTO LOGIN_VERSUCH VALUES
  ('UX1',  7, '19970220142510000000', 'PC1', 'KUNZ')!
 
Enter command:
INSERT INTO LOGIN_VERSUCH VALUES
  ('UX1',  9, '19970220150001000000', 'MODEM1', 'ROOT')!
 
Enter command:
INSERT INTO LOGIN_VERSUCH VALUES
  ('UX1', 10, '19970220150005000000', 'MODEM1', 'ADMIN')!
 
Enter command:
INSERT INTO LOGIN_VERSUCH VALUES
  ('UX1', 11, '19970220150011000000', 'MODEM1', 'SYS')!
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
FILE CONNECT ( KERN TEST SQLMODE ORACLE !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE ORACLE ISOLATION LEVEL 1 !
 
Enter command:
 
SELECT L1.LOGIN_NO L1, L1.ZEIT Z1,
       L2.LOGIN_NO L2, L2.ZEIT Z2
  FROM LOGIN_VERSUCH L1, LOGIN_VERSUCH L2
 WHERE (L1.LOGIN_NO, L1.ZEIT, L2.LOGIN_NO, L2.ZEIT) = ANY
  (SELECT LV1.LOGIN_NO L1, LV1.ZEIT Z1,
       LV2.LOGIN_NO L2, LV2.ZEIT Z2
  FROM LOGIN_VERSUCH LV1, LOGIN_VERSUCH LV2
 WHERE LV1.ZEIT BETWEEN LV2.ZEIT AND LV2.ZEIT + 2)
!
 
resultcount :                     0
 
Enter command:
FETCH INTO :A, :B, :C, :D !
 
L1                :            2
Z1                :  20-FEB-97
L2                :            2
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            3
Z1                :  20-FEB-97
L2                :            2
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            4
Z1                :  20-FEB-97
L2                :            2
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            5
Z1                :  20-FEB-97
L2                :            2
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            6
Z1                :  20-FEB-97
L2                :            2
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            7
Z1                :  20-FEB-97
L2                :            2
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            9
Z1                :  20-FEB-97
L2                :            2
Z2                :  20-FEB-97
-----------------------------------------------
L1                :           10
Z1                :  20-FEB-97
L2                :            2
Z2                :  20-FEB-97
-----------------------------------------------
L1                :           11
Z1                :  20-FEB-97
L2                :            2
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            3
Z1                :  20-FEB-97
L2                :            3
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            4
Z1                :  20-FEB-97
L2                :            3
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            5
Z1                :  20-FEB-97
L2                :            3
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            6
Z1                :  20-FEB-97
L2                :            3
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            7
Z1                :  20-FEB-97
L2                :            3
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            9
Z1                :  20-FEB-97
L2                :            3
Z2                :  20-FEB-97
-----------------------------------------------
L1                :           10
Z1                :  20-FEB-97
L2                :            3
Z2                :  20-FEB-97
-----------------------------------------------
L1                :           11
Z1                :  20-FEB-97
L2                :            3
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            4
Z1                :  20-FEB-97
L2                :            4
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            5
Z1                :  20-FEB-97
L2                :            4
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            6
Z1                :  20-FEB-97
L2                :            4
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            7
Z1                :  20-FEB-97
L2                :            4
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            9
Z1                :  20-FEB-97
L2                :            4
Z2                :  20-FEB-97
-----------------------------------------------
L1                :           10
Z1                :  20-FEB-97
L2                :            4
Z2                :  20-FEB-97
-----------------------------------------------
L1                :           11
Z1                :  20-FEB-97
L2                :            4
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            5
Z1                :  20-FEB-97
L2                :            5
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            6
Z1                :  20-FEB-97
L2                :            5
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            7
Z1                :  20-FEB-97
L2                :            5
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            9
Z1                :  20-FEB-97
L2                :            5
Z2                :  20-FEB-97
-----------------------------------------------
L1                :           10
Z1                :  20-FEB-97
L2                :            5
Z2                :  20-FEB-97
-----------------------------------------------
L1                :           11
Z1                :  20-FEB-97
L2                :            5
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            6
Z1                :  20-FEB-97
L2                :            6
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            7
Z1                :  20-FEB-97
L2                :            6
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            9
Z1                :  20-FEB-97
L2                :            6
Z2                :  20-FEB-97
-----------------------------------------------
L1                :           10
Z1                :  20-FEB-97
L2                :            6
Z2                :  20-FEB-97
-----------------------------------------------
L1                :           11
Z1                :  20-FEB-97
L2                :            6
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            7
Z1                :  20-FEB-97
L2                :            7
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            9
Z1                :  20-FEB-97
L2                :            7
Z2                :  20-FEB-97
-----------------------------------------------
L1                :           10
Z1                :  20-FEB-97
L2                :            7
Z2                :  20-FEB-97
-----------------------------------------------
L1                :           11
Z1                :  20-FEB-97
L2                :            7
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            9
Z1                :  20-FEB-97
L2                :            9
Z2                :  20-FEB-97
-----------------------------------------------
L1                :           10
Z1                :  20-FEB-97
L2                :            9
Z2                :  20-FEB-97
-----------------------------------------------
L1                :           11
Z1                :  20-FEB-97
L2                :            9
Z2                :  20-FEB-97
-----------------------------------------------
L1                :           10
Z1                :  20-FEB-97
L2                :           10
Z2                :  20-FEB-97
-----------------------------------------------
L1                :           11
Z1                :  20-FEB-97
L2                :           10
Z2                :  20-FEB-97
-----------------------------------------------
L1                :           11
Z1                :  20-FEB-97
L2                :           11
Z2                :  20-FEB-97
 
resultcount :                    45
 
Enter command:
SELECT LV3.MASCHINE, LV3.ZEIT, LV3.TERMINAL, LV3.USERNAME
  FROM LOGIN_VERSUCH LV1, LOGIN_VERSUCH LV3
 WHERE LV1.MASCHINE = LV3.MASCHINE
   AND LV1.USERNAME = LV3.USERNAME
   AND LV3.ZEIT BETWEEN
       LV1.ZEIT AND LV1.ZEIT + 1 / 24 / 60
   AND 3 <= (SELECT COUNT (*)
               FROM LOGIN_VERSUCH LV2
              WHERE LV1.MASCHINE = LV2.MASCHINE
                AND LV1.USERNAME = LV2.USERNAME
                AND LV2.ZEIT BETWEEN
                    LV1.ZEIT AND LV1.ZEIT + 1 / 24 / 60)
UNION
SELECT LV3.MASCHINE, TO_CHAR(LV3.ZEIT,'DD MM YYYY HH24 MI SS'),
       LV3.TERMINAL, LV3.USERNAME
  FROM LOGIN_VERSUCH LV1, LOGIN_VERSUCH LV3
 WHERE LV1.MASCHINE = LV3.MASCHINE
   AND LV1.TERMINAL = LV3.TERMINAL
   AND LV3.ZEIT BETWEEN
       LV1.ZEIT AND LV1.ZEIT + 1 / 24 / 60
   AND 3 <= (SELECT COUNT (*)
               FROM LOGIN_VERSUCH LV2
              WHERE LV1.MASCHINE = LV2.MASCHINE
                AND LV1.TERMINAL = LV2.TERMINAL
                AND LV2.ZEIT BETWEEN
                    LV1.ZEIT AND LV1.ZEIT + 1 / 24 / 60)
ORDER BY 2 !
 
resultcount :                     0
 
Enter command:
FETCH INTO :A, :B, :C, :D !
 
MASCHINE   | ZEIT                       | TERMINAL   | USERNAME
-----------+----------------------------+------------+-----------
UX1        | 20 02 1997 15 00 01        | MODEM1     | ROOT
UX1        | 20 02 1997 15 00 05        | MODEM1     | ADMIN
UX1        | 20 02 1997 15 00 11        | MODEM1     | SYS
UX1        | 20-FEB-97                  | MODEM1     | HINZ
UX1        | 20-FEB-97                  | MODEM2     | HINZ
UX1        | 20-FEB-97                  | MODEM3     | HINZ
 
resultcount :                     6
 
Enter command:
SELECT LV3.MASCHINE, TO_CHAR(LV3.ZEIT,'DD MM YYYY HH24 MI SS'),
       LV3.TERMINAL, LV3.USERNAME
  FROM LOGIN_VERSUCH LV1, LOGIN_VERSUCH LV3
 WHERE LV1.MASCHINE = LV3.MASCHINE
   AND LV1.USERNAME = LV3.USERNAME
   AND LV3.ZEIT BETWEEN
       LV1.ZEIT AND LV1.ZEIT + 1 / 24 / 60
   AND 3 <= (SELECT COUNT (*)
               FROM LOGIN_VERSUCH LV2
              WHERE LV1.MASCHINE = LV2.MASCHINE
                AND LV1.USERNAME = LV2.USERNAME
                AND LV2.ZEIT BETWEEN
                    LV1.ZEIT AND LV1.ZEIT + 1 / 24 / 60)
UNION
SELECT LV3.MASCHINE, TO_CHAR(LV3.ZEIT,'DD MM YYYY HH24 MI SS'),
       LV3.TERMINAL, LV3.USERNAME
  FROM LOGIN_VERSUCH LV1, LOGIN_VERSUCH LV3
 WHERE LV1.MASCHINE = LV3.MASCHINE
   AND LV1.TERMINAL = LV3.TERMINAL
   AND LV3.ZEIT BETWEEN
       LV1.ZEIT AND LV1.ZEIT + 1 / 24 / 60
   AND 3 <= (SELECT COUNT (*)
               FROM LOGIN_VERSUCH LV2
              WHERE LV1.MASCHINE = LV2.MASCHINE
                AND LV1.TERMINAL = LV2.TERMINAL
                AND LV2.ZEIT BETWEEN
                    LV1.ZEIT AND LV1.ZEIT + 1 / 24 / 60)
ORDER BY 2 !
 
resultcount :                     0
 
Enter command:
FETCH INTO :A, :B, :C, :D !
 
MASCHINE   | EXPRESSION1         | TERMINAL   | USERNAME
-----------+---------------------+------------+-----------
UX1        | 20 02 1997 13 11 11 | MODEM1     | HINZ
UX1        | 20 02 1997 13 11 23 | MODEM2     | HINZ
UX1        | 20 02 1997 13 11 37 | MODEM3     | HINZ
UX1        | 20 02 1997 15 00 01 | MODEM1     | ROOT
UX1        | 20 02 1997 15 00 05 | MODEM1     | ADMIN
UX1        | 20 02 1997 15 00 11 | MODEM1     | SYS
 
resultcount :                     6
 
Enter command:
SELECT LV3.MASCHINE, TO_CHAR(LV3.ZEIT,'DD MM YYYY HH24 MI SS'),
       LV3.TERMINAL, LV3.USERNAME
  FROM LOGIN_VERSUCH LV1, LOGIN_VERSUCH LV3
 WHERE LV1.MASCHINE = LV3.MASCHINE
   AND (LV1.TERMINAL = LV3.TERMINAL OR LV1.USERNAME = LV3.USERNAME)
   AND LV3.ZEIT BETWEEN
       LV1.ZEIT AND LV1.ZEIT + 1 / 24 / 60
   AND 3 <= (SELECT COUNT (*)
               FROM LOGIN_VERSUCH LV2
              WHERE LV1.MASCHINE = LV2.MASCHINE
                AND (LV1.TERMINAL = LV3.TERMINAL OR
                     LV1.USERNAME = LV3.USERNAME)
                AND LV2.ZEIT BETWEEN
                    LV1.ZEIT AND LV1.ZEIT + 1 / 24 / 60)
ORDER BY 2 !
 
resultcount :                     0
 
Enter command:
FETCH INTO :A, :B, :C, :D !
 
MASCHINE   | EXPRESSION1         | TERMINAL   | USERNAME
-----------+---------------------+------------+-----------
UX1        | 20 02 1997 13 11 11 | MODEM1     | HINZ
UX1        | 20 02 1997 13 11 23 | MODEM2     | HINZ
UX1        | 20 02 1997 13 11 37 | MODEM3     | HINZ
UX1        | 20 02 1997 15 00 01 | MODEM1     | ROOT
UX1        | 20 02 1997 15 00 05 | MODEM1     | ADMIN
UX1        | 20 02 1997 15 00 11 | MODEM1     | SYS
 
resultcount :                     6
 
Enter command:
SELECT A.MASCHINE, TO_CHAR(A.ZEIT,'DD MM YYYY HH24 MI SS'),
       A.TERMINAL, A.USERNAME
  FROM LOGIN_VERSUCH A, LOGIN_VERSUCH B
 WHERE B.MASCHINE = A.MASCHINE
   AND (B.TERMINAL = A.TERMINAL OR
        B.USERNAME = A.USERNAME)
   AND B.ZEIT BETWEEN A.ZEIT - 1 / 24 / 60
                  AND A.ZEIT + 1 / 24 / 60
   AND A.LOGIN_NO != B.LOGIN_NO
GROUP BY A.MASCHINE, A.ZEIT, A.TERMINAL, A.USERNAME
HAVING COUNT (*) > 1
ORDER BY 2 !
 
resultcount :                     0
 
Enter command:
FETCH INTO :A, :B, :C, :D !
 
MASCHINE   | EXPRESSION1         | TERMINAL   | USERNAME
-----------+---------------------+------------+-----------
UX1        | 20 02 1997 13 11 11 | MODEM1     | HINZ
UX1        | 20 02 1997 13 11 23 | MODEM2     | HINZ
UX1        | 20 02 1997 13 11 37 | MODEM3     | HINZ
UX1        | 20 02 1997 15 00 01 | MODEM1     | ROOT
UX1        | 20 02 1997 15 00 05 | MODEM1     | ADMIN
UX1        | 20 02 1997 15 00 11 | MODEM1     | SYS
 
resultcount :                     6
 
Enter command:
DROP TABLE LOGIN_VERSUCH !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST   ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE MITARBEITER (
MA_NO FIXED(4) PRIMARY KEY,
NAME  VARCHAR (10) NOT NULL)!
 
Enter command:
INSERT INTO MITARBEITER VALUES (1, 'Schmidt')!
 
Enter command:
INSERT INTO MITARBEITER VALUES (2, 'Paulus')!
 
Enter command:
CREATE TABLE STEMPELKARTEN (
MA_NO      FIXED (4) REFERENCES MITARBEITER,
PROJEKT    VARCHAR (10) NOT NULL,
STARTDATUM DATE NOT NULL,
ENDDATUM   DATE NOT NULL,
PRIMARY KEY (MA_NO, PROJEKT, STARTDATUM))!
 
Enter command:
SET FORMAT EUR !
 
Enter command:
INSERT INTO STEMPELKARTEN VALUES(1,'P1','01.01.1998','03.01.1998')!
 
Enter command:
INSERT INTO STEMPELKARTEN VALUES(1,'P2','02.01.1998','04.01.1998')!
 
Enter command:
INSERT INTO STEMPELKARTEN VALUES(2,'P1','02.01.1998','03.01.1998')!
 
Enter command:
INSERT INTO STEMPELKARTEN VALUES(2,'P2','02.01.1998','04.01.1998')!
 
Enter command:
INSERT INTO STEMPELKARTEN VALUES(2,'P3','03.01.1998','05.01.1998')!
 
Enter command:
INSERT INTO STEMPELKARTEN VALUES(1,'P3','04.01.1998','05.01.1998')!
 
Enter command:
INSERT INTO STEMPELKARTEN VALUES(1,'P4','06.01.1998','09.01.1998')!
 
Enter command:
INSERT INTO STEMPELKARTEN VALUES(2,'P4','06.01.1998','09.01.1998')!
 
Enter command:
INSERT INTO STEMPELKARTEN VALUES(1,'P5','09.01.1998','09.01.1998')!
 
Enter command:
INSERT INTO STEMPELKARTEN VALUES(1,'P6','09.01.1998','09.01.1998')!
 
Enter command:
INSERT INTO STEMPELKARTEN VALUES(2,'P6','09.01.1998','10.01.1998')!
 
Enter command:
INSERT INTO STEMPELKARTEN VALUES(2,'P5','09.01.1998','09.01.1998')!
 
Enter command:
INSERT INTO STEMPELKARTEN VALUES(1,'P7','12.01.1998','15.01.1998')!
 
Enter command:
INSERT INTO STEMPELKARTEN VALUES(2,'P7','12.01.1998','15.01.1998')!
 
Enter command:
INSERT INTO STEMPELKARTEN VALUES(1,'P8','13.01.1998','14.01.1998')!
 
Enter command:
INSERT INTO STEMPELKARTEN VALUES(2,'P8','13.01.1998','14.01.1998')!
 
Enter command:
INSERT INTO STEMPELKARTEN VALUES(1,'P9','14.01.1998','14.01.1998')!
 
Enter command:
INSERT INTO STEMPELKARTEN VALUES(2,'P9','14.01.1998','14.01.1998')!
 
Enter command:
INSERT INTO STEMPELKARTEN VALUES(1,'P10','17.01.1998','17.01.1998')!
 
Enter command:
INSERT INTO STEMPELKARTEN VALUES(2,'P10','17.01.1998','18.01.1998')!
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
FILE CONNECT ( KERN TEST SQLMODE ORACLE !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE ORACLE ISOLATION LEVEL 1 !
 
Enter command:
SELECT M.NAME, T1.STARTDATUM, MIN(T2.ENDDATUM) ENDDATUM
  FROM STEMPELKARTEN T1, STEMPELKARTEN T2, MITARBEITER M
 WHERE T1.ENDDATUM <= T2.ENDDATUM
   AND T1.MA_NO = T2.MA_NO
   AND NOT EXISTS
          (SELECT *
             FROM STEMPELKARTEN T3
            WHERE T1.MA_NO = T3.MA_NO
              AND T1.STARTDATUM > T3.STARTDATUM
              AND T1.STARTDATUM <= T3.ENDDATUM)
   AND NOT EXISTS
          (SELECT *
             FROM STEMPELKARTEN T3
            WHERE T1.MA_NO = T3.MA_NO
              AND T2.ENDDATUM >= T3.STARTDATUM
              AND T2.ENDDATUM < T3.ENDDATUM)
   AND T1.MA_NO = M.MA_NO
 GROUP BY M.NAME, T1.STARTDATUM !
 
resultcount :                     0
 
Enter command:
FETCH INTO :A, :B, :C !
 
NAME       | STARTDATUM | ENDDATUM
-----------+------------+-----------
Paulus     | 19980102   | 19980105
Paulus     | 19980106   | 19980110
Paulus     | 19980112   | 19980115
Paulus     | 19980117   | 19980118
Schmidt    | 19980101   | 19980105
Schmidt    | 19980106   | 19980109
Schmidt    | 19980112   | 19980115
Schmidt    | 19980117   | 19980117
 
resultcount :                     8
 
Enter command:
SELECT M.NAME, T1.STARTDATUM, MIN(T2.ENDDATUM) ENDDATUM
  FROM STEMPELKARTEN T1, STEMPELKARTEN T2, MITARBEITER M
 WHERE T1.ENDDATUM <= T2.ENDDATUM
   AND T1.MA_NO = T2.MA_NO
   AND NOT EXISTS
          (SELECT *
             FROM STEMPELKARTEN T3
            WHERE T1.MA_NO = T3.MA_NO
              AND ((T1.STARTDATUM > T3.STARTDATUM
              AND   T1.STARTDATUM <= T3.ENDDATUM)
               OR  (T2.ENDDATUM >= T3.STARTDATUM
              AND   T2.ENDDATUM < T3.ENDDATUM)))
   AND T1.MA_NO = M.MA_NO
 GROUP BY M.NAME, T1.STARTDATUM !
 
resultcount :                     0
 
Enter command:
FETCH INTO :A, :B, :C !
 
NAME       | STARTDATUM | ENDDATUM
-----------+------------+-----------
Paulus     | 19980102   | 19980105
Paulus     | 19980106   | 19980110
Paulus     | 19980112   | 19980115
Paulus     | 19980117   | 19980118
Schmidt    | 19980101   | 19980105
Schmidt    | 19980106   | 19980109
Schmidt    | 19980112   | 19980115
Schmidt    | 19980117   | 19980117
 
resultcount :                     8
 
Enter command:
DROP TABLE MITARBEITER !
 
Enter command:
DROP TABLE STEMPELKARTEN !
 
Enter command:
COMMIT WORK RELEASE!
 
Enter command:
 
FILE CONNECT ( KERN TEST SQLMODE ORACLE !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE ORACLE ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE AUFTRAG_KOPF (
AUFTRAG_ID INTEGER CONSTRAINT AUFTRAG_KOPF_PK PRIMARY KEY,
BESTELLER  VARCHAR(15) NOT NULL) !
 
Enter command:
INSERT INTO AUFTRAG_KOPF VALUES (1, 'Hansen')!
 
Enter command:
INSERT INTO AUFTRAG_KOPF VALUES (2, 'Paulsen')!
 
Enter command:
INSERT INTO AUFTRAG_KOPF VALUES (3, 'Petersen')!
 
Enter command:
INSERT INTO AUFTRAG_KOPF VALUES (4, 'Klausen')!
 
Enter command:
INSERT INTO AUFTRAG_KOPF VALUES (5, 'Feddersen')!
 
Enter command:
INSERT INTO AUFTRAG_KOPF VALUES (6, 'Feddersen')!
 
Enter command:
INSERT INTO AUFTRAG_KOPF VALUES (7, 'Feddersen')!
 
Enter command:
COMMIT!
 
Enter command:
CREATE TABLE ARTIKEL (
ARTIKEL_ID  INTEGER CONSTRAINT ARTIKEL_PK PRIMARY KEY,
BEZEICHNUNG VARCHAR(15) NOT NULL)!
 
Enter command:
INSERT INTO ARTIKEL VALUES (1, 'Hammer')!
 
Enter command:
INSERT INTO ARTIKEL VALUES (2, 'Zange')!
 
Enter command:
INSERT INTO ARTIKEL VALUES (3, 'Feder')!
 
Enter command:
INSERT INTO ARTIKEL VALUES (4, 'Zollstock')!
 
Enter command:
INSERT INTO ARTIKEL VALUES (5, 'Schluessel')!
 
Enter command:
COMMIT!
 
Enter command:
CREATE TABLE AUFTRAG_POSITION (
AUFTRAG_ID INTEGER CONSTRAINT AP_AUF_FK REFERENCES AUFTRAG_KOPF,
POS_ID     INTEGER,
ARTIKEL_ID INTEGER CONSTRAINT AP_ART_FK REFERENCES ARTIKEL,
MENGE      INTEGER NOT NULL,
CONSTRAINT AUFTRAG_POSITION_PK PRIMARY KEY (AUFTRAG_ID, POS_ID),
CONSTRAINT AUFTRAG_POSITION_UK UNIQUE (AUFTRAG_ID, ARTIKEL_ID))!
 
Enter command:
INSERT INTO AUFTRAG_POSITION VALUES (1,1,1,1)!
 
Enter command:
INSERT INTO AUFTRAG_POSITION VALUES (1,2,2,2)!
 
Enter command:
INSERT INTO AUFTRAG_POSITION VALUES (1,3,3,3)!
 
Enter command:
INSERT INTO AUFTRAG_POSITION VALUES (1,4,4,4)!
 
Enter command:
INSERT INTO AUFTRAG_POSITION VALUES (1,5,5,5)!
 
Enter command:
INSERT INTO AUFTRAG_POSITION VALUES (2,1,2,1)!
 
Enter command:
INSERT INTO AUFTRAG_POSITION VALUES (2,2,1,2)!
 
Enter command:
INSERT INTO AUFTRAG_POSITION VALUES (3,1,1,2)!
 
Enter command:
INSERT INTO AUFTRAG_POSITION VALUES (3,2,2,1)!
 
Enter command:
INSERT INTO AUFTRAG_POSITION VALUES (4,1,3,3)!
 
Enter command:
INSERT INTO AUFTRAG_POSITION VALUES (4,2,4,4)!
 
Enter command:
INSERT INTO AUFTRAG_POSITION VALUES (4,3,5,5)!
 
Enter command:
INSERT INTO AUFTRAG_POSITION VALUES (5,1,3,3)!
 
Enter command:
INSERT INTO AUFTRAG_POSITION VALUES (5,2,4,4)!
 
Enter command:
INSERT INTO AUFTRAG_POSITION VALUES (5,3,5,5)!
 
Enter command:
INSERT INTO AUFTRAG_POSITION VALUES (6,1,3,3)!
 
Enter command:
INSERT INTO AUFTRAG_POSITION VALUES (6,2,4,3)!
 
Enter command:
INSERT INTO AUFTRAG_POSITION VALUES (6,3,5,5)!
 
Enter command:
INSERT INTO AUFTRAG_POSITION VALUES (7,1,1,1)!
 
Enter command:
COMMIT!
 
Enter command:
SELECT K2.AUFTRAG_ID, COUNT(*)
  FROM AUFTRAG_KOPF K1, AUFTRAG_KOPF K2
 WHERE (K1.AUFTRAG_ID, K2.AUFTRAG_ID) IN
       (SELECT P6.AUFTRAG_ID, MIN(P5.AUFTRAG_ID)
          FROM AUFTRAG_KOPF P5, AUFTRAG_KOPF P6
         WHERE P5.AUFTRAG_ID <= P6.AUFTRAG_ID
           AND NOT EXISTS
              (SELECT *
                 FROM AUFTRAG_POSITION P1,
                      AUFTRAG_POSITION P2
                WHERE P6.AUFTRAG_ID = P2.AUFTRAG_ID
                  AND P5.AUFTRAG_ID = P1.AUFTRAG_ID
                  AND P1.AUFTRAG_ID <= P2.AUFTRAG_ID
                  AND ((P1.ARTIKEL_ID = P2.ARTIKEL_ID
                        AND
                        P1.MENGE <> P2.MENGE)
                     OR NOT EXISTS
                       (SELECT ARTIKEL_ID
                          FROM AUFTRAG_POSITION P3
                         WHERE P3.AUFTRAG_ID = P2.AUFTRAG_ID
                           AND P3.ARTIKEL_ID = P1.ARTIKEL_ID)
                     OR NOT EXISTS
                       (SELECT *
                          FROM AUFTRAG_POSITION P4
                         WHERE P4.AUFTRAG_ID = P1.AUFTRAG_ID
                           AND P4.ARTIKEL_ID = P2.ARTIKEL_ID)
                       )
              )
           GROUP BY P6.AUFTRAG_ID)
GROUP BY K2.AUFTRAG_ID !
 
resultcount :                     0
 
Enter command:
FETCH INTO :A, :B !
 
AUFTRAG_ID            | EXPRESSION1
----------------------+------------
                    1 |           1
                    2 |           2
                    4 |           2
                    6 |           1
                    7 |           1
 
resultcount :                     5
 
Enter command:
DROP TABLE AUFTRAG_KOPF !
 
Enter command:
DROP TABLE ARTIKEL !
 
Enter command:
DROP TABLE AUFTRAG_POSITION !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
FILE CONNECT ( SUT SUT !
 
Enter command:
CONNECT SUT IDENTIFIED BY SUT   ISOLATION LEVEL 1 !
 
Enter command:
DROP USER KERN !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( SUT SUT !
 
Enter command:
CONNECT SUT IDENTIFIED BY SUT   ISOLATION LEVEL 1 !
 
Enter command:
CREATE USER KERN PASSWORD TEST DBA NOT EXCLUSIVE !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
FILE CONNECT ( KERN TEST !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST   ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE TA (A1 INT, A2 INT, A3 INT) !
 
Enter command:
INSERT TA VALUES (1, 1, 1) !
 
Enter command:
INSERT TA VALUES (2, 1, 1) !
 
Enter command:
CREATE TABLE TB (B1 INT, B2 INT, B3 INT) !
 
Enter command:
INSERT TB VALUES (1, 2, 2) !
 
Enter command:
INSERT TB VALUES (2, 2, 2) !
 
Enter command:
CREATE TABLE TC (C1 INT, C2 INT, C3 INT) !
 
Enter command:
INSERT TC VALUES (1, 3, 3) !
 
Enter command:
INSERT TC VALUES (2, 3, 3) !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
FILE CONNECT ( KERN TEST SQLMODE INTERNAL !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE INTERNAL ISOLATION LEVEL 1 !
 
Enter command:
 SELECT *
 FROM TC, (SELECT *
       FROM TB, TA)!
 
resultcount :                     8
 
Enter command:
FETCH INTO :A,:B,:C,:D,:E,:F,:G,:H,:I!
 
C1                :            1
C2                :            3
C3                :            3
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
--------------------------------
C1                :            2
C2                :            3
C3                :            3
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
--------------------------------
C1                :            1
C2                :            3
C3                :            3
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
--------------------------------
C1                :            2
C2                :            3
C3                :            3
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
--------------------------------
C1                :            1
C2                :            3
C3                :            3
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
--------------------------------
C1                :            2
C2                :            3
C3                :            3
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
--------------------------------
C1                :            1
C2                :            3
C3                :            3
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
--------------------------------
C1                :            2
C2                :            3
C3                :            3
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
 
resultcount :                     8
 
Enter command:
 SELECT *
 FROM (SELECT *
       FROM TB, TA), TC!
 
resultcount :                     8
 
Enter command:
FETCH INTO :A,:B,:C,:D,:E,:F,:G,:H,:I!
 
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
 
resultcount :                     8
 
Enter command:
 SELECT *
 FROM (SELECT *
       FROM TB), TA, TC!
 
resultcount :                     8
 
Enter command:
FETCH INTO :A,:B,:C,:D,:E,:F,:G,:H,:I!
 
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
 
resultcount :                     8
 
Enter command:
 SELECT *
 FROM TA, (SELECT *
       FROM TB), TC!
 
resultcount :                     8
 
Enter command:
FETCH INTO :A,:B,:C,:D,:E,:F,:G,:H,:I!
 
A1                :            1
A2                :            1
A3                :            1
B1                :            1
B2                :            2
B3                :            2
C1                :            1
C2                :            3
C3                :            3
--------------------------------
A1                :            2
A2                :            1
A3                :            1
B1                :            1
B2                :            2
B3                :            2
C1                :            1
C2                :            3
C3                :            3
--------------------------------
A1                :            1
A2                :            1
A3                :            1
B1                :            2
B2                :            2
B3                :            2
C1                :            1
C2                :            3
C3                :            3
--------------------------------
A1                :            2
A2                :            1
A3                :            1
B1                :            2
B2                :            2
B3                :            2
C1                :            1
C2                :            3
C3                :            3
--------------------------------
A1                :            1
A2                :            1
A3                :            1
B1                :            1
B2                :            2
B3                :            2
C1                :            2
C2                :            3
C3                :            3
--------------------------------
A1                :            2
A2                :            1
A3                :            1
B1                :            1
B2                :            2
B3                :            2
C1                :            2
C2                :            3
C3                :            3
--------------------------------
A1                :            1
A2                :            1
A3                :            1
B1                :            2
B2                :            2
B3                :            2
C1                :            2
C2                :            3
C3                :            3
--------------------------------
A1                :            2
A2                :            1
A3                :            1
B1                :            2
B2                :            2
B3                :            2
C1                :            2
C2                :            3
C3                :            3
 
resultcount :                     8
 
Enter command:
 SELECT *
 FROM (SELECT *
       FROM TA, TC), (SELECT * FROM TB) !
 
resultcount :                     8
 
Enter command:
FETCH INTO :A,:B,:C,:D,:E,:F,:G,:H,:I!
 
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
B1                :            1
B2                :            2
B3                :            2
--------------------------------
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
B1                :            1
B2                :            2
B3                :            2
--------------------------------
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
B1                :            1
B2                :            2
B3                :            2
--------------------------------
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
B1                :            1
B2                :            2
B3                :            2
--------------------------------
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
B1                :            2
B2                :            2
B3                :            2
--------------------------------
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
B1                :            2
B2                :            2
B3                :            2
--------------------------------
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
B1                :            2
B2                :            2
B3                :            2
--------------------------------
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
B1                :            2
B2                :            2
B3                :            2
 
resultcount :                     8
 
Enter command:
 SELECT *
 FROM (SELECT *
       FROM TB), (SELECT * FROM TA, TC)!
 
resultcount :                     8
 
Enter command:
FETCH INTO :A,:B,:C,:D,:E,:F,:G,:H,:I!
 
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
 
resultcount :                     8
 
Enter command:
 SELECT *
 FROM (SELECT *
       FROM TB), (SELECT * FROM TA), TC!
 
resultcount :                     8
 
Enter command:
FETCH INTO :A,:B,:C,:D,:E,:F,:G,:H,:I!
 
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
 
resultcount :                     8
 
Enter command:
 SELECT *
 FROM (SELECT *
       FROM TB), (SELECT * FROM TA), (SELECT * FROM TC)!
 
resultcount :                     8
 
Enter command:
FETCH INTO :A,:B,:C,:D,:E,:F,:G,:H,:I!
 
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
 
resultcount :                     8
 
Enter command:
ROLLBACK !
 
Enter command:
 SELECT *
 FROM (SELECT *
       FROM (SELECT * FROM TB, TA), (SELECT * FROM TC))!
 
resultcount :                     8
 
Enter command:
FETCH INTO :A,:B,:C,:D,:E,:F,:G,:H,:I!
 
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
 
resultcount :                     8
 
Enter command:
 SELECT *
 FROM (SELECT *
       FROM (SELECT *
             FROM TB, (SELECT * FROM TA)), (SELECT * FROM TC))!
 
resultcount :                     8
 
Enter command:
FETCH INTO :A,:B,:C,:D,:E,:F,:G,:H,:I!
 
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
 
resultcount :                     8
 
Enter command:
 SELECT *
 FROM (SELECT *
       FROM (SELECT * FROM TB, (SELECT * FROM TA, (SELECT * FROM TC))))!
 
resultcount :                     8
 
Enter command:
FETCH INTO :A,:B,:C,:D,:E,:F,:G,:H,:I!
 
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
 
resultcount :                     8
 
Enter command:
ROLLBACK !
 
Enter command:
 SELECT *
 FROM (SELECT *
 FROM (SELECT *
 FROM (SELECT *
 FROM (SELECT *
 FROM (SELECT *
       FROM (SELECT * FROM TB, (SELECT * FROM TA,
       (SELECT * FROM TC))))))))!
 
resultcount :                     8
 
Enter command:
FETCH INTO :A,:B,:C,:D,:E,:F,:G,:H,:I!
 
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
 
resultcount :                     8
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
FILE CONNECT ( KERN TEST SQLMODE ORACLE !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE ORACLE ISOLATION LEVEL 1 !
 
Enter command:
 SELECT *
 FROM TC, (SELECT *
       FROM TB, TA)!
 
resultcount :                     0
 
Enter command:
FETCH INTO :A,:B,:C,:D,:E,:F,:G,:H,:I!
 
C1                :            1
C2                :            3
C3                :            3
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
--------------------------------
C1                :            2
C2                :            3
C3                :            3
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
--------------------------------
C1                :            1
C2                :            3
C3                :            3
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
--------------------------------
C1                :            2
C2                :            3
C3                :            3
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
--------------------------------
C1                :            1
C2                :            3
C3                :            3
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
--------------------------------
C1                :            2
C2                :            3
C3                :            3
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
--------------------------------
C1                :            1
C2                :            3
C3                :            3
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
--------------------------------
C1                :            2
C2                :            3
C3                :            3
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
 
resultcount :                     8
 
Enter command:
 SELECT *
 FROM (SELECT *
       FROM TB, TA), TC!
 
resultcount :                     0
 
Enter command:
FETCH INTO :A,:B,:C,:D,:E,:F,:G,:H,:I!
 
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
 
resultcount :                     8
 
Enter command:
 SELECT *
 FROM (SELECT *
       FROM TB), TA, TC!
 
resultcount :                     0
 
Enter command:
FETCH INTO :A,:B,:C,:D,:E,:F,:G,:H,:I!
 
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
 
resultcount :                     8
 
Enter command:
 SELECT *
 FROM TA, (SELECT *
       FROM TB), TC!
 
resultcount :                     0
 
Enter command:
FETCH INTO :A,:B,:C,:D,:E,:F,:G,:H,:I!
 
A1                :            1
A2                :            1
A3                :            1
B1                :            1
B2                :            2
B3                :            2
C1                :            1
C2                :            3
C3                :            3
--------------------------------
A1                :            2
A2                :            1
A3                :            1
B1                :            1
B2                :            2
B3                :            2
C1                :            1
C2                :            3
C3                :            3
--------------------------------
A1                :            1
A2                :            1
A3                :            1
B1                :            2
B2                :            2
B3                :            2
C1                :            1
C2                :            3
C3                :            3
--------------------------------
A1                :            2
A2                :            1
A3                :            1
B1                :            2
B2                :            2
B3                :            2
C1                :            1
C2                :            3
C3                :            3
--------------------------------
A1                :            1
A2                :            1
A3                :            1
B1                :            1
B2                :            2
B3                :            2
C1                :            2
C2                :            3
C3                :            3
--------------------------------
A1                :            2
A2                :            1
A3                :            1
B1                :            1
B2                :            2
B3                :            2
C1                :            2
C2                :            3
C3                :            3
--------------------------------
A1                :            1
A2                :            1
A3                :            1
B1                :            2
B2                :            2
B3                :            2
C1                :            2
C2                :            3
C3                :            3
--------------------------------
A1                :            2
A2                :            1
A3                :            1
B1                :            2
B2                :            2
B3                :            2
C1                :            2
C2                :            3
C3                :            3
 
resultcount :                     8
 
Enter command:
 SELECT *
 FROM (SELECT *
       FROM TA, TC), (SELECT * FROM TB) !
 
resultcount :                     0
 
Enter command:
FETCH INTO :A,:B,:C,:D,:E,:F,:G,:H,:I!
 
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
B1                :            1
B2                :            2
B3                :            2
--------------------------------
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
B1                :            1
B2                :            2
B3                :            2
--------------------------------
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
B1                :            1
B2                :            2
B3                :            2
--------------------------------
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
B1                :            1
B2                :            2
B3                :            2
--------------------------------
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
B1                :            2
B2                :            2
B3                :            2
--------------------------------
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
B1                :            2
B2                :            2
B3                :            2
--------------------------------
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
B1                :            2
B2                :            2
B3                :            2
--------------------------------
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
B1                :            2
B2                :            2
B3                :            2
 
resultcount :                     8
 
Enter command:
 SELECT *
 FROM (SELECT *
       FROM TB), (SELECT * FROM TA, TC)!
 
resultcount :                     0
 
Enter command:
FETCH INTO :A,:B,:C,:D,:E,:F,:G,:H,:I!
 
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
 
resultcount :                     8
 
Enter command:
 SELECT *
 FROM (SELECT *
       FROM TB), (SELECT * FROM TA), TC!
 
resultcount :                     0
 
Enter command:
FETCH INTO :A,:B,:C,:D,:E,:F,:G,:H,:I!
 
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
 
resultcount :                     8
 
Enter command:
 SELECT *
 FROM (SELECT *
       FROM TB), (SELECT * FROM TA), (SELECT * FROM TC)!
 
resultcount :                     0
 
Enter command:
FETCH INTO :A,:B,:C,:D,:E,:F,:G,:H,:I!
 
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
 
resultcount :                     8
 
Enter command:
ROLLBACK !
 
Enter command:
 SELECT *
 FROM (SELECT *
       FROM (SELECT * FROM TB, TA), (SELECT * FROM TC))!
 
resultcount :                     0
 
Enter command:
FETCH INTO :A,:B,:C,:D,:E,:F,:G,:H,:I!
 
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
 
resultcount :                     8
 
Enter command:
 SELECT *
 FROM (SELECT *
       FROM (SELECT *
             FROM TB, (SELECT * FROM TA)), (SELECT * FROM TC))!
 
resultcount :                     0
 
Enter command:
FETCH INTO :A,:B,:C,:D,:E,:F,:G,:H,:I!
 
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
 
resultcount :                     8
 
Enter command:
 SELECT *
 FROM (SELECT *
       FROM (SELECT * FROM TB, (SELECT * FROM TA, (SELECT * FROM TC))))!
 
resultcount :                     0
 
Enter command:
FETCH INTO :A,:B,:C,:D,:E,:F,:G,:H,:I!
 
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
 
resultcount :                     8
 
Enter command:
ROLLBACK !
 
Enter command:
 SELECT *
 FROM (SELECT *
 FROM (SELECT *
 FROM (SELECT *
 FROM (SELECT *
 FROM (SELECT *
       FROM (SELECT * FROM TB, (SELECT * FROM TA,
       (SELECT * FROM TC))))))))!
 
resultcount :                     0
 
Enter command:
FETCH INTO :A,:B,:C,:D,:E,:F,:G,:H,:I!
 
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
 
resultcount :                     8
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST   ISOLATION LEVEL 1 !
 
Enter command:
CREATE INDEX I3 ON TC (C3)!
 
Enter command:
CREATE INDEX I1 ON TC (C1)!
 
Enter command:
CREATE VIEW VCOMPLEX AS
 SELECT DISTINCT TA.A2
   FROM TA,TB
  WHERE TA.A1 = TB.B1 !
 
Enter command:
PARSING !
 
Enter command:
 SELECT *
 FROM TC, (SELECT *
       FROM TB, VCOMPLEX) FROMSEL, TA
WHERE TC.C3 = :P
  AND FROMSEL.B1 = TC.C1
  AND TC.C1 = TA.A1 !
parsing idnr :       1
 
Enter command:
EXECUTING !
 
Enter command:
DATA !
 
Enter command:
 SELECT * !
Parsing idnr :      1
Result name  :    JDBC_CURSOR_18
 
n 10 3
 
resultcount :                     2
 
Enter command:
NODATA !
 
Enter command:
PARS_EXECUTE !
 
Enter command:
DESCRIBE "JDBC_CURSOR_18" !
 
Enter command:
PARS_THEN_EX !
 
Enter command:
FETCH "JDBC_CURSOR_18" !
 
C1                :            1
C2                :            3
C3                :            3
B1                :            1
B2                :            2
B3                :            2
A2                :            1
A1                :            1
A2                :            1
A3                :            1
--------------------------------
C1                :            2
C2                :            3
C3                :            3
B1                :            2
B2                :            2
B3                :            2
A2                :            1
A1                :            2
A2                :            1
A3                :            1
 
resultcount :                     2
 
Enter command:
PARS_EXECUTE !
 
Enter command:
DROP TABLE TA !
 
Enter command:
DROP TABLE TB !
 
Enter command:
DROP TABLE TC !
 
Enter command:
COMMIT RELEASE !
 
Enter command:
FILE CONNECT ( SUT SUT !
 
Enter command:
CONNECT SUT IDENTIFIED BY SUT   ISOLATION LEVEL 1 !
 
Enter command:
DROP USER KERN !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( SUT SUT !
 
Enter command:
CONNECT SUT IDENTIFIED BY SUT   ISOLATION LEVEL 1 !
 
Enter command:
CREATE USER KERN PASSWORD TEST DBA NOT EXCLUSIVE !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
FILE CONNECT ( KERN TEST !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST   ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE ABF
    (
     ABFALL CHAR(6) NOT NULL
    )
!
 
Enter command:
INSERT ABF VALUES ('S    ') !
 
Enter command:
INSERT ABF VALUES ('AC   ') !
 
Enter command:
INSERT ABF VALUES ('HM   ') !
 
Enter command:
INSERT ABF VALUES ('KW   ') !
 
Enter command:
INSERT ABF VALUES ('APC  ') !
 
Enter command:
INSERT ABF VALUES ('KEH  ') !
 
Enter command:
INSERT ABF VALUES ('IND  ') !
 
Enter command:
INSERT ABF VALUES ('MAR  ') !
 
Enter command:
INSERT ABF VALUES ('PAP  ') !
 
Enter command:
INSERT ABF VALUES ('LAU  ') !
 
Enter command:
INSERT ABF VALUES ('GUL  ') !
 
Enter command:
INSERT ABF VALUES ('INS  ') !
 
Enter command:
INSERT ABF VALUES ('SPM  ') !
 
Enter command:
INSERT ABF VALUES ('RBMAE') !
 
Enter command:
INSERT ABF VALUES ('WIEGE') !
 
Enter command:
INSERT ABF VALUES ('BSAIN') !
 
Enter command:
INSERT ABF VALUES ('RZGBE') !
 
Enter command:
INSERT ABF VALUES ('RYMAA') !
 
Enter command:
INSERT ABF VALUES ('RYPAA') !
 
Enter command:
INSERT ABF VALUES ('RYHOA') !
 
Enter command:
INSERT ABF VALUES ('RZCRE') !
 
Enter command:
INSERT ABF VALUES ('RZGWE') !
 
Enter command:
INSERT ABF VALUES ('RZGBZ') !
 
Enter command:
INSERT ABF VALUES ('HOSUS') !
 
Enter command:
INSERT ABF VALUES ('RYSSA') !
 
Enter command:
CREATE TABLE BIL_A ( ABFALL CHAR(6), AUSGANG INTEGER) !
 
Enter command:
INSERT BIL_A VALUES ('AC   ', 5126) !
 
Enter command:
INSERT BIL_A VALUES ('APC  ', 3946) !
 
Enter command:
INSERT BIL_A VALUES ('GUL  ', 3150) !
 
Enter command:
INSERT BIL_A VALUES ('IND  ', 80782) !
 
Enter command:
INSERT BIL_A VALUES ('INS  ', 5176) !
 
Enter command:
INSERT BIL_A VALUES ('KEH  ', 5522) !
 
Enter command:
INSERT BIL_A VALUES ('KW   ', 88) !
 
Enter command:
INSERT BIL_A VALUES ('RYMAA', 440) !
 
Enter command:
INSERT BIL_A VALUES ('S    ', 244759) !
 
Enter command:
CREATE TABLE BIL_E ( ABFALL CHAR(6), EINGANG INTEGER) !
 
Enter command:
INSERT BIL_E VALUES ('BSAIN', 366) !
 
Enter command:
INSERT BIL_E VALUES ('HM   ', 137502) !
 
Enter command:
INSERT BIL_E VALUES ('HOSUS', 292) !
 
Enter command:
INSERT BIL_E VALUES ('KEH  ', 6404) !
 
Enter command:
INSERT BIL_E VALUES ('LAU  ', 1962) !
 
Enter command:
INSERT BIL_E VALUES ('MAR  ', 551) !
 
Enter command:
INSERT BIL_E VALUES ('PAP  ', 34) !
 
Enter command:
INSERT BIL_E VALUES ('RBMAE', 198) !
 
Enter command:
INSERT BIL_E VALUES ('RYHOA', 696) !
 
Enter command:
INSERT BIL_E VALUES ('RYPAA', 156) !
 
Enter command:
INSERT BIL_E VALUES ('RYSSA', 1434) !
 
Enter command:
INSERT BIL_E VALUES ('RZCRE', 2346) !
 
Enter command:
INSERT BIL_E VALUES ('RZGBE', 64) !
 
Enter command:
INSERT BIL_E VALUES ('RZGBZ', 3812) !
 
Enter command:
INSERT BIL_E VALUES ('RZGWE', 54) !
 
Enter command:
INSERT BIL_E VALUES ('SPM  ', 17539) !
 
Enter command:
INSERT BIL_E VALUES ('WIEGE', 3337) !
 
Enter command:
COMMIT WORK !
 
Enter command:
SELECT TMP_TAB.ABFALL, EINGANG, AUSGANG
FROM (SELECT ABF.ABFALL, EINGANG FROM BIL_E, ABF
WHERE ABF.ABFALL = BIL_E.ABFALL (+)) TMP_TAB, BIL_A
WHERE    TMP_TAB.ABFALL =BIL_A.ABFALL(+)
ORDER BY TMP_TAB.ABFALL
!
 
resultcount :                    25
 
Enter command:
FETCH !
 
ABFALL | EINGANG     | AUSGANG
-------+-------------+------------
AC     | ??????????? |        5126
APC    | ??????????? |        3946
BSAIN  |         366 | ???????????
GUL    | ??????????? |        3150
HM     |      137502 | ???????????
HOSUS  |         292 | ???????????
IND    | ??????????? |       80782
INS    | ??????????? |        5176
KEH    |        6404 |        5522
KW     | ??????????? |          88
LAU    |        1962 | ???????????
MAR    |         551 | ???????????
PAP    |          34 | ???????????
RBMAE  |         198 | ???????????
RYHOA  |         696 | ???????????
RYMAA  | ??????????? |         440
RYPAA  |         156 | ???????????
 
ABFALL | EINGANG     | AUSGANG
-------+-------------+------------
RYSSA  |        1434 | ???????????
RZCRE  |        2346 | ???????????
RZGBE  |          64 | ???????????
RZGBZ  |        3812 | ???????????
RZGWE  |          54 | ???????????
S      | ??????????? |      244759
SPM    |       17539 | ???????????
WIEGE  |        3337 | ???????????
 
resultcount :                    25
 
Enter command:
SELECT TMP_TAB.ABFALL, EINGANG, AUSGANG
FROM (SELECT ABF.ABFALL, EINGANG FROM BIL_E, ABF
WHERE ABF.ABFALL =BIL_E.ABFALL (+)) TMP_TAB, BIL_A
WHERE    TMP_TAB.ABFALL =BIL_A.ABFALL(+)
ORDER BY TMP_TAB.ABFALL
!
 
resultcount :                    25
 
Enter command:
FETCH !
 
ABFALL | EINGANG     | AUSGANG
-------+-------------+------------
AC     | ??????????? |        5126
APC    | ??????????? |        3946
BSAIN  |         366 | ???????????
GUL    | ??????????? |        3150
HM     |      137502 | ???????????
HOSUS  |         292 | ???????????
IND    | ??????????? |       80782
INS    | ??????????? |        5176
KEH    |        6404 |        5522
KW     | ??????????? |          88
LAU    |        1962 | ???????????
MAR    |         551 | ???????????
PAP    |          34 | ???????????
RBMAE  |         198 | ???????????
RYHOA  |         696 | ???????????
RYMAA  | ??????????? |         440
RYPAA  |         156 | ???????????
 
ABFALL | EINGANG     | AUSGANG
-------+-------------+------------
RYSSA  |        1434 | ???????????
RZCRE  |        2346 | ???????????
RZGBE  |          64 | ???????????
RZGBZ  |        3812 | ???????????
RZGWE  |          54 | ???????????
S      | ??????????? |      244759
SPM    |       17539 | ???????????
WIEGE  |        3337 | ???????????
 
resultcount :                    25
 
Enter command:
COMMIT WORK !
 
Enter command:
DROP TABLE ABF !
 
Enter command:
DROP TABLE BIL_A !
 
Enter command:
DROP TABLE BIL_E !
 
Enter command:
CREATE TABLE TA (A1 FIXED (4) KEY, A2 INT) !
 
Enter command:
INSERT TA VALUES (1, 1) !
 
Enter command:
INSERT TA VALUES (2, 10) !
 
Enter command:
INSERT TA VALUES (3, 10) !
 
Enter command:
INSERT TA VALUES (4, 1) !
 
Enter command:
INSERT TA VALUES (6, 1) !
 
Enter command:
INSERT TA VALUES (8, 1) !
 
Enter command:
CREATE TABLE TB (B1 FIXED (6) KEY, B2 INT) !
 
Enter command:
INSERT TB VALUES (2, 20) !
 
Enter command:
INSERT TB VALUES (3, 20) !
 
Enter command:
INSERT TB VALUES (5, 2) !
 
Enter command:
INSERT TB VALUES (7, 2) !
 
Enter command:
CREATE TABLE TC (C1 FIXED (6) KEY, C2 INT) !
 
Enter command:
INSERT TC VALUES (3, 20) !
 
Enter command:
INSERT TC VALUES (4, 2) !
 
Enter command:
INSERT TC VALUES (6, 2) !
 
Enter command:
COMMIT WORK !
 
Enter command:
SELECT R1.*, R2.* FROM
    (SELECT TA.*, TB.* FROM TA, TB WHERE A1 (+)= B1) R1, TC R2
    WHERE R1.A1 (+)= R2.C1 !
 
resultcount :                     3
 
Enter command:
FETCH !
 
A1    | A2          | B1      | B2          | C1      | C2
------+-------------+---------+-------------+---------+------------
    3 |          10 |       3 |          20 |       3 |          20
????? | ??????????? | ??????? | ??????????? |       4 |           2
????? | ??????????? | ??????? | ??????????? |       6 |           2
 
resultcount :                     3
 
Enter command:
SELECT R1.*, R2.* FROM TC R2,
    (SELECT TA.*, TB.* FROM TA, TB WHERE A1 (+)= B1) R1
    WHERE R1.A1 (+)= R2.C1 !
 
resultcount :                     3
 
Enter command:
FETCH !
 
A1    | A2          | B1      | B2          | C1      | C2
------+-------------+---------+-------------+---------+------------
    3 |          10 |       3 |          20 |       3 |          20
????? | ??????????? | ??????? | ??????????? |       4 |           2
????? | ??????????? | ??????? | ??????????? |       6 |           2
 
resultcount :                     3
 
Enter command:
SELECT R1.*, R2.* FROM TA R1,
    (SELECT TB.*, TC.* FROM TB, TC WHERE B1 (+)= C1) R2
    WHERE R1.A1 (+)= R2.C1 !
 
resultcount :                     3
 
Enter command:
FETCH !
 
A1    | A2          | B1      | B2          | C1      | C2
------+-------------+---------+-------------+---------+------------
    3 |          10 |       3 |          20 |       3 |          20
    4 |           1 | ??????? | ??????????? |       4 |           2
    6 |           1 | ??????? | ??????????? |       6 |           2
 
resultcount :                     3
 
Enter command:
SELECT R1.*, R2.* FROM
    (SELECT TB.*, TC.* FROM TB, TC WHERE B1 (+)= C1) R2, TA R1
    WHERE R1.A1 (+)= R2.C1 !
 
resultcount :                     3
 
Enter command:
FETCH !
 
A1    | A2          | B1      | B2          | C1      | C2
------+-------------+---------+-------------+---------+------------
    3 |          10 |       3 |          20 |       3 |          20
    4 |           1 | ??????? | ??????????? |       4 |           2
    6 |           1 | ??????? | ??????????? |       6 |           2
 
resultcount :                     3
 
Enter command:
SELECT A1, A2, B1, B2, C1, C2 FROM
    (SELECT TA.*, TB.* FROM TA, TB WHERE A1 (+)= B1), TC
    WHERE A1 (+)= C1 !
 
resultcount :                     3
 
Enter command:
FETCH !
 
A1    | A2          | B1      | B2          | C1      | C2
------+-------------+---------+-------------+---------+------------
    3 |          10 |       3 |          20 |       3 |          20
????? | ??????????? | ??????? | ??????????? |       4 |           2
????? | ??????????? | ??????? | ??????????? |       6 |           2
 
resultcount :                     3
 
Enter command:
SELECT A1, A2, B1, B2, C1, C2 FROM TC,
    (SELECT TA.*, TB.* FROM TA, TB WHERE A1 (+)= B1)
    WHERE A1 (+)= C1 !
 
resultcount :                     3
 
Enter command:
FETCH !
 
A1    | A2          | B1      | B2          | C1      | C2
------+-------------+---------+-------------+---------+------------
    3 |          10 |       3 |          20 |       3 |          20
????? | ??????????? | ??????? | ??????????? |       4 |           2
????? | ??????????? | ??????? | ??????????? |       6 |           2
 
resultcount :                     3
 
Enter command:
SELECT A1, A2, B1, B2, C1, C2 FROM TA,
    (SELECT TB.*, TC.* FROM TB, TC WHERE B1 (+)= C1)
    WHERE A1 (+)= C1 !
 
resultcount :                     3
 
Enter command:
FETCH !
 
A1    | A2          | B1      | B2          | C1      | C2
------+-------------+---------+-------------+---------+------------
    3 |          10 |       3 |          20 |       3 |          20
    4 |           1 | ??????? | ??????????? |       4 |           2
    6 |           1 | ??????? | ??????????? |       6 |           2
 
resultcount :                     3
 
Enter command:
SELECT A1, A2, B1, B2, C1, C2 FROM
    (SELECT TB.*, TC.* FROM TB, TC WHERE B1 (+)= C1), TA
    WHERE A1 (+)= C1 !
 
resultcount :                     3
 
Enter command:
FETCH !
 
A1    | A2          | B1      | B2          | C1      | C2
------+-------------+---------+-------------+---------+------------
    3 |          10 |       3 |          20 |       3 |          20
    4 |           1 | ??????? | ??????????? |       4 |           2
    6 |           1 | ??????? | ??????????? |       6 |           2
 
resultcount :                     3
 
Enter command:
SELECT A1, A2, B1, B2, C1, C2 FROM
    (SELECT * FROM TA, TB WHERE A1 (+)= B1), TC
    WHERE A1 (+)= C1 !
 
resultcount :                     3
 
Enter command:
FETCH !
 
A1    | A2          | B1      | B2          | C1      | C2
------+-------------+---------+-------------+---------+------------
    3 |          10 |       3 |          20 |       3 |          20
????? | ??????????? | ??????? | ??????????? |       4 |           2
????? | ??????????? | ??????? | ??????????? |       6 |           2
 
resultcount :                     3
 
Enter command:
SELECT A1, A2, B1, B2, C1, C2 FROM TC,
    (SELECT * FROM TA, TB WHERE A1 (+)= B1)
    WHERE A1 (+)= C1 !
 
resultcount :                     3
 
Enter command:
FETCH !
 
A1    | A2          | B1      | B2          | C1      | C2
------+-------------+---------+-------------+---------+------------
    3 |          10 |       3 |          20 |       3 |          20
????? | ??????????? | ??????? | ??????????? |       4 |           2
????? | ??????????? | ??????? | ??????????? |       6 |           2
 
resultcount :                     3
 
Enter command:
SELECT A1, A2, B1, B2, C1, C2 FROM TB,
    (SELECT * FROM TA, TC WHERE A1 (+)= C1)
    WHERE A1 (+)= B1 !
 
resultcount :                     4
 
Enter command:
FETCH !
 
A1    | A2          | B1      | B2          | C1      | C2
------+-------------+---------+-------------+---------+------------
    3 |          10 |       3 |          20 |       3 |          20
????? | ??????????? |       2 |          20 | ??????? | ???????????
????? | ??????????? |       5 |           2 | ??????? | ???????????
????? | ??????????? |       7 |           2 | ??????? | ???????????
 
resultcount :                     4
 
Enter command:
SELECT A1, A2, B1, B2, C1, C2 FROM
    (SELECT * FROM TA, TC WHERE A1 (+)= C1), TB
    WHERE A1 (+)= B1 !
 
resultcount :                     4
 
Enter command:
FETCH !
 
A1    | A2          | B1      | B2          | C1      | C2
------+-------------+---------+-------------+---------+------------
    3 |          10 |       3 |          20 |       3 |          20
????? | ??????????? |       2 |          20 | ??????? | ???????????
????? | ??????????? |       5 |           2 | ??????? | ???????????
????? | ??????????? |       7 |           2 | ??????? | ???????????
 
resultcount :                     4
 
Enter command:
COMMIT RELEASE !
 
Enter command:
FILE CONNECT ( SUT SUT !
 
Enter command:
CONNECT SUT IDENTIFIED BY SUT   ISOLATION LEVEL 1 !
 
Enter command:
DROP USER KERN !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( SUT SUT !
 
Enter command:
CONNECT SUT IDENTIFIED BY SUT   ISOLATION LEVEL 1 !
 
Enter command:
CREATE USER KERN PASSWORD TEST DBA NOT EXCLUSIVE !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
FILE CONNECT ( KERN TEST !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST   ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE T1 (A1 CHAR(5), A2 CHAR(5)) !
 
Enter command:
INSERT T1 VALUES ('aaaaa','bba21') !
 
Enter command:
INSERT T1 VALUES ('aaaaa','zza22') !
 
Enter command:
CREATE TABLE T2 (B1 CHAR(5), B2 CHAR(5)) !
 
Enter command:
INSERT T2 VALUES ('bbbbb','xxb21') !
 
Enter command:
INSERT T2 VALUES ('bbbbb','eeb22') !
 
Enter command:
CREATE TABLE T3 (C1 CHAR(5), C2 CHAR(5)) !
 
Enter command:
INSERT T3 VALUES ('ccccc','aac21') !
 
Enter command:
INSERT T3 VALUES ('ccccc','zzc22') !
 
Enter command:
SELECT * FROM
  (SELECT A1, A2 FROM T1 WHERE A1 = 'aaaaa'
   UNION
   SELECT B1, B2 FROM T2 WHERE B1 = 'bbbbb')
UNION
SELECT C1, C2 FROM T3 WHERE C1 = 'ccccc'
UNION
SELECT A2, B1 FROM T1, T2 WHERE B2 = 'xxxxx'
ORDER BY 2 !
 
resultcount :                     6
 
Enter command:
FETCH !
 
A1    | A2
------+------
ccccc | aac21
aaaaa | bba21
bbbbb | eeb22
bbbbb | xxb21
aaaaa | zza22
ccccc | zzc22
 
resultcount :                     6
 
Enter command:
SELECT * FROM
  (SELECT A1, A2, SUBSTR ('table t1', 1) FROM T1 WHERE A1 = 'aaaaa'
   UNION
   SELECT B1, B2, SUBSTR ('table t2', 1) FROM T2 WHERE B1 = 'bbbbb')
UNION
SELECT C1, C2, SUBSTR ('table t3', 1) FROM T3 WHERE C1 = 'ccccc'
UNION
SELECT A2, B1, SUBSTR ('table t1, t2', 1) FROM T1, T2 WHERE B2 = 'xxxxx' !
 
resultcount :                     6
 
Enter command:
FETCH !
 
A1    | A2    | EXPRESSION1
------+-------+-------------
aaaaa | bba21 | table t1
ccccc | aac21 | table t3
bbbbb | eeb22 | table t2
aaaaa | zza22 | table t1
bbbbb | xxb21 | table t2
ccccc | zzc22 | table t3
 
resultcount :                     6
 
Enter command:
SELECT C1, C2, SUBSTR ('table t3', 1) FROM T3 WHERE C1 = 'ccccc'
UNION
SELECT A2, B1, SUBSTR ('table t1, t2', 1) FROM T1, T2 WHERE B2 = 'xxxxx'
UNION
SELECT * FROM
  (SELECT * FROM
        (SELECT A1, A2, SUBSTR ('table t1', 1) FROM T1 WHERE A1 = 'aaaaa')
UNION
SELECT B1, B2, SUBSTR ('table t2', 1) FROM T2 WHERE B1 = 'bbbbb')
ORDER BY 3 !
 
resultcount :                     6
 
Enter command:
FETCH !
 
C1    | C2    | EXPRESSION1
------+-------+-------------
aaaaa | bba21 | table t1
aaaaa | zza22 | table t1
bbbbb | eeb22 | table t2
bbbbb | xxb21 | table t2
ccccc | aac21 | table t3
ccccc | zzc22 | table t3
 
resultcount :                     6
 
Enter command:
SELECT * FROM
  (SELECT A1, A2, SUBSTR ('table t1', 1) FROM T1 WHERE A1 = 'aaaaa'
   UNION
   SELECT B1, B2, SUBSTR ('table t2', 1) FROM T2 WHERE B1 = 'bbbbb')
UNION
SELECT C1, C2, SUBSTR ('table t3', 1) FROM T3 WHERE C1 = 'ccccc'
UNION
SELECT A2, B1, SUBSTR ('table t1, t2', 1) FROM T1, T2 WHERE B2 = 'xxxxx'
ORDER BY 3 !
 
resultcount :                     6
 
Enter command:
FETCH !
 
A1    | A2    | EXPRESSION1
------+-------+-------------
aaaaa | bba21 | table t1
aaaaa | zza22 | table t1
bbbbb | eeb22 | table t2
bbbbb | xxb21 | table t2
ccccc | aac21 | table t3
ccccc | zzc22 | table t3
 
resultcount :                     6
 
Enter command:
EXPLAIN SELECT * FROM (SELECT * FROM T1 X, T1 Y) !
 
***ERROR  -6001 Duplicate column name:A1                                   0031
 
Enter command:
SELECT * FROM (SELECT * FROM T1 X, T1 Y)
ORDER BY X.A1, Y.A2 !
 
***ERROR  -6001 Duplicate column name:A1                                   0023
 
Enter command:
FETCH !
 
***ERROR    100 Row not found                                              0001
 
Enter command:
SELECT * FROM (SELECT * FROM T1 X, T1 Y) !
 
***ERROR  -6001 Duplicate column name:A1                                   0023
 
Enter command:
FETCH !
 
***ERROR    100 Row not found                                              0001
 
Enter command:
SELECT * FROM (SELECT X.A1 SP11, X.A2 SP12, Y.A1 SP21, Y.A2 SP22
FROM T1 X, T1 Y) X
ORDER BY X.SP11, X.SP12 !
 
resultcount :                     4
 
Enter command:
FETCH !
 
SP11  | SP12  | SP21  | SP22
------+-------+-------+------
aaaaa | bba21 | aaaaa | bba21
aaaaa | bba21 | aaaaa | zza22
aaaaa | zza22 | aaaaa | bba21
aaaaa | zza22 | aaaaa | zza22
 
resultcount :                     4
 
Enter command:
COMMIT RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST   ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE PVC_VSETELEMHIST (
OBJECTID        INT,
ACTIVATIONSEQNO INT,
VERSIONID       INT,
VERSIONSETID    INT,
MODOPERATION INT,
AUTOVERSION  INT,
DEACTIVATED  BOOLEAN) !
 
Enter command:
CREATE INDEX I ON PVC_VSETELEMHIST (VERSIONSETID) !
 
Enter command:
INSERT INTO PVC_VSETELEMHIST VALUES
(1,1,1,1,1,1,TRUE)!
 
Enter command:
 
CREATE TABLE DAV_RESOURCE (
RESOURCEID   INT,
PATHURI      CHAR (20) ) !
 
Enter command:
INSERT INTO DAV_RESOURCE VALUES (1, 'abc')!
 
Enter command:
 
CREATE TABLE PVC_VSINTEGRATION (
TARGETVSID     INT,
SEQUENCENUMBER INT,
CREATIONTIME   TIME) !
 
Enter command:
CREATE INDEX I ON PVC_VSINTEGRATION (TARGETVSID) !
 
Enter command:
INSERT INTO PVC_VSINTEGRATION VALUES (1,1,TIME)!
 
Enter command:
 
CREATE TABLE DAV_MOVEHISTORY  (
VERSIONSETID    INT,
INTEGRATIONTIME INT,
OLDVERSIONID    INT,
INTEGRATIONSEQNO INT) !
 
Enter command:
INSERT INTO DAV_MOVEHISTORY VALUES (1,1,1,1)!
 
Enter command:
 
CREATE TABLE PVC_VERSION (
VERSIONID INT,
OBJECTID  INT) !
 
Enter command:
INSERT INTO PVC_VERSION VALUES (1,1)!
 
Enter command:
 
PARSING !
 
Enter command:
           SELECT VSEH.OBJECTID
                , VSEH.ACTIVATIONSEQNO
                , VSEH.VERSIONID
                , VSEH.VERSIONSETID
                , MODOPERATION
                , AUTOVERSION
                , DEACTIVATED
            FROM
                PVC_VSETELEMHIST VSEH
                , DAV_RESOURCE R,
                (SELECT VSEH.OBJECTID, MAX(ACTIVATIONSEQNO) AS ASN
                FROM PVC_VSINTEGRATION VSI
                , PVC_VSETELEMHIST VSEH
                WHERE VSI.TARGETVSID = VSEH.VERSIONSETID
                AND VSI.SEQUENCENUMBER = VSEH.ACTIVATIONSEQNO
                AND VSI.TARGETVSID = ?
                GROUP BY VSEH.OBJECTID
                ) MAXS
            WHERE
                VSEH.OBJECTID = MAXS.OBJECTID
                AND VSEH.ACTIVATIONSEQNO = MAXS.ASN
                AND VSEH.VERSIONSETID = ?
                AND VSEH.VERSIONID = R.RESOURCEID
                AND R.PATHURI LIKE ?
            UNION
            SELECT
                VSEH.OBJECTID
                , VSEH.ACTIVATIONSEQNO
                , VSEH.VERSIONID
                , VSEH.VERSIONSETID
                , MODOPERATION
                , AUTOVERSION
                , DEACTIVATED
            FROM
                PVC_VSETELEMHIST VSEH
                , (SELECT MH.INTEGRATIONSEQNO
                , V.OBJECTID
                FROM DAV_MOVEHISTORY MH
                , DAV_RESOURCE R
                , PVC_VERSION V
                WHERE MH.VERSIONSETID = ?
                AND R.RESOURCEID = MH.OLDVERSIONID
                AND R.PATHURI LIKE ?
                AND V.VERSIONID = MH.OLDVERSIONID
                ) MOVES
            WHERE
                VSEH.VERSIONSETID = ?
                AND VSEH.ACTIVATIONSEQNO = MOVES.INTEGRATIONSEQNO
                AND VSEH.OBJECTID = MOVES.OBJECTID
            ORDER BY 1, 2 DESC!
parsing idnr :       1
 
Enter command:
EXECUTING !
 
Enter command:
DATA !
 
Enter command:
SELECT !
Parsing idnr :      1
 
n 10 1
n 10 1
c 30 'abc'
n 10 1
c 30 'abc'
n 10 1
 
resultcount :                     1
 
Enter command:
PARS_THEN_EX !
 
Enter command:
NODATA !
 
Enter command:
FETCH INTO :A, :B, :C, :D, :E, :F, :G !
 
OBJECTID          :  <objectid>
ACTIVATIONSEQNO   :            1
VERSIONID         :            1
VERSIONSETID      :            1
MODOPERATION      :            1
AUTOVERSION       :            1
DEACTIVATED       :  1
 
resultcount :                     1
 
Enter command:
EXECUTING !
 
Enter command:
DATA !
 
Enter command:
SELECT !
Parsing idnr :      1
 
n 10 1
n 10 1
c 30 'abc'
n 10 1
c 30 'abc'
n 10 1
 
resultcount :                     1
 
Enter command:
PARS_THEN_EX !
 
Enter command:
NODATA !
 
Enter command:
FETCH INTO :A, :B, :C, :D, :E, :F, :G !
 
OBJECTID          :  <objectid>
ACTIVATIONSEQNO   :            1
VERSIONID         :            1
VERSIONSETID      :            1
MODOPERATION      :            1
AUTOVERSION       :            1
DEACTIVATED       :  1
 
resultcount :                     1
 
Enter command:
PARS_EXECUTE !
 
Enter command:
ROLLBACK RELEASE !
 
Enter command:
FILE CONNECT ( SUT SUT !
 
Enter command:
CONNECT SUT IDENTIFIED BY SUT   ISOLATION LEVEL 1 !
 
Enter command:
DROP USER KERN !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
 
FILE JOIN_F ( 'YES' !
 
Enter command:
SENDERID DBM !
FILE CONNECT ( SUT SUT !
 
Enter command:
CONNECT SUT IDENTIFIED BY SUT   ISOLATION LEVEL 1 !
 
Enter command:
SET PARAMETER OPTIMIZE_OPERATOR_JOIN = 'YES' !
 
Enter command:
COMMIT RELEASE !
 
Enter command:
SENDERID XCI !
 
FILE CONNECT ( SUT SUT !
 
Enter command:
CONNECT SUT IDENTIFIED BY SUT   ISOLATION LEVEL 1 !
 
Enter command:
CREATE USER KERN PASSWORD TEST DBA NOT EXCLUSIVE !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
FILE CONNECT ( KERN TEST SQLMODE ORACLE !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE ORACLE ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE MITARBEITER (
   MA_ID        NUMBER (3) NOT NULL PRIMARY KEY,
   NAME         CHAR (30)  NOT NULL,
   SOLL_STUNDEN NUMBER (3) NOT NULL)!
 
Enter command:
INSERT INTO MITARBEITER VALUES (1, 'Ladewig', 40)!
 
Enter command:
INSERT INTO MITARBEITER VALUES (2, 'Schweiberger', 40)!
 
Enter command:
INSERT INTO MITARBEITER VALUES (3, 'Crossley', 20)!
 
Enter command:
INSERT INTO MITARBEITER VALUES (4, 'Ellis', 20)!
 
Enter command:
CREATE TABLE PROJEKT (
   PROJEKTID   NUMBER(3) NOT NULL PRIMARY KEY,
   ITS_NAME  CHAR(30) NOT NULL)!
 
Enter command:
INSERT INTO PROJEKT VALUES (1, 'Beratung IT Verlag')!
 
Enter command:
INSERT INTO PROJEKT VALUES (2, 'Loesung SQL Reatsel')!
 
Enter command:
INSERT INTO PROJEKT VALUES (3, 'Uebersetzung/Dokumentation')!
 
Enter command:
INSERT INTO PROJEKT VALUES (4, 'Vernetzung IT Verlag')!
 
Enter command:
CREATE TABLE PROJEKT_ZUORDNUNG (
   MA_ID                NUMBER (3) NOT NULL REFERENCES MITARBEITER,
   PROJEKTID           NUMBER (3) NOT NULL REFERENCES PROJEKT,
   ZEIT_ANTEIL_PROZENT  NUMBER (3),
        PRIMARY KEY (MA_ID, PROJEKTID))!
 
Enter command:
INSERT INTO PROJEKT_ZUORDNUNG VALUES (1, 1, 50)!
 
Enter command:
INSERT INTO PROJEKT_ZUORDNUNG VALUES (1, 2, 50)!
 
Enter command:
INSERT INTO PROJEKT_ZUORDNUNG VALUES (2, 1, 30)!
 
Enter command:
INSERT INTO PROJEKT_ZUORDNUNG VALUES (2, 2, 60)!
 
Enter command:
INSERT INTO PROJEKT_ZUORDNUNG VALUES (2, 3, 10)!
 
Enter command:
INSERT INTO PROJEKT_ZUORDNUNG VALUES (3, 2, 10)!
 
Enter command:
INSERT INTO PROJEKT_ZUORDNUNG VALUES (3, 3, 90)!
 
Enter command:
CREATE TABLE PROJZEIT (
   MA_ID       NUMBER (3) NOT NULL,
   PROJEKTID  NUMBER(3) NOT NULL,
   DATUM       DATE NOT NULL,
   WOCHE       NUMBER (4) NOT NULL,
   STUNDEN     NUMBER (2) NOT NULL,
        PRIMARY KEY (MA_ID, PROJEKTID, DATUM),
        FOREIGN KEY (MA_ID, PROJEKTID) REFERENCES PROJEKT_ZUORDNUNG)!
 
Enter command:
INSERT INTO PROJZEIT VALUES (1, 1, '21-JUN-93', 9325, 8)!
 
Enter command:
INSERT INTO PROJZEIT VALUES (1, 1, '22-JUN-93', 9325, 8)!
 
Enter command:
INSERT INTO PROJZEIT VALUES (1, 2, '23-JUN-93', 9325, 8)!
 
Enter command:
INSERT INTO PROJZEIT VALUES (1, 2, '24-JUN-93', 9325, 8)!
 
Enter command:
INSERT INTO PROJZEIT VALUES (1, 2, '25-JUN-93', 9325, 8)!
 
Enter command:
INSERT INTO PROJZEIT VALUES (2, 1, '21-JUN-93', 9325, 8)!
 
Enter command:
INSERT INTO PROJZEIT VALUES (2, 1, '22-JUN-93', 9325, 8)!
 
Enter command:
INSERT INTO PROJZEIT VALUES (2, 2, '23-JUN-93', 9325, 8)!
 
Enter command:
INSERT INTO PROJZEIT VALUES (2, 2, '24-JUN-93', 9325, 8)!
 
Enter command:
INSERT INTO PROJZEIT VALUES (2, 2, '25-JUN-93', 9325, 8)!
 
Enter command:
INSERT INTO PROJZEIT VALUES (3, 2, '21-JUN-93', 9325, 4)!
 
Enter command:
INSERT INTO PROJZEIT VALUES (3, 3, '21-JUN-93', 9325, 4)!
 
Enter command:
INSERT INTO PROJZEIT VALUES (3, 3, '22-JUN-93', 9325, 8)!
 
Enter command:
INSERT INTO PROJZEIT VALUES (3, 3, '23-JUN-93', 9325, 8)!
 
Enter command:
INSERT INTO PROJZEIT VALUES (3, 3, '24-JUN-93', 9325, 8)!
 
Enter command:
INSERT INTO PROJZEIT VALUES (3, 3, '25-JUN-93', 9325, 8)!
 
Enter command:
COMMIT WORK !
 
Enter command:
SELECT MITARBEITER.NAME,
       PROJEKT.ITS_NAME
  FROM MITARBEITER, PROJEKT_ZUORDNUNG, PROJEKT
 WHERE MITARBEITER.MA_ID = PROJEKT_ZUORDNUNG.MA_ID
   AND PROJEKT_ZUORDNUNG.PROJEKTID = PROJEKT.PROJEKTID
 AND (MITARBEITER.SOLL_STUNDEN * PROJEKT_ZUORDNUNG.ZEIT_ANTEIL_PROZENT)
        / 100
     > (SELECT NVL(SUM(PROJZEIT.STUNDEN), 0)
          FROM PROJZEIT
         WHERE PROJZEIT.MA_ID = MITARBEITER.MA_ID
           AND PROJZEIT.PROJEKTID = PROJEKT.PROJEKTID
           AND WOCHE = 9325)!
 
resultcount :                     0
 
Enter command:
FETCH INTO :MA, :PR !
 
NAME                           | ITS_NAME
-------------------------------+-------------------------------
Ladewig                        | Beratung IT Verlag
Schweiberger                   | Uebersetzung/Dokumentation
 
resultcount :                     2
 
Enter command:
COMMIT RELEASE !
 
Enter command:
FILE CONNECT ( KERN TEST  !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST   ISOLATION LEVEL 1 !
 
Enter command:
SELECT SOLL.MA_ID, SOLL.NAME, ITS_NAME, SOLL, GELEISTET
    FROM
    (SELECT FIXED (SUM (STUNDEN), 5,2) GELEISTET, MA_ID, PROJEKTID
       FROM PROJZEIT
       GROUP BY MA_ID, PROJEKTID
     UNION
     SELECT 0, MA_ID, PROJEKTID FROM PROJEKT_ZUORDNUNG WHERE
        CHR (MA_ID) || CHR (PROJEKTID) NOT IN
          (SELECT CHR(MA_ID) || CHR (PROJEKTID) FROM PROJZEIT)
    ) GELEISTET,
    (SELECT A.MA_ID, A.NAME, B.PROJEKTID, ITS_NAME,
       FIXED (SOLL_STUNDEN / 100 * ZEIT_ANTEIL_PROZENT, 5, 2) SOLL
                    FROM MITARBEITER A,
                    PROJEKT_ZUORDNUNG B,
                    PROJEKT WHERE A.MA_ID = B.MA_ID AND
                    B.PROJEKTID = PROJEKT.PROJEKTID) SOLL
WHERE
SOLL.MA_ID      = GELEISTET.MA_ID      AND
SOLL.PROJEKTID = GELEISTET.PROJEKTID AND
SOLL > GELEISTET !
 
resultcount :                     2
 
Enter command:
FETCH !
 
MA_ID             :     2
NAME              :  Schweiberger
ITS_NAME          :  Uebersetzung/Dokumentation
SOLL              :     4.00
GELEISTET         :     0.00
---------------------------------------------------
MA_ID             :     1
NAME              :  Ladewig
ITS_NAME          :  Beratung IT Verlag
SOLL              :    20.00
GELEISTET         :    16.00
 
resultcount :                     2
 
Enter command:
 
SELECT SOLL.MA_ID, SOLL.NAME, ITS_NAME, SOLL, GELEISTET
    FROM
    (SELECT A.MA_ID, A.NAME, B.PROJEKTID, ITS_NAME,
       FIXED (SOLL_STUNDEN / 100 * ZEIT_ANTEIL_PROZENT, 5, 2) SOLL
                    FROM MITARBEITER A,
                    PROJEKT_ZUORDNUNG B,
                    PROJEKT WHERE A.MA_ID = B.MA_ID AND
                    B.PROJEKTID = PROJEKT.PROJEKTID) SOLL,
    (SELECT FIXED (SUM (STUNDEN), 5,2) GELEISTET, MA_ID, PROJEKTID
       FROM PROJZEIT
       GROUP BY MA_ID, PROJEKTID
     UNION
     SELECT 0, MA_ID, PROJEKTID FROM PROJEKT_ZUORDNUNG WHERE
        CHR (MA_ID) || CHR (PROJEKTID) NOT IN
          (SELECT CHR(MA_ID) || CHR (PROJEKTID) FROM PROJZEIT)
    ) GELEISTET
WHERE
SOLL.MA_ID      = GELEISTET.MA_ID      AND
SOLL.PROJEKTID = GELEISTET.PROJEKTID AND
SOLL > GELEISTET !
 
resultcount :                     2
 
Enter command:
FETCH!
 
MA_ID             :     2
NAME              :  Schweiberger
ITS_NAME          :  Uebersetzung/Dokumentation
SOLL              :     4.00
GELEISTET         :     0.00
---------------------------------------------------
MA_ID             :     1
NAME              :  Ladewig
ITS_NAME          :  Beratung IT Verlag
SOLL              :    20.00
GELEISTET         :    16.00
 
resultcount :                     2
 
Enter command:
 
SELECT SOLL.MA_ID, SOLL.NAME, ITS_NAME, SOLL, GELEISTET
    FROM
    (SELECT A.MA_ID, A.NAME, B.PROJEKTID, ITS_NAME,
       FIXED (SOLL_STUNDEN / 100 * ZEIT_ANTEIL_PROZENT, 5, 2) SOLL
                    FROM MITARBEITER A,
                    PROJEKT_ZUORDNUNG B,
                    PROJEKT WHERE A.MA_ID = B.MA_ID AND
                    B.PROJEKTID = PROJEKT.PROJEKTID) SOLL,
    (SELECT FIXED (SUM (STUNDEN), 5,2) GELEISTET, MA_ID, PROJEKTID
       FROM PROJZEIT
       GROUP BY MA_ID, PROJEKTID
     UNION
     SELECT 0, MA_ID, PROJEKTID FROM PROJEKT_ZUORDNUNG WHERE
        CHR (MA_ID) || CHR (PROJEKTID) NOT IN
          (SELECT CHR(MA_ID) || CHR (PROJEKTID) FROM PROJZEIT)
    ) GELEISTET
WHERE
SOLL.MA_ID      = GELEISTET.MA_ID      AND
SOLL.PROJEKTID = GELEISTET.PROJEKTID AND
SOLL > GELEISTET !
 
resultcount :                     2
 
Enter command:
FETCH !
 
MA_ID             :     2
NAME              :  Schweiberger
ITS_NAME          :  Uebersetzung/Dokumentation
SOLL              :     4.00
GELEISTET         :     0.00
---------------------------------------------------
MA_ID             :     1
NAME              :  Ladewig
ITS_NAME          :  Beratung IT Verlag
SOLL              :    20.00
GELEISTET         :    16.00
 
resultcount :                     2
 
Enter command:
 
DROP TABLE MITARBEITER !
 
Enter command:
DROP TABLE PROJEKT !
 
Enter command:
DROP TABLE PROJEKT_ZUORDNUNG!
 
Enter command:
DROP TABLE PROJZEIT!
 
Enter command:
COMMIT RELEASE !
 
Enter command:
FILE CONNECT ( KERN TEST !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST   ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE TAHEF
           (EJJ CHAR(2),
            AUS FIXED(5),
            OBJ FIXED(5),
            EMM CHAR(2),
            JJJ FIXED(5),
            HHH FIXED(5)) !
 
Enter command:
CREATE TABLE TAAGN
           (AGN FIXED(10),
            VBE FIXED(5),
            TX1 CHAR(30))!
 
Enter command:
CREATE TABLE TAWER
           (KDN FIXED(10),
            PRN FIXED(10),
            ANT FIXED(11),
            VOL FIXED(5),
            AUS FIXED(5),
            OBJ FIXED(5),
            AGN FIXED(10),
            JJJ FIXED(5),
            HHH FIXED(5))!
 
Enter command:
CREATE TABLE TAKP1
           (BRH FIXED(5),
            BRU FIXED(5),
            PRN FIXED(10),
            KDN FIXED(10))!
 
Enter command:
 
COMMIT WORK!
 
Enter command:
SELECT H.EJJ , H.AUS , H.OBJ , S.KDN , S.PRN , A.VBE , K.VBE , P.BRH ,
       P.BRU , S.ANT , S.VOL
 FROM TAHEF  H , TAWER  S , TAAGN  K , TAAGN  A , TAKP1  P
UNION ALL SELECT H.EJJ , H.AUS , H.OBJ , S.KDN , S.PRN ,     99 ,
  K.VBE , P.BRH , P.BRU , S.ANT , S.VOL
 FROM TAHEF  H , TAWER  S , TAAGN  K , TAKP1  P
 WHERE  NOT  EXISTS
   (SELECT  *  FROM TAAGN  A  WHERE A.AGN  = S.AGN )
UNION ALL SELECT H.EJJ , H.AUS , H.OBJ , S.KDN , S.PRN , A.VBE ,
 K.VBE ,   9999 ,     99 , S.ANT , S.VOL  FROM TAHEF  H , TAWER  S ,
 TAAGN  K , TAAGN  A
 WHERE  NOT  EXISTS
  (SELECT  *  FROM TAKP1  P
  WHERE P.KDN  = S.KDN  AND P.PRN  = S.PRN )
   UNION ALL SELECT H.EJJ , H.AUS , H.OBJ , S.KDN , S.PRN ,     99 ,
   K.VBE ,   9999 ,     99 , S.ANT , S.VOL
   FROM TAHEF  H , TAWER  S , TAAGN  K  WHERE NOT  EXISTS
  (SELECT  *  FROM TAAGN  A  WHERE A.AGN  = S.AGN )  AND  NOT  EXISTS
  (SELECT  *  FROM TAKP1  P  WHERE P.KDN  = S.KDN  AND P.PRN  = S.PRN )
  ORDER BY      4 ,      5 !
 
***ERROR    100 Row not found                                              0001
 
Enter command:
 
SELECT H.EJJ , H.AUS , H.OBJ , S.KDN , S.PRN , A.VBE , K.VBE , P.BRH ,
       P.BRU , S.ANT , S.VOL
 FROM TAHEF  H , TAWER  S , TAAGN  K , TAAGN  A , TAKP1  P
 WHERE  (H.OBJ  =      4 )  AND  (H.EJJ  = '92' )  AND  (H.EMM  = '01' )
  AND  (K.VBE  =      2 )  AND  (K.AGN  = S.KDN )  AND  (S.OBJ  = H.OBJ )
  AND  (S.AUS  = H.AUS )  AND  (S.JJJ  = H.JJJ )  AND  (S.HHH  = H.HHH )
  AND  (K.AGN  = S.KDN )  AND  (A.AGN  = S.AGN )  AND  (P.PRN  = S.PRN )
  AND  (P.KDN  = S.KDN )
UNION ALL SELECT H.EJJ , H.AUS , H.OBJ , S.KDN , S.PRN ,     99 ,
  K.VBE , P.BRH , P.BRU , S.ANT , S.VOL
 FROM TAHEF  H , TAWER  S , TAAGN  K , TAKP1  P
 WHERE  (H.OBJ  =    4 )
  AND  (H.EJJ  = '92' )  AND  (H.EMM  = '01' )  AND  (K.VBE  =      2 )
  AND  (K.AGN  = S.KDN )  AND  (S.OBJ  = H.OBJ )  AND  (S.AUS  = H.AUS )
  AND  (S.JJJ  = H.JJJ )  AND  (S.HHH  = H.HHH )  AND  (P.PRN  = S.PRN )
  AND  (P.KDN  = S.KDN )  AND  NOT  EXISTS
   (SELECT  *  FROM TAAGN  A  WHERE A.AGN  = S.AGN )
UNION ALL SELECT H.EJJ , H.AUS , H.OBJ , S.KDN , S.PRN , A.VBE ,
 K.VBE ,   9999 ,     99 , S.ANT , S.VOL  FROM TAHEF  H , TAWER  S ,
 TAAGN  K , TAAGN  A
 WHERE  (H.OBJ  =      4 )  AND  (H.EJJ  = '92' )
  AND  (H.EMM  = '01' )  AND  (K.VBE  =      2 )  AND  (K.AGN  = S.KDN )
  AND  (S.OBJ  = H.OBJ )  AND  (S.AUS  = H.AUS )  AND  (S.JJJ  = H.JJJ )
  AND  (S.HHH  = H.HHH )  AND  (A.AGN  = S.AGN )  AND  NOT  EXISTS
  (SELECT  *  FROM TAKP1  P
  WHERE P.KDN  = S.KDN  AND P.PRN  = S.PRN )
   UNION ALL SELECT H.EJJ , H.AUS , H.OBJ , S.KDN , S.PRN ,     99 ,
   K.VBE ,   9999 ,     99 , S.ANT , S.VOL
   FROM TAHEF  H , TAWER  S , TAAGN  K  WHERE  (H.OBJ  =      4 )
  AND  (H.EJJ  = '92' )  AND  (H.EMM  = '01' )  AND  (K.VBE  =      2 )
  AND  (K.AGN  = S.KDN )  AND  (S.OBJ  = H.OBJ )  AND  (S.AUS  = H.AUS )
  AND  (S.JJJ  = H.JJJ )  AND  (S.HHH  = H.HHH )  AND  NOT  EXISTS
  (SELECT  *  FROM TAAGN  A  WHERE A.AGN  = S.AGN )  AND  NOT  EXISTS
  (SELECT  *  FROM TAKP1  P  WHERE P.KDN  = S.KDN  AND P.PRN  = S.PRN )
  ORDER BY      4 ,      5 !
 
***ERROR    100 Row not found                                              0001
 
Enter command:
 
 
 
SELECT H.EJJ , H.AUS , H.OBJ , S.KDN , S.PRN , A.VBE , K.VBE , P.BRH ,
       P.BRU , S.ANT , S.VOL
 FROM TAHEF  H , TAWER  S , TAAGN  K , TAAGN  A , TAKP1  P
 WHERE  (H.OBJ  =      4 )  AND  (H.EJJ  = '92' )  AND  (H.EMM  = '01' )
  AND  (K.VBE  =      2 )  AND  (K.AGN  = S.KDN )  AND  (S.OBJ  = H.OBJ )
  AND  (S.AUS  = H.AUS )  AND  (S.JJJ  = H.JJJ )  AND  (S.HHH  = H.HHH )
  AND  (K.AGN  = S.KDN )  AND  (A.AGN  = S.AGN )  AND  (P.PRN  = S.PRN )
  AND  (P.KDN  = S.KDN )
UNION ALL SELECT H.EJJ , H.AUS , H.OBJ , S.KDN , S.PRN ,     99 ,
  K.VBE , P.BRH , P.BRU , S.ANT , S.VOL
 FROM TAHEF  H , TAWER  S , TAAGN  K , TAKP1  P
 WHERE  (H.OBJ  =    4 )
  AND  (H.EJJ  = '92' )  AND  (H.EMM  = '01' )  AND  (K.VBE  =      2 )
  AND  (K.AGN  = S.KDN )  AND  (S.OBJ  = H.OBJ )  AND  (S.AUS  = H.AUS )
  AND  (S.JJJ  = H.JJJ )  AND  (S.HHH  = H.HHH )  AND  (P.PRN  = S.PRN )
  AND  (P.KDN  = S.KDN )  AND  NOT  EXISTS
   (SELECT  *  FROM TAAGN  A  WHERE A.AGN  = S.AGN )
UNION ALL SELECT H.EJJ , H.AUS , H.OBJ , S.KDN , S.PRN , A.VBE ,
 K.VBE ,   9999 ,     99 , S.ANT , S.VOL  FROM TAHEF  H , TAWER  S ,
 TAAGN  K , TAAGN  A
 WHERE  (H.OBJ  =      4 )  AND  (H.EJJ  = '92' )
  AND  (H.EMM  = '01' )  AND  (K.VBE  =      2 )  AND  (K.AGN  = S.KDN )
  AND  (S.OBJ  = H.OBJ )  AND  (S.AUS  = H.AUS )  AND  (S.JJJ  = H.JJJ )
  AND  (S.HHH  = H.HHH )  AND  (A.AGN  = S.AGN )  AND  NOT  EXISTS
  (SELECT  *  FROM TAKP1  P
  WHERE P.KDN  = S.KDN  AND P.PRN  = S.PRN )
   UNION ALL SELECT H.EJJ , H.AUS , H.OBJ , S.KDN , S.PRN ,     99 ,
   K.VBE ,   9999 ,     99 , S.ANT , S.VOL
   FROM TAHEF  H , TAWER  S , TAAGN  K  WHERE  (H.OBJ  =      4 )
  AND  (H.EJJ  = '92' )  AND  (H.EMM  = '01' )  AND  (K.VBE  =      2 )
  AND  (K.AGN  = S.KDN )  AND  (S.OBJ  = H.OBJ )  AND  (S.AUS  = H.AUS )
  AND  (S.JJJ  = H.JJJ )  AND  (S.HHH  = H.HHH )  AND  NOT  EXISTS
  (SELECT  *  FROM TAAGN  A  WHERE A.AGN  = S.AGN )  AND  NOT  EXISTS
  (SELECT  *  FROM TAKP1  P  WHERE P.KDN  = S.KDN  AND P.PRN  = S.PRN )
  ORDER BY      4 ,      5 !
 
***ERROR    100 Row not found                                              0001
 
Enter command:
DROP TABLE TAHEF  !
 
Enter command:
DROP TABLE TAAGN  !
 
Enter command:
DROP TABLE TAWER  !
 
Enter command:
DROP TABLE TAKP1  !
 
Enter command:
COMMIT RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST   ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE FLUEGE
 (FLUG_NR       FIXED(3) KEY,
  GES_PLAETZE   FIXED(3) NOT NULL,
  VERF_PLAETZE  FIXED(3) NOT NULL)!
 
Enter command:
INSERT INTO FLUEGE VALUES (1, 200, 5)!
 
Enter command:
INSERT INTO FLUEGE VALUES (2, 300, 3)!
 
Enter command:
INSERT INTO FLUEGE VALUES (3, 450, 4)!
 
Enter command:
CREATE TABLE BUCHUNGEN
 (ID      FIXED (5) KEY,
  FLUG_NR FIXED(3) NOT NULL REFERENCES FLUEGE,
  NAME    CHAR (20) NOT NULL)!
 
Enter command:
INSERT INTO BUCHUNGEN VALUES ( 3, 3, 'Albrecht')!
 
Enter command:
INSERT INTO BUCHUNGEN VALUES (10, 1, 'Baader')!
 
Enter command:
INSERT INTO BUCHUNGEN VALUES (11, 1, 'Chall')!
 
Enter command:
INSERT INTO BUCHUNGEN VALUES ( 4, 1, 'Hansen')!
 
Enter command:
INSERT INTO BUCHUNGEN VALUES ( 1, 1, 'Jonas')!
 
Enter command:
INSERT INTO BUCHUNGEN VALUES ( 6, 3, 'Kauffmann')!
 
Enter command:
INSERT INTO BUCHUNGEN VALUES ( 7, 2, 'Lindemann')!
 
Enter command:
INSERT INTO BUCHUNGEN VALUES ( 8, 1, 'Linke')!
 
Enter command:
INSERT INTO BUCHUNGEN VALUES ( 2, 2, 'Medinger')!
 
Enter command:
INSERT INTO BUCHUNGEN VALUES ( 5, 2, 'Weiss')!
 
Enter command:
INSERT INTO BUCHUNGEN VALUES ( 9, 2, 'Weyhausen')!
 
Enter command:
SELECT A.FLUG_NR, A.NAME
  FROM BUCHUNGEN A, FLUEGE
 WHERE A.FLUG_NR = FLUEGE.FLUG_NR
   AND VERF_PLAETZE >=
           (SELECT COUNT(*)
              FROM BUCHUNGEN
             WHERE BUCHUNGEN.ID <= A.ID
               AND BUCHUNGEN.FLUG_NR = A.FLUG_NR)
 ORDER BY A.FLUG_NR, ID !
 
resultcount :                    10
 
Enter command:
FETCH !
 
FLUG_NR | NAME
--------+---------------------
   1    | Jonas
   1    | Hansen
   1    | Linke
   1    | Baader
   1    | Chall
   2    | Medinger
   2    | Weiss
   2    | Lindemann
   3    | Albrecht
   3    | Kauffmann
 
resultcount :                    10
 
Enter command:
DROP TABLE FLUEGE !
 
Enter command:
DROP TABLE BUCHUNGEN !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST   ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE RECHNUNGEN (RENR FIXED (4) KEY,
                         KDNR FIXED (4) NOT NULL,
                       BETRAG FIXED(9,2) NOT NULL)!
 
Enter command:
INSERT INTO RECHNUNGEN VALUES (1, 1, 1000)!
 
Enter command:
INSERT INTO RECHNUNGEN VALUES (2, 2, 1000)!
 
Enter command:
INSERT INTO RECHNUNGEN VALUES (3, 3, 1000)!
 
Enter command:
INSERT INTO RECHNUNGEN VALUES (4, 4, 1000)!
 
Enter command:
INSERT INTO RECHNUNGEN VALUES (5, 2, 2000)!
 
Enter command:
INSERT INTO RECHNUNGEN VALUES (6, 1, 3000)!
 
Enter command:
INSERT INTO RECHNUNGEN VALUES (7, 2, 1000)!
 
Enter command:
SELECT A.KDNR, A.RENR, A.BETRAG BETRAG,
       A.BETRAG / SUM (B.BETRAG) * 100 PROZENT
FROM RECHNUNGEN A, RECHNUNGEN B
GROUP BY A.KDNR, A.RENR, A.BETRAG !
 
resultcount :                     7
 
Enter command:
FETCH !
 
KDNR  | RENR  | BETRAG      | PROZENT
------+-------+-------------+---------------------------------------------
    1 |     1 |     1000.00 |  1.0000000000000000000000000000000000000E+01
    1 |     6 |     3000.00 |  3.0000000000000000000000000000000000000E+01
    2 |     2 |     1000.00 |  1.0000000000000000000000000000000000000E+01
    2 |     5 |     2000.00 |  2.0000000000000000000000000000000000000E+01
    2 |     7 |     1000.00 |  1.0000000000000000000000000000000000000E+01
    3 |     3 |     1000.00 |  1.0000000000000000000000000000000000000E+01
    4 |     4 |     1000.00 |  1.0000000000000000000000000000000000000E+01
 
resultcount :                     7
 
Enter command:
SELECT A.KDNR,
       FLOAT(SUM (A.BETRAG) / COUNT (DISTINCT B.RENR),18) BETRAG,
       FLOAT(SUM (A.BETRAG) / COUNT (DISTINCT B.RENR) /
      (SUM (B.BETRAG) / COUNT (DISTINCT A.RENR)) * 100,18) PROZENT
FROM RECHNUNGEN A, RECHNUNGEN B
GROUP BY A.KDNR !
 
resultcount :                     4
 
Enter command:
FETCH!
 
KDNR  | BETRAG                   | PROZENT
------+--------------------------+-------------------------
    1 |  4.00000000000000000E+03 |  4.00000000000000000E+01
    2 |  4.00000000000000000E+03 |  4.00000000000000000E+01
    3 |  1.00000000000000000E+03 |  1.00000000000000000E+01
    4 |  1.00000000000000000E+03 |  1.00000000000000000E+01
 
resultcount :                     4
 
Enter command:
SELECT A.KDNR,
       FLOAT(SUM (A.BETRAG), 18),
       FLOAT(SUM (A.BETRAG) / SUM(B.SUMBETRAG) * 100, 18) PROZENT
FROM RECHNUNGEN A,
     (SELECT SUM (BETRAG) SUMBETRAG
      FROM RECHNUNGEN) B
GROUP BY A.KDNR !
 
resultcount :                     4
 
Enter command:
FETCH!
 
KDNR  | EXPRESSION1              | PROZENT
------+--------------------------+-------------------------
    1 |  4.00000000000000000E+03 |  2.00000000000000000E+01
    2 |  4.00000000000000000E+03 |  1.33333333333333333E+01
    3 |  1.00000000000000000E+03 |  1.00000000000000000E+01
    4 |  1.00000000000000000E+03 |  1.00000000000000000E+01
 
resultcount :                     4
 
Enter command:
SELECT A.KDNR,
       FLOAT(SUM (A.BETRAG), 18),
       FLOAT(SUM (A.BETRAG) / B.SUMBETRAG * 100, 18) PROZENT
FROM RECHNUNGEN A,
     (SELECT SUM (BETRAG) SUMBETRAG
      FROM RECHNUNGEN) B
GROUP BY A.KDNR, B.SUMBETRAG !
 
resultcount :                     4
 
Enter command:
FETCH!
 
KDNR  | EXPRESSION1              | PROZENT
------+--------------------------+-------------------------
    1 |  4.00000000000000000E+03 |  4.00000000000000000E+01
    2 |  4.00000000000000000E+03 |  4.00000000000000000E+01
    3 |  1.00000000000000000E+03 |  1.00000000000000000E+01
    4 |  1.00000000000000000E+03 |  1.00000000000000000E+01
 
resultcount :                     4
 
Enter command:
SELECT A.KDNR,
       FIXED(SUM (A.BETRAG), 10) BETRAG,
       FIXED(SUM (A.BETRAG) / B.SUMBETRAG * 100, 3) PROZENT
FROM RECHNUNGEN A,
     (SELECT SUM (BETRAG) SUMBETRAG
      FROM RECHNUNGEN) B
GROUP BY A.KDNR, B.SUMBETRAG !
 
resultcount :                     4
 
Enter command:
FETCH!
 
KDNR  | BETRAG      | PROZENT
------+-------------+--------
    1 |        4000 |   40
    2 |        4000 |   40
    3 |        1000 |   10
    4 |        1000 |   10
 
resultcount :                     4
 
Enter command:
DROP TABLE RECHNUNGEN!
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST SQLMODE ORACLE !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE ORACLE ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE LAGER_FREI (
REGAL     NUMBER (3) NOT NULL,
FREI_VON  NUMBER (4) NOT NULL,
FREI_BIS  NUMBER (4) NOT NULL,
CHECK (FREI_VON < FREI_BIS),
PRIMARY KEY (REGAL, FREI_VON)) !
 
Enter command:
INSERT INTO LAGER_FREI VALUES (1,  25,3767)!
 
Enter command:
INSERT INTO LAGER_FREI VALUES (1,4234,4965)!
 
Enter command:
INSERT INTO LAGER_FREI VALUES (1,5001,5010)!
 
Enter command:
INSERT INTO LAGER_FREI VALUES (2, 702, 711)!
 
Enter command:
INSERT INTO LAGER_FREI VALUES (1,8001,8029)!
 
Enter command:
INSERT INTO LAGER_FREI VALUES (2,   1,  23)!
 
Enter command:
INSERT INTO LAGER_FREI VALUES (3,  25, 234)!
 
Enter command:
INSERT INTO LAGER_FREI VALUES (2,  55, 600)!
 
Enter command:
INSERT INTO LAGER_FREI VALUES (2, 800,7000)!
 
Enter command:
INSERT INTO LAGER_FREI VALUES (3, 255, 900)!
 
Enter command:
INSERT INTO LAGER_FREI VALUES (1,   1,  23)!
 
Enter command:
INSERT INTO LAGER_FREI VALUES (3,1002,7000)!
 
Enter command:
INSERT INTO LAGER_FREI VALUES (3, 921, 943)!
 
Enter command:
COMMIT WORK RELEASE!
 
Enter command:
 
FILE CONNECT ( KERN TEST SQLMODE ORACLE !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE ORACLE ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE TABLES
  (NAME         VARCHAR (30) PRIMARY KEY,
   STORAGE_SIZE NUMBER) !
 
Enter command:
INSERT INTO TABLES VALUES ('KONTO'  , 1000)!
 
Enter command:
INSERT INTO TABLES VALUES ('ARTIKEL', 1000)!
 
Enter command:
COMMIT !
 
Enter command:
CREATE TABLE INDEXES
  (NAME        VARCHAR2 (30) PRIMARY KEY,
   TABLE_NAME  VARCHAR2 (30) NOT NULL REFERENCES TABLES,
   UNIQUE_FLAG VARCHAR2 ( 4) NOT NULL
                      CHECK (UNIQUE_FLAG IN ('YES', 'NO'))) !
 
Enter command:
INSERT INTO INDEXES VALUES ('KT01', 'KONTO'  , 'YES')!
 
Enter command:
INSERT INTO INDEXES VALUES ('KT02', 'KONTO'  , 'YES')!
 
Enter command:
INSERT INTO INDEXES VALUES ('KT03', 'KONTO'  , 'YES')!
 
Enter command:
INSERT INTO INDEXES VALUES ('KT04', 'KONTO'  , 'YES')!
 
Enter command:
INSERT INTO INDEXES VALUES ('ART1', 'ARTIKEL', 'YES')!
 
Enter command:
INSERT INTO INDEXES VALUES ('ART2', 'ARTIKEL', 'YES')!
 
Enter command:
INSERT INTO INDEXES VALUES ('ART3', 'ARTIKEL', 'YES')!
 
Enter command:
INSERT INTO INDEXES VALUES ('ART4', 'ARTIKEL', 'YES')!
 
Enter command:
COMMIT !
 
Enter command:
CREATE TABLE INDEX_COLUMNS
  (INDEX_NAME      VARCHAR2 (30) REFERENCES INDEXES,
   COLUMN_NAME     VARCHAR2 (30) NOT NULL,
   COLUMN_POSITION NUMBER NOT NULL
                          CHECK (COLUMN_POSITION > 0),
   PRIMARY KEY (INDEX_NAME, COLUMN_NAME),
   CONSTRAINT C1_INDEX_NAME UNIQUE (INDEX_NAME, COLUMN_POSITION)) !
 
Enter command:
INSERT INTO INDEX_COLUMNS VALUES ('KT01', 'COL1', 1)!
 
Enter command:
INSERT INTO INDEX_COLUMNS VALUES ('KT02', 'COL1', 1)!
 
Enter command:
INSERT INTO INDEX_COLUMNS VALUES ('KT02', 'COL2', 2)!
 
Enter command:
INSERT INTO INDEX_COLUMNS VALUES ('KT03', 'COL1', 1)!
 
Enter command:
INSERT INTO INDEX_COLUMNS VALUES ('KT03', 'COL2', 2)!
 
Enter command:
INSERT INTO INDEX_COLUMNS VALUES ('KT03', 'COL3', 3)!
 
Enter command:
INSERT INTO INDEX_COLUMNS VALUES ('KT04', 'COL3', 1)!
 
Enter command:
INSERT INTO INDEX_COLUMNS VALUES ('KT04', 'COL4', 2)!
 
Enter command:
INSERT INTO INDEX_COLUMNS VALUES ('ART1', 'COLA', 1)!
 
Enter command:
INSERT INTO INDEX_COLUMNS VALUES ('ART1', 'COLB', 2)!
 
Enter command:
INSERT INTO INDEX_COLUMNS VALUES ('ART2', 'COLB', 1)!
 
Enter command:
INSERT INTO INDEX_COLUMNS VALUES ('ART2', 'COLC', 2)!
 
Enter command:
INSERT INTO INDEX_COLUMNS VALUES ('ART3', 'COLC', 1)!
 
Enter command:
INSERT INTO INDEX_COLUMNS VALUES ('ART3', 'COLD', 2)!
 
Enter command:
INSERT INTO INDEX_COLUMNS VALUES ('ART4', 'COLC', 1)!
 
Enter command:
INSERT INTO INDEX_COLUMNS VALUES ('ART4', 'COLD', 2)!
 
Enter command:
INSERT INTO INDEX_COLUMNS VALUES ('ART4', 'COLE', 3)!
 
Enter command:
INSERT INTO INDEX_COLUMNS VALUES ('ART4', 'COLF', 4)!
 
Enter command:
COMMIT !
 
Enter command:
SELECT SUBSTR(I1.TABLE_NAME, 1, 10),
       SUBSTR(I1.NAME, 1, 10),
       SUBSTR(I2.NAME, 1, 10)
  FROM INDEXES I1, INDEXES I2
 WHERE I1.TABLE_NAME = I2.TABLE_NAME
   AND I1.NAME <> I2.NAME
   AND NOT EXISTS
           (SELECT COLUMN_NAME, COLUMN_POSITION
              FROM INDEX_COLUMNS C1
             WHERE I2.NAME = C1.INDEX_NAME
           MINUS
           SELECT COLUMN_NAME, COLUMN_POSITION
             FROM INDEX_COLUMNS C2
            WHERE I1.NAME = C2.INDEX_NAME) !
 
***ERROR  -7011 Correlated subquery not allowed                            0255
 
Enter command:
FETCH INTO :A, :B, :C!
 
***ERROR  -4000 Unknown result table                                       0001
 
Enter command:
SELECT SUBSTR(I1.TABLE_NAME, 1, 10),
       SUBSTR(I1.NAME, 1, 10),
       SUBSTR(I2.NAME, 1, 10)
  FROM INDEXES I1, INDEXES I2
 WHERE I1.TABLE_NAME = I2.TABLE_NAME
   AND I1.NAME <> I2.NAME
   AND NOT EXISTS
           (SELECT *
              FROM INDEX_COLUMNS IC1
             WHERE IC1.INDEX_NAME = I2.NAME
               AND NOT EXISTS
                       (SELECT *
                          FROM INDEX_COLUMNS IC2
                         WHERE IC2.INDEX_NAME = I1.NAME
                           AND IC1.COLUMN_NAME = IC2.COLUMN_NAME)) !
 
resultcount :                     0
 
Enter command:
FETCH INTO :A, :B, :C!
 
EXPRESSION1 | EXPRESSION2 | EXPRESSION3
------------+-------------+------------
ARTIKEL     | ART4        | ART3
KONTO       | KT02        | KT01
KONTO       | KT03        | KT01
KONTO       | KT03        | KT02
 
resultcount :                     4
 
Enter command:
SELECT SUBSTR(I1.TABLE_NAME, 1, 10),
       SUBSTR(I2.NAME, 1, 10),
       SUBSTR(I1.NAME, 1, 10)
  FROM INDEXES I1,
       INDEXES I2,
       INDEX_COLUMNS IC1
 WHERE I1.TABLE_NAME = I2.TABLE_NAME
   AND I1.NAME = IC1.INDEX_NAME
   AND I1.NAME <> I2.NAME
   AND IC1.COLUMN_POSITION =
                (SELECT COUNT(*)
                   FROM INDEX_COLUMNS
                  WHERE INDEX_NAME = I1.NAME)
   AND IC1.COLUMN_POSITION =
                (SELECT COUNT(*)
                   FROM INDEX_COLUMNS IC2,
                        INDEX_COLUMNS IC3
                  WHERE IC2.INDEX_NAME = I1.NAME
                    AND IC3.INDEX_NAME = I2.NAME
                    AND IC2.COLUMN_NAME = IC3.COLUMN_NAME
                    AND IC2.COLUMN_POSITION = IC3.COLUMN_POSITION) !
 
resultcount :                     0
 
Enter command:
FETCH INTO :A, :B, :C!
 
EXPRESSION1 | EXPRESSION2 | EXPRESSION3
------------+-------------+------------
ARTIKEL     | ART4        | ART3
KONTO       | KT02        | KT01
KONTO       | KT03        | KT01
KONTO       | KT03        | KT02
 
resultcount :                     4
 
Enter command:
DROP TABLE TABLES !
 
Enter command:
DROP TABLE INDEXES !
 
Enter command:
DROP TABLE INDEX_COLUMNS !
 
Enter command:
COMMIT RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST SQLMODE ORACLE !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE ORACLE ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE BUECHER
   (BUCH_NR NUMBER PRIMARY KEY,
    TITEL   VARCHAR (30) NOT NULL,
    AUTOR   VARCHAR (30) NOT NULL)!
 
Enter command:
INSERT INTO BUECHER VALUES (1, 'ORACLE7'         , 'G. Stuerner')!
 
Enter command:
INSERT INTO BUECHER VALUES (2, 'INFORMIX 6.0/7.1', 'D. Petkovic')!
 
Enter command:
INSERT INTO BUECHER VALUES (3, 'SYBASE'          , 'D. McGoveran')!
 
Enter command:
COMMIT !
 
Enter command:
CREATE TABLE LESER
   (LESER_NR NUMBER PRIMARY KEY,
    NAME     VARCHAR (30) NOT NULL) !
 
Enter command:
INSERT INTO LESER VALUES (1, 'H. Kohl')!
 
Enter command:
INSERT INTO LESER VALUES (2, 'B. Clinton')!
 
Enter command:
INSERT INTO LESER VALUES (3, 'B. Jelzin')!
 
Enter command:
COMMIT !
 
Enter command:
CREATE TABLE AUSLEIHE
   (BUCH_NR  NUMBER REFERENCES BUECHER,
    LESER_NR NUMBER REFERENCES LESER,
    EIN_AUS  CHAR (3) NOT NULL
                 CHECK (EIN_AUS IN ('EIN', 'AUS')),
    DATUM    DATE NOT NULL,
    PRIMARY KEY (BUCH_NR, DATUM))!
 
Enter command:
COMMIT RELEASE !
 
Enter command:
FILE CONNECT ( KERN TEST !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST   ISOLATION LEVEL 1 !
 
Enter command:
INSERT INTO AUSLEIHE VALUES (3, 3, 'AUS', '19950609000000')!
 
Enter command:
INSERT INTO AUSLEIHE VALUES (2, 2, 'AUS', '19950611000000')!
 
Enter command:
INSERT INTO AUSLEIHE VALUES (1, 1, 'AUS', '19950612000000')!
 
Enter command:
INSERT INTO AUSLEIHE VALUES (3, 3, 'EIN', '19950613000000')!
 
Enter command:
INSERT INTO AUSLEIHE VALUES (1, 1, 'EIN', '19950615000000')!
 
Enter command:
INSERT INTO AUSLEIHE VALUES (1, 2, 'AUS', '19950617000000')!
 
Enter command:
INSERT INTO AUSLEIHE VALUES (2, 2, 'EIN', '19950618000000')!
 
Enter command:
INSERT INTO AUSLEIHE VALUES (2, 3, 'AUS', '19950619000000')!
 
Enter command:
INSERT INTO AUSLEIHE VALUES (3, 1, 'AUS', '19950619000000')!
 
Enter command:
INSERT INTO AUSLEIHE VALUES (1, 2, 'EIN', '19950622000000')!
 
Enter command:
INSERT INTO AUSLEIHE VALUES (2, 3, 'EIN', '19950627000000')!
 
Enter command:
INSERT INTO AUSLEIHE VALUES (3, 1, 'EIN', '19950630000000')!
 
Enter command:
COMMIT !
 
Enter command:
SELECT TITEL, NAME, AUS.EIN_AUS, EIN.EIN_AUS,
      DATEDIFF(EIN.DATUM, AUS.DATUM) DAUER
  FROM BUECHER, LESER, AUSLEIHE AUS, AUSLEIHE EIN
 WHERE BUECHER.BUCH_NR = AUS.BUCH_NR
   AND LESER.LESER_NR  = AUS.LESER_NR
   AND AUS.BUCH_NR     = EIN.BUCH_NR
   AND AUS.LESER_NR    = EIN.LESER_NR
   AND AUS.EIN_AUS     = 'AUS'
   AND EIN.EIN_AUS     = 'EIN'
   AND EIN.DATUM = (SELECT MIN (DATUM)
                      FROM AUSLEIHE
                     WHERE AUSLEIHE.EIN_AUS  = 'EIN'
                       AND AUSLEIHE.BUCH_NR  = AUS.BUCH_NR
                       AND AUSLEIHE.LESER_NR = AUS.LESER_NR
                       AND AUSLEIHE.DATUM    > AUS.DATUM) !
 
resultcount :                     6
 
Enter command:
FETCH!
 
TITEL             :  ORACLE7
NAME              :  H. Kohl
EIN_AUS           :  AUS
EIN_AUS           :  EIN
DAUER             :         3
---------------------------------------------------
TITEL             :  ORACLE7
NAME              :  B. Clinton
EIN_AUS           :  AUS
EIN_AUS           :  EIN
DAUER             :         5
---------------------------------------------------
TITEL             :  INFORMIX 6.0/7.1
NAME              :  B. Clinton
EIN_AUS           :  AUS
EIN_AUS           :  EIN
DAUER             :         7
---------------------------------------------------
TITEL             :  INFORMIX 6.0/7.1
NAME              :  B. Jelzin
EIN_AUS           :  AUS
EIN_AUS           :  EIN
DAUER             :         8
---------------------------------------------------
TITEL             :  SYBASE
NAME              :  H. Kohl
EIN_AUS           :  AUS
EIN_AUS           :  EIN
DAUER             :        11
---------------------------------------------------
TITEL             :  SYBASE
NAME              :  B. Jelzin
EIN_AUS           :  AUS
EIN_AUS           :  EIN
DAUER             :         4
 
resultcount :                     6
 
Enter command:
DROP TABLE BUECHER !
 
Enter command:
DROP TABLE LESER !
 
Enter command:
DROP TABLE AUSLEIHE !
 
Enter command:
COMMIT RELEASE!
 
Enter command:
 
FILE CONNECT ( KERN TEST SQLMODE INTERNAL !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE INTERNAL ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE ARTIKEL (
NUMMER      INTEGER PRIMARY KEY,
BEZEICHNUNG VARCHAR(30))!
 
Enter command:
INSERT INTO ARTIKEL VALUES (1, 'Bier')!
 
Enter command:
INSERT INTO ARTIKEL VALUES (2, 'Wein')!
 
Enter command:
CREATE TABLE PREIS (
NUMMER      INTEGER,
START_DATUM DATE,
PREIS       FIXED(10,2) NOT NULL,
PRIMARY KEY (NUMMER, START_DATUM),
FOREIGN KEY (NUMMER) REFERENCES ARTIKEL)!
 
Enter command:
INSERT INTO PREIS VALUES (1, '19950101', 1.20)!
 
Enter command:
INSERT INTO PREIS VALUES (1, '19950201', 1.30)!
 
Enter command:
INSERT INTO PREIS VALUES (1, '19950301', 1.50)!
 
Enter command:
INSERT INTO PREIS VALUES (1, '19950601', 1.90)!
 
Enter command:
INSERT INTO PREIS VALUES (2, '19950101', 1.90)!
 
Enter command:
INSERT INTO PREIS VALUES (2, '19950401', 1.50)!
 
Enter command:
INSERT INTO PREIS VALUES (2, '19951101', 2.10)!
 
Enter command:
CREATE TABLE VERKAUF (
NUMMER      INTEGER,
DATUM       DATE,
ANZAHL      INTEGER NOT NULL,
PRIMARY KEY (NUMMER, DATUM),
FOREIGN KEY (NUMMER) REFERENCES ARTIKEL)!
 
Enter command:
INSERT INTO VERKAUF VALUES (1, '19950120',  20)!
 
Enter command:
INSERT INTO VERKAUF VALUES (1, '19950311',  20)!
 
Enter command:
INSERT INTO VERKAUF VALUES (2, '19950514', 345)!
 
Enter command:
INSERT INTO VERKAUF VALUES (1, '19950811',  55)!
 
Enter command:
INSERT INTO VERKAUF VALUES (2, '19950214',  55)!
 
Enter command:
INSERT INTO VERKAUF VALUES (2, '19951014', 345)!
 
Enter command:
SELECT A.BEZEICHNUNG,
       FIXED(SUM(P.PREIS * V.ANZAHL), 8,2) SUMME
  FROM ARTIKEL A, VERKAUF V, PREIS P
 WHERE A.NUMMER = V.NUMMER
   AND V.NUMMER = P.NUMMER
   AND P.START_DATUM =
                     (SELECT MAX (PR.START_DATUM)
                        FROM PREIS PR
                       WHERE PR.NUMMER = V.NUMMER
                         AND PR.START_DATUM <= V.DATUM)
GROUP BY A.BEZEICHNUNG !
 
resultcount :                     2
 
Enter command:
FETCH INTO :A, :B !
 
BEZEICHNUNG                    | SUMME
-------------------------------+-----------
Bier                           |     158.50
Wein                           |    1139.50
 
resultcount :                     2
 
Enter command:
SELECT A.BEZEICHNUNG,
       FIXED(SUM(P.PREIS * V.ANZAHL), 8,2) SUMME
  FROM ARTIKEL A, VERKAUF V, PREIS P
 WHERE A.NUMMER = V.NUMMER
   AND V.NUMMER = P.NUMMER
   AND P.START_DATUM <= V.DATUM
   AND NOT EXISTS (SELECT 1
                     FROM PREIS PR
                    WHERE PR.NUMMER = V.NUMMER
                      AND PR.START_DATUM > P.START_DATUM
                      AND PR.START_DATUM <= V.DATUM)
GROUP BY A.BEZEICHNUNG !
 
resultcount :                     2
 
Enter command:
FETCH INTO :A, :B !
 
BEZEICHNUNG                    | SUMME
-------------------------------+-----------
Bier                           |     158.50
Wein                           |    1139.50
 
resultcount :                     2
 
Enter command:
DROP TABLE ARTIKEL !
 
Enter command:
DROP TABLE PREIS !
 
Enter command:
DROP TABLE VERKAUF !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST SQLMODE INTERNAL !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE INTERNAL ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE PERSONAL (
ID   INTEGER PRIMARY KEY,
NAME VARCHAR (10))!
 
Enter command:
INSERT INTO PERSONAL VALUES (1, 'Ofer')!
 
Enter command:
INSERT INTO PERSONAL VALUES (2, 'Hansen')!
 
Enter command:
INSERT INTO PERSONAL VALUES (3, 'Meyer')!
 
Enter command:
INSERT INTO PERSONAL VALUES (4, 'Albrecht')!
 
Enter command:
INSERT INTO PERSONAL VALUES (5, 'Linke')!
 
Enter command:
CREATE TABLE RENTE (
ID     INTEGER REFERENCES PERSONAL,
JAHR   INTEGER,
MONATE INTEGER NOT NULL CHECK (MONATE BETWEEN 1 AND 12),
LOHN   INTEGER NOT NULL,
PRIMARY KEY (ID, JAHR))!
 
Enter command:
INSERT INTO RENTE VALUES (1, 1989,  2, 1500)!
 
Enter command:
INSERT INTO RENTE VALUES (2, 1989, 12, 2200)!
 
Enter command:
INSERT INTO RENTE VALUES (4, 1989,  3, 1200)!
 
Enter command:
INSERT INTO RENTE VALUES (3, 1989,  2, 1700)!
 
Enter command:
INSERT INTO RENTE VALUES (2, 1990, 12, 2300)!
 
Enter command:
INSERT INTO RENTE VALUES (3, 1990,  2, 1900)!
 
Enter command:
INSERT INTO RENTE VALUES (4, 1990,  3, 1400)!
 
Enter command:
INSERT INTO RENTE VALUES (2, 1991, 12, 2400)!
 
Enter command:
INSERT INTO RENTE VALUES (1, 1992,  2, 2100)!
 
Enter command:
INSERT INTO RENTE VALUES (4, 1992,  3, 1900)!
 
Enter command:
INSERT INTO RENTE VALUES (3, 1992,  2, 2100)!
 
Enter command:
INSERT INTO RENTE VALUES (2, 1992, 12, 2500)!
 
Enter command:
INSERT INTO RENTE VALUES (1, 1993,  2, 2200)!
 
Enter command:
INSERT INTO RENTE VALUES (4, 1993,  3, 2100)!
 
Enter command:
INSERT INTO RENTE VALUES (5, 1993,  6, 3000)!
 
Enter command:
INSERT INTO RENTE VALUES (2, 1993, 12, 2600)!
 
Enter command:
INSERT INTO RENTE VALUES (1, 1994,  2, 2300)!
 
Enter command:
INSERT INTO RENTE VALUES (2, 1994, 12, 2700)!
 
Enter command:
INSERT INTO RENTE VALUES (3, 1994,  2, 2300)!
 
Enter command:
SELECT P.NAME, FIXED(MIN(R1.JAHR),4,0) BEG,
       FIXED(MAX(R1.JAHR),4,0) ENDE,
       FIXED(SUM(R1.MONATE),4,0) SUM_MONATE,
       FIXED(SUM(R1.LOHN * R1.MONATE) / SUM(R1.MONATE), 6,0) AVG_LOHN
  FROM RENTE R1, PERSONAL P
 WHERE R1.ID = P.ID
   AND R1.JAHR >= (SELECT MIN (R2.JAHR)
                     FROM RENTE R2
                    WHERE R1.ID = R2.ID
                      AND EXISTS
                               (SELECT COUNT(*)
                                  FROM RENTE R3
                                 WHERE R1.ID = R3.ID
                                   AND R2.JAHR <= R3.JAHR
                                GROUP BY R3.ID
                                HAVING COUNT(R3.JAHR) =
                                     MAX(R3.JAHR) - R2.JAHR + 1
                                   AND SUM(R3.MONATE) >= 6)
                 )
GROUP BY P.NAME !
 
resultcount :                     4
 
Enter command:
FETCH INTO :A, :B, :C, :D, :E !
 
NAME       | BEG   | ENDE  | SUM_MONATE | AVG_LOHN
-----------+-------+-------+------------+---------
Albrecht   |  1992 |  1993 |     6      |    2000
Hansen     |  1989 |  1994 |    72      |    2450
Linke      |  1993 |  1993 |     6      |    3000
Ofer       |  1992 |  1994 |     6      |    2200
 
resultcount :                     4
 
Enter command:
SELECT P.NAME, FIXED(MIN(R1.JAHR),4,0) BEG,
       FIXED(MAX(R1.JAHR),4,0) ENDE,
       FIXED(SUM(R1.MONATE),4,0) SUM_MONATE,
       FIXED(SUM(R1.LOHN * R1.MONATE) / SUM(R1.MONATE), 6,0) AVG_LOHN
  FROM RENTE R1, PERSONAL P
 WHERE R1.ID = P.ID
   AND (  R1.JAHR IN (SELECT R2.JAHR + 1
                        FROM RENTE R2
                       WHERE R1.ID = R2.ID)
        OR
          R1.JAHR IN (SELECT R3.JAHR - 1
                        FROM RENTE R3
                       WHERE R1.ID = R3.ID)
        OR
          R1.MONATE >= 6)
GROUP BY P.NAME, R1.ID
HAVING SUM(MONATE) >= 6 !
 
resultcount :                     4
 
Enter command:
FETCH INTO :A, :B, :C, :D, :E !
 
NAME       | BEG   | ENDE  | SUM_MONATE | AVG_LOHN
-----------+-------+-------+------------+---------
Albrecht   |  1989 |  1993 |    12      |    1650
Hansen     |  1989 |  1994 |    72      |    2450
Linke      |  1993 |  1993 |     6      |    3000
Ofer       |  1992 |  1994 |     6      |    2200
 
resultcount :                     4
 
Enter command:
DROP TABLE RENTE !
 
Enter command:
DROP TABLE PERSONAL !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST SQLMODE INTERNAL !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE INTERNAL ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE ARTIKEL (
ARTIKEL_NR  INTEGER PRIMARY KEY,
BEZEICHNUNG VARCHAR(12) NOT NULL)!
 
Enter command:
INSERT INTO ARTIKEL VALUES (1, 'Brot')!
 
Enter command:
INSERT INTO ARTIKEL VALUES (2, 'Fisch')!
 
Enter command:
INSERT INTO ARTIKEL VALUES (3, 'Nudeln')!
 
Enter command:
INSERT INTO ARTIKEL VALUES (4, 'Milch')!
 
Enter command:
INSERT INTO ARTIKEL VALUES (5, 'Tomatensosse')!
 
Enter command:
CREATE TABLE SCANNER_HEADER (
BON_ID  INTEGER PRIMARY KEY,
DATUM   DATE NOT NULL) !
 
Enter command:
INSERT INTO SCANNER_HEADER VALUES (1, '19951220')!
 
Enter command:
INSERT INTO SCANNER_HEADER VALUES (2, '19951220')!
 
Enter command:
INSERT INTO SCANNER_HEADER VALUES (3, '19951220')!
 
Enter command:
INSERT INTO SCANNER_HEADER VALUES (4, '19951220')!
 
Enter command:
INSERT INTO SCANNER_HEADER VALUES (5, '19951220')!
 
Enter command:
INSERT INTO SCANNER_HEADER VALUES (6, '19951220')!
 
Enter command:
INSERT INTO SCANNER_HEADER VALUES (7, '19951220')!
 
Enter command:
INSERT INTO SCANNER_HEADER VALUES (8, '19951220')!
 
Enter command:
CREATE TABLE SCANNER_LINE (
BON_ID     INTEGER
           CONSTRAINT SCANNER_HEADER_LINE_REF REFERENCES SCANNER_HEADER,
ZEILE      INTEGER,
ARTIKEL_NR INTEGER NOT NULL
           CONSTRAINT SCANNER_ARTIKEL_REF REFERENCES ARTIKEL,
MENGE      INTEGER NOT NULL
           CONSTRAINT MENGEN_CHECK CHECK (MENGE > 0),
CONSTRAINT SCANNER_KEY PRIMARY KEY (BON_ID, ZEILE))!
 
Enter command:
INSERT INTO SCANNER_LINE VALUES (1,1,1,1)!
 
Enter command:
INSERT INTO SCANNER_LINE VALUES (1,2,2,1)!
 
Enter command:
INSERT INTO SCANNER_LINE VALUES (1,3,3,1)!
 
Enter command:
INSERT INTO SCANNER_LINE VALUES (1,4,4,1)!
 
Enter command:
INSERT INTO SCANNER_LINE VALUES (1,5,5,1)!
 
Enter command:
INSERT INTO SCANNER_LINE VALUES (2,1,2,1)!
 
Enter command:
INSERT INTO SCANNER_LINE VALUES (2,2,4,2)!
 
Enter command:
INSERT INTO SCANNER_LINE VALUES (3,1,1,4)!
 
Enter command:
INSERT INTO SCANNER_LINE VALUES (3,2,3,3)!
 
Enter command:
INSERT INTO SCANNER_LINE VALUES (3,3,5,1)!
 
Enter command:
INSERT INTO SCANNER_LINE VALUES (4,1,1,1)!
 
Enter command:
INSERT INTO SCANNER_LINE VALUES (4,2,3,2)!
 
Enter command:
INSERT INTO SCANNER_LINE VALUES (4,3,4,2)!
 
Enter command:
INSERT INTO SCANNER_LINE VALUES (5,1,2,1)!
 
Enter command:
INSERT INTO SCANNER_LINE VALUES (5,2,4,2)!
 
Enter command:
INSERT INTO SCANNER_LINE VALUES (5,3,5,2)!
 
Enter command:
INSERT INTO SCANNER_LINE VALUES (6,1,3,2)!
 
Enter command:
INSERT INTO SCANNER_LINE VALUES (6,2,5,1)!
 
Enter command:
INSERT INTO SCANNER_LINE VALUES (7,1,1,1)!
 
Enter command:
INSERT INTO SCANNER_LINE VALUES (8,1,3,2)!
 
Enter command:
INSERT INTO SCANNER_LINE VALUES (8,2,5,3)!
 
Enter command:
SELECT EINS.BEZEICHNUNG, ZWEI.BEZEICHNUNG
  FROM ARTIKEL EINS, ARTIKEL ZWEI,
       SCANNER_LINE SC1,  SCANNER_LINE SC2
 WHERE SC1.BON_ID = SC2.BON_ID
   AND SC1.ARTIKEL_NR  = EINS.ARTIKEL_NR
   AND SC2.ARTIKEL_NR  = ZWEI.ARTIKEL_NR
GROUP BY EINS.BEZEICHNUNG, EINS.ARTIKEL_NR,
         ZWEI.BEZEICHNUNG, ZWEI.ARTIKEL_NR
HAVING COUNT(EINS.ARTIKEL_NR) >=
           (SELECT 0.5 * COUNT(*)
              FROM SCANNER_LINE SC
             WHERE SC.ARTIKEL_NR = EINS.ARTIKEL_NR)
    OR COUNT(ZWEI.ARTIKEL_NR) >=
           (SELECT 0.5 * COUNT(*)
              FROM SCANNER_LINE SC
             WHERE SC.ARTIKEL_NR = ZWEI.ARTIKEL_NR)
!
 
resultcount :                    21
 
Enter command:
FETCH INTO :A, :B !
 
BEZEICHNUNG  | BEZEICHNUNG
-------------+-------------
Brot         | Brot
Brot         | Milch
Brot         | Nudeln
Brot         | Tomatensosse
Fisch        | Fisch
Fisch        | Milch
Fisch        | Tomatensosse
Milch        | Brot
Milch        | Fisch
Milch        | Milch
Milch        | Nudeln
Milch        | Tomatensosse
Nudeln       | Brot
Nudeln       | Milch
Nudeln       | Nudeln
Nudeln       | Tomatensosse
Tomatensosse | Brot
 
BEZEICHNUNG  | BEZEICHNUNG
-------------+-------------
Tomatensosse | Fisch
Tomatensosse | Milch
Tomatensosse | Nudeln
Tomatensosse | Tomatensosse
 
resultcount :                    21
 
Enter command:
SELECT EINS.BEZEICHNUNG, ZWEI.BEZEICHNUNG
  FROM ARTIKEL EINS, ARTIKEL ZWEI,
       SCANNER_LINE SC1,  SCANNER_LINE SC2
 WHERE SC1.BON_ID = SC2.BON_ID
   AND SC1.ARTIKEL_NR  = EINS.ARTIKEL_NR
   AND SC2.ARTIKEL_NR  = ZWEI.ARTIKEL_NR
   AND EINS.ARTIKEL_NR < ZWEI.ARTIKEL_NR
GROUP BY EINS.BEZEICHNUNG, EINS.ARTIKEL_NR,
         ZWEI.BEZEICHNUNG, ZWEI.ARTIKEL_NR
HAVING COUNT(*) >
           (SELECT 0.5 * COUNT(DISTINCT SC.BON_ID)
              FROM SCANNER_LINE SC
             WHERE SC.ARTIKEL_NR IN (EINS.ARTIKEL_NR, ZWEI.ARTIKEL_NR))
!
 
resultcount :                     2
 
Enter command:
FETCH INTO :A, :B !
 
BEZEICHNUNG  | BEZEICHNUNG
-------------+-------------
Fisch        | Milch
Nudeln       | Tomatensosse
 
resultcount :                     2
 
Enter command:
SELECT EINS.BEZEICHNUNG, ZWEI.BEZEICHNUNG
  FROM ARTIKEL EINS, ARTIKEL ZWEI,
       SCANNER_LINE SC1,  SCANNER_LINE SC2
 WHERE SC1.BON_ID = SC2.BON_ID
   AND SC1.ARTIKEL_NR  = EINS.ARTIKEL_NR
   AND SC2.ARTIKEL_NR  = ZWEI.ARTIKEL_NR
   AND EINS.ARTIKEL_NR < ZWEI.ARTIKEL_NR
GROUP BY EINS.BEZEICHNUNG, EINS.ARTIKEL_NR,
         ZWEI.BEZEICHNUNG, ZWEI.ARTIKEL_NR
HAVING COUNT(*) * 3 >
           (SELECT COUNT(SC.BON_ID)
              FROM SCANNER_LINE SC
             WHERE SC.ARTIKEL_NR IN (EINS.ARTIKEL_NR, ZWEI.ARTIKEL_NR))
!
 
resultcount :                     2
 
Enter command:
FETCH INTO :A, :B !
 
BEZEICHNUNG  | BEZEICHNUNG
-------------+-------------
Fisch        | Milch
Nudeln       | Tomatensosse
 
resultcount :                     2
 
Enter command:
DROP TABLE ARTIKEL !
 
Enter command:
DROP TABLE SCANNER_HEADER !
 
Enter command:
DROP TABLE SCANNER_LINE !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST SQLMODE INTERNAL !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE INTERNAL ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE ZAEHLUNGEN (
ZAEHLUNGS_ID   INTEGER,
TIER           VARCHAR (30),
ANZAHL         INTEGER NOT NULL,
PRIMARY KEY (ZAEHLUNGS_ID, TIER))!
 
Enter command:
INSERT INTO ZAEHLUNGEN VALUES (1, 'Frosch    ', 12)!
 
Enter command:
INSERT INTO ZAEHLUNGEN VALUES (1, 'Kaulquappe', 16)!
 
Enter command:
INSERT INTO ZAEHLUNGEN VALUES (1, 'Lurch     ', 10)!
 
Enter command:
INSERT INTO ZAEHLUNGEN VALUES (2, 'Frosch    ',  2)!
 
Enter command:
INSERT INTO ZAEHLUNGEN VALUES (2, 'Lurch     ',  1)!
 
Enter command:
INSERT INTO ZAEHLUNGEN VALUES (2, 'Kroete    ',  3)!
 
Enter command:
INSERT INTO ZAEHLUNGEN VALUES (3, 'Frosch    ',  3)!
 
Enter command:
CREATE TABLE ZAEHLUNGSGRUPPEN (
GRUPPEN_ID    INTEGER,
ZAEHLUNGS_ID  INTEGER,
PRIMARY KEY (GRUPPEN_ID, ZAEHLUNGS_ID))!
 
Enter command:
INSERT INTO ZAEHLUNGSGRUPPEN VALUES (1,1)!
 
Enter command:
INSERT INTO ZAEHLUNGSGRUPPEN VALUES (1,2)!
 
Enter command:
INSERT INTO ZAEHLUNGSGRUPPEN VALUES (2,1)!
 
Enter command:
INSERT INTO ZAEHLUNGSGRUPPEN VALUES (2,3)!
 
Enter command:
INSERT INTO ZAEHLUNGSGRUPPEN VALUES (3,3)!
 
Enter command:
SELECT TIER, FIXED(SUM(ANZAHL) / X.NR, 4,1)
  FROM (SELECT COUNT(GRUPPEN_ID) NR
          FROM ZAEHLUNGSGRUPPEN
         WHERE GRUPPEN_ID = 1) X,
       ZAEHLUNGEN Z,
       ZAEHLUNGSGRUPPEN ZG
 WHERE ZG.GRUPPEN_ID = 1
   AND ZG.ZAEHLUNGS_ID = Z.ZAEHLUNGS_ID
GROUP BY TIER, X.NR !
 
resultcount :                     4
 
Enter command:
FETCH INTO :A, :B!
 
TIER                           | EXPRESSION1
-------------------------------+------------
Frosch                         |    7.0
Kaulquappe                     |    8.0
Kroete                         |    1.5
Lurch                          |    5.5
 
resultcount :                     4
 
Enter command:
DROP TABLE ZAEHLUNGEN !
 
Enter command:
DROP TABLE ZAEHLUNGSGRUPPEN !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST SQLMODE INTERNAL !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE INTERNAL ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE PATIENTEN (
ID      INTEGER PRIMARY KEY,
NAME    VARCHAR (30))!
 
Enter command:
INSERT INTO PATIENTEN VALUES (1, 'Albrecht')!
 
Enter command:
INSERT INTO PATIENTEN VALUES (2, 'Ladewig')!
 
Enter command:
INSERT INTO PATIENTEN VALUES (3, 'Weiss')!
 
Enter command:
INSERT INTO PATIENTEN VALUES (4, 'Suhr')!
 
Enter command:
INSERT INTO PATIENTEN VALUES (5, 'Medinger')!
 
Enter command:
INSERT INTO PATIENTEN VALUES (6, 'Linke')!
 
Enter command:
CREATE TABLE MESSUNGEN (
ID    INTEGER REFERENCES PATIENTEN,
DATUM DATE,
WERT  FIXED(3,1) NOT NULL,
PRIMARY KEY (ID, DATUM))!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (1, '19960208', 38.4)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (2, '19960208', 36.7)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (3, '19960208', 37.5)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (6, '19960208', 40.7)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (5, '19960208', 39.5)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (4, '19960208', 40.8)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (1, '19960209', 40.6)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (6, '19960209', 37.3)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (5, '19960209', 41.8)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (4, '19960209', 38.7)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (3, '19960209', 42.2)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (2, '19960209', 38.1)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (1, '19960210', 40.5)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (6, '19960210', 38.1)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (5, '19960210', 37.5)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (4, '19960210', 41.7)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (3, '19960210', 36.5)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (2, '19960210', 36.1)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (1, '19960211', 38.1)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (4, '19960211', 42.3)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (3, '19960211', 41.7)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (6, '19960211', 36.0)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (5, '19960211', 40.8)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (2, '19960211', 37.8)!
 
Enter command:
SELECT NAME, FIXED(AVG(M.WERT), 5, 3) AVG_WERT, MW.WERT
  FROM (SELECT WERT, ID, DATUM FROM MESSUNGEN ME1
         WHERE DATUM = (SELECT MAX(DATUM)
                          FROM MESSUNGEN ME2
                         WHERE ME2.ID = ME1.ID)
       ) MW,
                     PATIENTEN P, MESSUNGEN M
 WHERE P.ID  = M.ID
   AND MW.ID = M.ID
GROUP BY NAME, MW.WERT
HAVING MW.WERT > AVG(M.WERT) !
 
resultcount :                     4
 
Enter command:
FETCH INTO :A, :B, :C !
 
NAME                           | AVG_WERT | WERT
-------------------------------+----------+------
Ladewig                        |  37.175  |  37.8
Medinger                       |  39.900  |  40.8
Suhr                           |  40.875  |  42.3
Weiss                          |  39.475  |  41.7
 
resultcount :                     4
 
Enter command:
SELECT P.NAME, AVG (M1.WERT) AVG_WERT, M2.WERT
  FROM PATIENTEN P, MESSUNGEN M1, MESSUNGEN M2
 WHERE P.ID = M1.ID
   AND P.ID = M2.ID
   AND M2.DATUM = (SELECT MAX(MI.DATUM)
                     FROM MESSUNGEN MI
                    WHERE MI.ID = M2.ID)
GROUP BY P.NAME, M2.WERT
HAVING M2.WERT > AVG (M1.WERT)!
 
resultcount :                     4
 
Enter command:
FETCH INTO :A, :B, :C !
 
NAME              :  Ladewig
AVG_WERT          :   3.7175000000000000000000000000000000000E+01
WERT              :   37.8
-----------------------------------------------------------------
NAME              :  Medinger
AVG_WERT          :   3.9900000000000000000000000000000000000E+01
WERT              :   40.8
-----------------------------------------------------------------
NAME              :  Suhr
AVG_WERT          :   4.0875000000000000000000000000000000000E+01
WERT              :   42.3
-----------------------------------------------------------------
NAME              :  Weiss
AVG_WERT          :   3.9475000000000000000000000000000000000E+01
WERT              :   41.7
 
resultcount :                     4
 
Enter command:
SELECT P.NAME, MESS.AVG_WERT, M.WERT
  FROM PATIENTEN P, MESSUNGEN M,
       (SELECT MAV.ID, AVG(MAV.WERT) AVG_WERT,
                       MAX(MAV.DATUM) MAX_DATUM
          FROM MESSUNGEN MAV
        GROUP BY MAV.ID) MESS
 WHERE P.ID = M.ID
   AND P.ID = MESS.ID
   AND M.DATUM = MESS.MAX_DATUM
   AND M.WERT > MESS.AVG_WERT !
 
resultcount :                     4
 
Enter command:
FETCH INTO :A, :B, :C !
 
NAME              :  Ladewig
AVG_WERT          :   3.7175000000000000000000000000000000000E+01
WERT              :   37.8
-----------------------------------------------------------------
NAME              :  Weiss
AVG_WERT          :   3.9475000000000000000000000000000000000E+01
WERT              :   41.7
-----------------------------------------------------------------
NAME              :  Suhr
AVG_WERT          :   4.0875000000000000000000000000000000000E+01
WERT              :   42.3
-----------------------------------------------------------------
NAME              :  Medinger
AVG_WERT          :   3.9900000000000000000000000000000000000E+01
WERT              :   40.8
 
resultcount :                     4
 
Enter command:
DROP TABLE PATIENTEN !
 
Enter command:
DROP TABLE MESSUNGEN!
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST SQLMODE ORACLE !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE ORACLE ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE FLUGPLAN
 (FLUG_NR VARCHAR(10) CONSTRAINT FLUGPLAN_PK PRIMARY KEY,
  AB_ORT  VARCHAR(30) NOT NULL,
  AN_ORT  VARCHAR(30) NOT NULL)!
 
Enter command:
INSERT INTO FLUGPLAN VALUES ('IT001', 'Hamburg  ', 'Berlin   ')!
 
Enter command:
INSERT INTO FLUGPLAN VALUES ('IT002', 'Berlin   ', 'Hamburg  ')!
 
Enter command:
INSERT INTO FLUGPLAN VALUES ('IT003', 'Hamburg  ', 'Berlin   ')!
 
Enter command:
INSERT INTO FLUGPLAN VALUES ('IT004', 'Berlin   ', 'Hamburg  ')!
 
Enter command:
INSERT INTO FLUGPLAN VALUES ('IT005', 'Hamburg  ', 'Bremen   ')!
 
Enter command:
INSERT INTO FLUGPLAN VALUES ('IT006', 'Bremen   ', 'Hamburg  ')!
 
Enter command:
INSERT INTO FLUGPLAN VALUES ('IT007', 'Bremen   ', 'Berlin   ')!
 
Enter command:
INSERT INTO FLUGPLAN VALUES ('IT008', 'Berlin   ', 'Bremen   ')!
 
Enter command:
INSERT INTO FLUGPLAN VALUES ('IT009', 'Bremen   ', 'Frankfurt')!
 
Enter command:
INSERT INTO FLUGPLAN VALUES ('IT010', 'Frankfurt', 'Bremen   ')!
 
Enter command:
CREATE TABLE FLUG
 (FLUG_NR  VARCHAR(10) CONSTRAINT FLUGPLAN_FK REFERENCES FLUGPLAN,
  DATUM    DATE,
  PERSONEN NUMBER NOT NULL,
      CONSTRAINT FLUG_PK PRIMARY KEY (FLUG_NR, DATUM)) !
 
Enter command:
INSERT INTO FLUG VALUES ('IT001', '20-APR-96',  60)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT002', '20-APR-96',  72)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT003', '20-APR-96',  37)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT004', '20-APR-96',  61)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT005', '20-APR-96',  38)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT006', '20-APR-96',  21)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT007', '20-APR-96',  63)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT008', '20-APR-96',  58)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT009', '20-APR-96',  59)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT010', '20-APR-96',  66)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT001', '21-APR-96',  55)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT002', '21-APR-96',  26)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT003', '21-APR-96',  68)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT004', '21-APR-96',  67)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT005', '21-APR-96',  23)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT006', '21-APR-96',  50)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT007', '21-APR-96',  34)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT008', '21-APR-96',  32)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT009', '21-APR-96',  44)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT010', '21-APR-96',  70)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT001', '22-APR-96',  47)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT002', '22-APR-96',  91)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT003', '22-APR-96',  34)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT004', '22-APR-96', 122)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT005', '22-APR-96', 109)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT006', '22-APR-96', 118)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT007', '22-APR-96',  26)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT008', '22-APR-96',  79)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT009', '22-APR-96',  31)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT010', '22-APR-96', 128)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT001', '23-APR-96',  82)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT002', '23-APR-96',  63)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT003', '23-APR-96',  70)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT004', '23-APR-96',  32)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT005', '23-APR-96',  91)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT006', '23-APR-96',  34)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT007', '23-APR-96',  74)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT008', '23-APR-96',  69)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT009', '23-APR-96',  90)!
 
Enter command:
INSERT INTO FLUG VALUES ('IT010', '23-APR-96',  66)!
 
Enter command:
SELECT SUBSTR(AB_ORT, 1, 10), DATUM, SUM(PERSONEN) SUMME_S
  FROM FLUGPLAN FP, FLUG F
 WHERE FP.FLUG_NR = F.FLUG_NR
GROUP BY AB_ORT, DATUM
HAVING (AB_ORT, SUM(PERSONEN)) = ANY
   (SELECT AB_ORT, MIN(SUM_P)
      FROM
          (SELECT AB_ORT, SUM(PERSONEN) SUM_P
             FROM FLUGPLAN FP1, FLUG F1
            WHERE FP1.FLUG_NR = F1.FLUG_NR
           GROUP BY AB_ORT, DATUM) S
      GROUP BY AB_ORT
   )!
 
resultcount :                     0
 
Enter command:
FETCH INTO :A, :B, :C !
 
EXPRESSION1       :  Berlin
DATUM             :  21-APR-96
SUMME_S           :   1.2500000000000000000000000000000000000E+02
-----------------------------------------------------------------
EXPRESSION1       :  Bremen
DATUM             :  21-APR-96
SUMME_S           :   1.2800000000000000000000000000000000000E+02
-----------------------------------------------------------------
EXPRESSION1       :  Frankfurt
DATUM             :  20-APR-96
SUMME_S           :   6.6000000000000000000000000000000000000E+01
-----------------------------------------------------------------
EXPRESSION1       :  Frankfurt
DATUM             :  23-APR-96
SUMME_S           :   6.6000000000000000000000000000000000000E+01
-----------------------------------------------------------------
EXPRESSION1       :  Hamburg
DATUM             :  20-APR-96
SUMME_S           :   1.3500000000000000000000000000000000000E+02
 
resultcount :                     5
 
Enter command:
SELECT SUBSTR(AB_ORT, 1, 10), DATUM, SUM(PERSONEN) SUMME_S
  FROM FLUGPLAN FP, FLUG F
 WHERE FP.FLUG_NR = F.FLUG_NR
GROUP BY AB_ORT, DATUM
HAVING (AB_ORT, SUM(PERSONEN)) IN
   (SELECT AB_ORT, MIN(SUM_P)
      FROM
          (SELECT AB_ORT, SUM(PERSONEN) SUM_P
             FROM FLUGPLAN FP1, FLUG F1
            WHERE FP1.FLUG_NR = F1.FLUG_NR
           GROUP BY AB_ORT, DATUM) S
      GROUP BY AB_ORT
   )!
 
resultcount :                     0
 
Enter command:
FETCH INTO :A, :B, :C !
 
EXPRESSION1       :  Berlin
DATUM             :  21-APR-96
SUMME_S           :   1.2500000000000000000000000000000000000E+02
-----------------------------------------------------------------
EXPRESSION1       :  Bremen
DATUM             :  21-APR-96
SUMME_S           :   1.2800000000000000000000000000000000000E+02
-----------------------------------------------------------------
EXPRESSION1       :  Frankfurt
DATUM             :  20-APR-96
SUMME_S           :   6.6000000000000000000000000000000000000E+01
-----------------------------------------------------------------
EXPRESSION1       :  Frankfurt
DATUM             :  23-APR-96
SUMME_S           :   6.6000000000000000000000000000000000000E+01
-----------------------------------------------------------------
EXPRESSION1       :  Hamburg
DATUM             :  20-APR-96
SUMME_S           :   1.3500000000000000000000000000000000000E+02
 
resultcount :                     5
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST SQLMODE ANSI !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE ANSI ISOLATION LEVEL 1 !
 
Enter command:
DECLARE C CURSOR FOR
SELECT AB_ORT, DATUM, SUM(PERSONEN) SUMME_S
  FROM FLUGPLAN FP, FLUG F
 WHERE FP.FLUG_NR = F.FLUG_NR
GROUP BY AB_ORT, DATUM
HAVING SUM(PERSONEN) <= ALL
   (SELECT SUM(FI.PERSONEN)
      FROM FLUGPLAN FPI, FLUG FI
     WHERE FPI.FLUG_NR = FI.FLUG_NR
       AND FPI.AB_ORT = MIN(FP.AB_ORT)
    GROUP BY DATUM )
   !
 
resultcount :                     5
 
Enter command:
FETCH C INTO :A, :B, :C !
 
AB_ORT            :  Berlin
DATUM             :  YYYY-MM-DD 00:00:00.000000
SUMME_S           :   1.2500000000000000000000000000000000000E+02
-----------------------------------------------------------------
AB_ORT            :  Bremen
DATUM             :  YYYY-MM-DD 00:00:00.000000
SUMME_S           :   1.2800000000000000000000000000000000000E+02
-----------------------------------------------------------------
AB_ORT            :  Frankfurt
DATUM             :  YYYY-MM-DD 00:00:00.000000
SUMME_S           :   6.6000000000000000000000000000000000000E+01
-----------------------------------------------------------------
AB_ORT            :  Frankfurt
DATUM             :  YYYY-MM-DD 00:00:00.000000
SUMME_S           :   6.6000000000000000000000000000000000000E+01
-----------------------------------------------------------------
AB_ORT            :  Hamburg
DATUM             :  YYYY-MM-DD 00:00:00.000000
SUMME_S           :   1.3500000000000000000000000000000000000E+02
 
resultcount :                     5
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
FILE CONNECT ( KERN TEST SQLMODE ORACLE !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE ORACLE ISOLATION LEVEL 1 !
 
Enter command:
DECLARE C CURSOR FOR
SELECT AB_ORT, DATUM, SUM(PERSONEN) SUMME_S
  FROM FLUGPLAN FP, FLUG F
 WHERE FP.FLUG_NR = F.FLUG_NR
GROUP BY AB_ORT, DATUM
HAVING SUM(PERSONEN) <= ALL
   (SELECT SUM(FI.PERSONEN)
      FROM FLUGPLAN FPI, FLUG FI
     WHERE FPI.FLUG_NR = FI.FLUG_NR
       AND FPI.AB_ORT = FP.AB_ORT
    GROUP BY DATUM )
   !
 
resultcount :                     0
 
Enter command:
FETCH C INTO :A, :B, :C !
 
AB_ORT            :  Berlin
DATUM             :  21-APR-96
SUMME_S           :   1.2500000000000000000000000000000000000E+02
-----------------------------------------------------------------
AB_ORT            :  Bremen
DATUM             :  21-APR-96
SUMME_S           :   1.2800000000000000000000000000000000000E+02
-----------------------------------------------------------------
AB_ORT            :  Frankfurt
DATUM             :  20-APR-96
SUMME_S           :   6.6000000000000000000000000000000000000E+01
-----------------------------------------------------------------
AB_ORT            :  Frankfurt
DATUM             :  23-APR-96
SUMME_S           :   6.6000000000000000000000000000000000000E+01
-----------------------------------------------------------------
AB_ORT            :  Hamburg
DATUM             :  20-APR-96
SUMME_S           :   1.3500000000000000000000000000000000000E+02
 
resultcount :                     5
 
Enter command:
DECLARE C CURSOR FOR
SELECT SUBSTR(AB_ORT, 1, 10), DATUM, SUM(PERSONEN) SUMME_S
  FROM FLUGPLAN FP, FLUG F
 WHERE FP.FLUG_NR = F.FLUG_NR
GROUP BY AB_ORT, DATUM
HAVING SUM(PERSONEN) <= ALL
   (SELECT SUM(FI.PERSONEN)
      FROM FLUGPLAN FPI, FLUG FI
     WHERE FPI.FLUG_NR = FI.FLUG_NR
       AND FPI.AB_ORT = FP.AB_ORT
    GROUP BY DATUM )
   !
 
resultcount :                     0
 
Enter command:
FETCH C INTO :A, :B, :C !
 
EXPRESSION1       :  Berlin
DATUM             :  21-APR-96
SUMME_S           :   1.2500000000000000000000000000000000000E+02
-----------------------------------------------------------------
EXPRESSION1       :  Bremen
DATUM             :  21-APR-96
SUMME_S           :   1.2800000000000000000000000000000000000E+02
-----------------------------------------------------------------
EXPRESSION1       :  Frankfurt
DATUM             :  20-APR-96
SUMME_S           :   6.6000000000000000000000000000000000000E+01
-----------------------------------------------------------------
EXPRESSION1       :  Frankfurt
DATUM             :  23-APR-96
SUMME_S           :   6.6000000000000000000000000000000000000E+01
-----------------------------------------------------------------
EXPRESSION1       :  Hamburg
DATUM             :  20-APR-96
SUMME_S           :   1.3500000000000000000000000000000000000E+02
 
resultcount :                     5
 
Enter command:
DROP TABLE FLUGPLAN!
 
Enter command:
DROP TABLE FLUG !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST SQLMODE ORACLE !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE ORACLE ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE ABTEILUNGEN (
ABT_NR      NUMBER  ( 3) CONSTRAINT ABTEILUNGEN_PK PRIMARY KEY,
BEZEICHNUNG VARCHAR (20) NOT NULL) !
 
Enter command:
INSERT INTO ABTEILUNGEN VALUES (10, 'EDV      ')!
 
Enter command:
INSERT INTO ABTEILUNGEN VALUES (20, 'Vertrieb ')!
 
Enter command:
INSERT INTO ABTEILUNGEN VALUES (30, 'Marketing')!
 
Enter command:
INSERT INTO ABTEILUNGEN VALUES (40, 'Personal ')!
 
Enter command:
CREATE TABLE ANGESTELLTE (
MA_NR       NUMBER   (3) CONSTRAINT ANGESTELLTE_PK PRIMARY KEY,
NAME        VARCHAR (30) NOT NULL,
POSITION    VARCHAR (30),
ABT_NR      NUMBER  ( 3) CONSTRAINT ANGESTELLTE_FK_ABT
                               REFERENCES ABTEILUNGEN) !
 
Enter command:
INSERT INTO ANGESTELLTE VALUES ( 1, 'Moeller', 'Systemanalytiker', 10)!
 
Enter command:
INSERT INTO ANGESTELLTE VALUES ( 2, 'Meyer  ', 'EDV-Spezialist  ', 10)!
 
Enter command:
INSERT INTO ANGESTELLTE VALUES ( 5, 'Chall  ', 'Verkaeufer      ', 20)!
 
Enter command:
INSERT INTO ANGESTELLTE VALUES ( 6, 'Kunze  ', NULL              , 20)!
 
Enter command:
INSERT INTO ANGESTELLTE VALUES ( 7, 'Peter  ', 'Verkaeuferin    ', 20)!
 
Enter command:
INSERT INTO ANGESTELLTE VALUES ( 8, 'Hagner ', 'EDV-Spezialist  ',NULL)!
 
Enter command:
INSERT INTO ANGESTELLTE VALUES ( 9, 'Hansen ', 'Berater         ', 30)!
 
Enter command:
INSERT INTO ANGESTELLTE VALUES (10, 'Klasen ', 'EDV-Spezialist  ', 30)!
 
Enter command:
INSERT INTO ANGESTELLTE VALUES (12, 'Bauer  ', 'Sachbearbeiter  ', 40)!
 
Enter command:
CREATE TABLE KURSE (
KURS_NR     NUMBER  ( 3) CONSTRAINT KURS_PK PRIMARY KEY,
BEZEICHNUNG VARCHAR (20) NOT NULL) !
 
Enter command:
INSERT INTO KURSE VALUES (10, 'Rhetorik')!
 
Enter command:
INSERT INTO KURSE VALUES (20, 'SQL     ')!
 
Enter command:
CREATE TABLE KURSTEILNEHMER (
KURS_NR     NUMBER  ( 3) CONSTRAINT KTN_FK_KURS
                                 REFERENCES KURSE,
MA_NR       NUMBER  ( 3) CONSTRAINT KTN_FK_MA
                                 REFERENCES ANGESTELLTE,
DATUM       DATE,
CONSTRAINT KURSTEILNEHMER_PK PRIMARY KEY (KURS_NR, MA_NR, DATUM)) !
 
Enter command:
INSERT INTO KURSTEILNEHMER VALUES (10,  1, '20-NOV-95')!
 
Enter command:
INSERT INTO KURSTEILNEHMER VALUES (10,  5, '20-OCT-95')!
 
Enter command:
INSERT INTO KURSTEILNEHMER VALUES (10,  6, '20-DEC-95')!
 
Enter command:
INSERT INTO KURSTEILNEHMER VALUES (10, 10, '20-SEP-95')!
 
Enter command:
INSERT INTO KURSTEILNEHMER VALUES (10,  9, '20-NOV-95')!
 
Enter command:
INSERT INTO KURSTEILNEHMER VALUES (20,  2, '10-MAY-95')!
 
Enter command:
INSERT INTO KURSTEILNEHMER VALUES (20,  8, '11-JUL-95')!
 
Enter command:
INSERT INTO KURSTEILNEHMER VALUES (20,  6, '02-FEB-96')!
 
Enter command:
INSERT INTO KURSTEILNEHMER VALUES (20,  7, '20-APR-96')!
 
Enter command:
SELECT BEZEICHNUNG
  FROM ABTEILUNGEN
 WHERE ABT_NR NOT IN
          (SELECT ABT_NR
             FROM KURSTEILNEHMER KT,
                  KURSE K,
                  ANGESTELLTE A
            WHERE K.BEZEICHNUNG = 'SQL'
              AND K.KURS_NR     = KT.KURS_NR
              AND KT.MA_NR      = A.MA_NR
              AND A.ABT_NR IS NOT NULL
          ) !
 
resultcount :                     0
 
Enter command:
FETCH INTO :A !
 
BEZEICHNUNG
--------------------
Marketing
Personal
 
resultcount :                     2
 
Enter command:
SELECT BEZEICHNUNG
  FROM ABTEILUNGEN
 WHERE NOT EXISTS
          (SELECT 'a'
             FROM KURSTEILNEHMER KT,
                  KURSE K,
                  ANGESTELLTE A
            WHERE K.BEZEICHNUNG = 'SQL'
              AND K.KURS_NR     = KT.KURS_NR
              AND KT.MA_NR      = A.MA_NR
              AND A.ABT_NR      = ABTEILUNGEN.ABT_NR )!
 
resultcount :                     0
 
Enter command:
FETCH INTO :A !
 
BEZEICHNUNG
--------------------
Marketing
Personal
 
resultcount :                     2
 
Enter command:
DROP TABLE ABTEILUNGEN !
 
Enter command:
DROP TABLE ANGESTELLTE !
 
Enter command:
DROP TABLE KURSE !
 
Enter command:
DROP TABLE KURSTEILNEHMER !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST   ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE PERSONAL (
PERS_NO FIXED (3) PRIMARY KEY,
NAME VARCHAR (10) NOT NULL)!
 
Enter command:
INSERT INTO PERSONAL VALUES (1, 'Gehner')!
 
Enter command:
INSERT INTO PERSONAL VALUES (2, 'Jonas')!
 
Enter command:
INSERT INTO PERSONAL VALUES (3, 'Hansen')!
 
Enter command:
INSERT INTO PERSONAL VALUES (4, 'Clausen')!
 
Enter command:
CREATE TABLE PRAEMIE (
PR_ID        FIXED (3) PRIMARY KEY,
BESCHREIBUNG VARCHAR (10) NOT NULL,
WERT         FIXED (10) NOT NULL)!
 
Enter command:
INSERT INTO PRAEMIE VALUES (2, 'Restaurant',   200)!
 
Enter command:
INSERT INTO PRAEMIE VALUES (3, '1100 DM   ',  1100)!
 
Enter command:
INSERT INTO PRAEMIE VALUES (4, '3100 DM   ',  3100)!
 
Enter command:
INSERT INTO PRAEMIE VALUES (5, '1000 DM   ',  1000)!
 
Enter command:
INSERT INTO PRAEMIE VALUES (6, '3000 DM   ',  3000)!
 
Enter command:
INSERT INTO PRAEMIE VALUES (1, 'Reise     ', 10000)!
 
Enter command:
CREATE TABLE ZIEL (
ZIEL_ID      FIXED (3) PRIMARY KEY,
BESCHREIBUNG VARCHAR(10) NOT NULL)!
 
Enter command:
INSERT INTO ZIEL VALUES (1, '80% Umsatz')!
 
Enter command:
INSERT INTO ZIEL VALUES (2, '90% Umsatz')!
 
Enter command:
INSERT INTO ZIEL VALUES (3, '100% Ums. ')!
 
Enter command:
INSERT INTO ZIEL VALUES (4, '120% Ums. ')!
 
Enter command:
INSERT INTO ZIEL VALUES (5, '5 neue Kd.')!
 
Enter command:
INSERT INTO ZIEL VALUES (6, '10 neu Kd.')!
 
Enter command:
INSERT INTO ZIEL VALUES (7, 'Kurs 1    ')!
 
Enter command:
INSERT INTO ZIEL VALUES (8, 'Kurs 2    ')!
 
Enter command:
INSERT INTO ZIEL VALUES (9, 'Gr. Auftr.')!
 
Enter command:
COMMIT !
 
Enter command:
CREATE TABLE ERREICHTES_ZIEL (
PERS_NO    FIXED (3) REFERENCES PERSONAL,
ZIEL_ID    FIXED (3) REFERENCES ZIEL,
PRIMARY KEY (PERS_NO, ZIEL_ID))!
 
Enter command:
INSERT INTO ERREICHTES_ZIEL VALUES (4, 1)!
 
Enter command:
INSERT INTO ERREICHTES_ZIEL VALUES (3, 1)!
 
Enter command:
INSERT INTO ERREICHTES_ZIEL VALUES (2, 1)!
 
Enter command:
INSERT INTO ERREICHTES_ZIEL VALUES (1, 1)!
 
Enter command:
INSERT INTO ERREICHTES_ZIEL VALUES (4, 2)!
 
Enter command:
INSERT INTO ERREICHTES_ZIEL VALUES (3, 2)!
 
Enter command:
INSERT INTO ERREICHTES_ZIEL VALUES (2, 2)!
 
Enter command:
INSERT INTO ERREICHTES_ZIEL VALUES (1, 2)!
 
Enter command:
INSERT INTO ERREICHTES_ZIEL VALUES (4, 3)!
 
Enter command:
INSERT INTO ERREICHTES_ZIEL VALUES (3, 3)!
 
Enter command:
INSERT INTO ERREICHTES_ZIEL VALUES (1, 3)!
 
Enter command:
INSERT INTO ERREICHTES_ZIEL VALUES (1, 4)!
 
Enter command:
INSERT INTO ERREICHTES_ZIEL VALUES (4, 5)!
 
Enter command:
INSERT INTO ERREICHTES_ZIEL VALUES (3, 5)!
 
Enter command:
INSERT INTO ERREICHTES_ZIEL VALUES (2, 5)!
 
Enter command:
INSERT INTO ERREICHTES_ZIEL VALUES (1, 5)!
 
Enter command:
INSERT INTO ERREICHTES_ZIEL VALUES (2, 6)!
 
Enter command:
INSERT INTO ERREICHTES_ZIEL VALUES (1, 6)!
 
Enter command:
INSERT INTO ERREICHTES_ZIEL VALUES (4, 7)!
 
Enter command:
INSERT INTO ERREICHTES_ZIEL VALUES (2, 7)!
 
Enter command:
INSERT INTO ERREICHTES_ZIEL VALUES (1, 7)!
 
Enter command:
INSERT INTO ERREICHTES_ZIEL VALUES (3, 8)!
 
Enter command:
INSERT INTO ERREICHTES_ZIEL VALUES (1, 8)!
 
Enter command:
INSERT INTO ERREICHTES_ZIEL VALUES (4, 9)!
 
Enter command:
INSERT INTO ERREICHTES_ZIEL VALUES (1, 9)!
 
Enter command:
CREATE TABLE NOTWENDIGES_ZIEL (
PR_ID     FIXED (3) REFERENCES PRAEMIE,
ZIEL_ID   FIXED (3) REFERENCES ZIEL,
PRIMARY KEY (PR_ID, ZIEL_ID))!
 
Enter command:
INSERT NOTWENDIGES_ZIEL VALUES (2, 1)!
 
Enter command:
INSERT NOTWENDIGES_ZIEL VALUES (2, 5)!
 
Enter command:
INSERT NOTWENDIGES_ZIEL VALUES (2, 7)!
 
Enter command:
INSERT NOTWENDIGES_ZIEL VALUES (3, 2)!
 
Enter command:
INSERT NOTWENDIGES_ZIEL VALUES (3, 5)!
 
Enter command:
INSERT NOTWENDIGES_ZIEL VALUES (3, 7)!
 
Enter command:
INSERT NOTWENDIGES_ZIEL VALUES (5, 1)!
 
Enter command:
INSERT NOTWENDIGES_ZIEL VALUES (5, 6)!
 
Enter command:
INSERT NOTWENDIGES_ZIEL VALUES (5, 8)!
 
Enter command:
INSERT NOTWENDIGES_ZIEL VALUES (4, 3)!
 
Enter command:
INSERT NOTWENDIGES_ZIEL VALUES (4, 5)!
 
Enter command:
INSERT NOTWENDIGES_ZIEL VALUES (4, 7)!
 
Enter command:
INSERT NOTWENDIGES_ZIEL VALUES (6, 2)!
 
Enter command:
INSERT NOTWENDIGES_ZIEL VALUES (6, 6)!
 
Enter command:
INSERT NOTWENDIGES_ZIEL VALUES (6, 8)!
 
Enter command:
INSERT NOTWENDIGES_ZIEL VALUES (6, 9)!
 
Enter command:
INSERT NOTWENDIGES_ZIEL VALUES (1, 4)!
 
Enter command:
INSERT NOTWENDIGES_ZIEL VALUES (1, 6)!
 
Enter command:
INSERT NOTWENDIGES_ZIEL VALUES (1, 8)!
 
Enter command:
INSERT NOTWENDIGES_ZIEL VALUES (1, 9)!
 
Enter command:
COMMIT !
 
Enter command:
SELECT NAME, BESCHREIBUNG, WERT
FROM PERSONAL, PRAEMIE
WHERE WERT =
       (SELECT MAX(WERT)
         FROM PRAEMIE
        WHERE PR_ID IN
                  (SELECT PR_ID
                     FROM NOTWENDIGES_ZIEL
                    GROUP BY PR_ID
                   HAVING (PR_ID, COUNT(*)) IN
                               (SELECT PR_ID, COUNT(*)
                                  FROM NOTWENDIGES_ZIEL NZ,
                                       ERREICHTES_ZIEL EZ
                                 WHERE NZ.ZIEL_ID = EZ.ZIEL_ID
                                   AND EZ.PERS_NO = PERSONAL.PERS_NO
                                 GROUP BY PR_ID
                               )
                  )
       )
ORDER BY WERT !
 
resultcount :                     3
 
Enter command:
FETCH INTO :A, :B, :C !
 
NAME       | BESCHREIBUNG | WERT
-----------+--------------+------------
Jonas      | 1100 DM      |        1100
Clausen    | 3100 DM      |        3100
Gehner     | Reise        |       10000
 
resultcount :                     3
 
Enter command:
SELECT NAME, BESCHREIBUNG, WERT
FROM PERSONAL, PRAEMIE
WHERE WERT =
       (SELECT MAX(WERT)
         FROM PRAEMIE
        WHERE PR_ID IN
                  (SELECT PR_ID
                     FROM NOTWENDIGES_ZIEL
                    GROUP BY PR_ID
                   HAVING (PR_ID, COUNT(*)) IN
                               (SELECT PR_ID, COUNT(*)
                                  FROM NOTWENDIGES_ZIEL NZ,
                                       ERREICHTES_ZIEL EZ
                                 WHERE NZ.ZIEL_ID = EZ.ZIEL_ID
                                   AND EZ.PERS_NO = PERSONAL.PERS_NO
                                 GROUP BY PR_ID
                               )
                  )
       )
ORDER BY 3 !
 
resultcount :                     3
 
Enter command:
FETCH INTO :A, :B, :C !
 
NAME       | BESCHREIBUNG | WERT
-----------+--------------+------------
Jonas      | 1100 DM      |        1100
Clausen    | 3100 DM      |        3100
Gehner     | Reise        |       10000
 
resultcount :                     3
 
Enter command:
SELECT PE1.NAME,
       PR1.BESCHREIBUNG,
       PR1.WERT
  FROM PERSONAL PE1,
       PRAEMIE PR1
 WHERE PR1.WERT IN
             (SELECT MAX (PR2.WERT)
                FROM PRAEMIE PR2
               WHERE PR2.PR_ID NOT IN
                      (SELECT NZ1.PR_ID
                         FROM NOTWENDIGES_ZIEL NZ1
                        WHERE NZ1.ZIEL_ID NOT IN
                              (SELECT EZ1.ZIEL_ID
                                 FROM ERREICHTES_ZIEL EZ1
                                WHERE EZ1.PERS_NO = PE1.PERS_NO
                              )
                       )
             )!
 
resultcount :                     3
 
Enter command:
FETCH INTO :A, :B, :C !
 
NAME       | BESCHREIBUNG | WERT
-----------+--------------+------------
Gehner     | Reise        |       10000
Jonas      | 1100 DM      |        1100
Clausen    | 3100 DM      |        3100
 
resultcount :                     3
 
Enter command:
DROP TABLE PERSONAL !
 
Enter command:
DROP TABLE PRAEMIE !
 
Enter command:
DROP TABLE ZIEL !
 
Enter command:
DROP TABLE ERREICHTES_ZIEL !
 
Enter command:
DROP TABLE NOTWENDIGES_ZIEL !
 
Enter command:
COMMIT RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST SQLMODE ORACLE!
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE ORACLE ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE KUNDEN (
KDNR NUMBER (6,0) CONSTRAINT KUNDEN_PK PRIMARY KEY,
NAME VARCHAR (30))!
 
Enter command:
INSERT INTO KUNDEN VALUES (1, 'Meyer    ')!
 
Enter command:
INSERT INTO KUNDEN VALUES (2, 'Schmidt  ')!
 
Enter command:
INSERT INTO KUNDEN VALUES (3, 'Clausen  ')!
 
Enter command:
INSERT INTO KUNDEN VALUES (4, 'Fischer  ')!
 
Enter command:
INSERT INTO KUNDEN VALUES (5, 'Feddersen')!
 
Enter command:
CREATE TABLE AUSGABEN (
TITEL VARCHAR (30) CONSTRAINT AUSGABEN_PK PRIMARY KEY,
DATUM DATE NOT NULL)!
 
Enter command:
INSERT INTO AUSGABEN VALUES ('7/96', '05-JUL-96')!
 
Enter command:
INSERT INTO AUSGABEN VALUES ('8/96', '05-AUG-96')!
 
Enter command:
INSERT INTO AUSGABEN VALUES ('9/96', '05-SEP-96')!
 
Enter command:
CREATE TABLE ANZEIGEN (
KDNR    NUMBER (6,0) CONSTRAINT ANZ_KD_FK REFERENCES KUNDEN,
TITEL   VARCHAR (30) CONSTRAINT ANZ_AUSG_FK REFERENCES AUSGABEN,
SEITE   NUMBER (3,0),
GROESSE NUMBER (3,2) CONSTRAINT GROESSE_CHECK
        CHECK (GROESSE > 0 AND GROESSE <= 1),
COLOR   CHAR (1) CONSTRAINT COLOR_CHECK CHECK (COLOR IN ('J','N')),
CONSTRAINT ANZEIGEN_PK PRIMARY KEY (KDNR, TITEL, SEITE))!
 
Enter command:
INSERT INTO ANZEIGEN VALUES (1, '7/96', 15, 0.50, 'J')!
 
Enter command:
INSERT INTO ANZEIGEN VALUES (2, '7/96', 22, 0.50, 'J')!
 
Enter command:
INSERT INTO ANZEIGEN VALUES (5, '7/96', 33, 1.00, 'N')!
 
Enter command:
INSERT INTO ANZEIGEN VALUES (3, '7/96', 41, 1.00, 'N')!
 
Enter command:
INSERT INTO ANZEIGEN VALUES (4, '7/96', 45, 1.00, 'N')!
 
Enter command:
INSERT INTO ANZEIGEN VALUES (4, '7/96', 46, 1.00, 'N')!
 
Enter command:
INSERT INTO ANZEIGEN VALUES (1, '8/96', 15, 0.50, 'J')!
 
Enter command:
INSERT INTO ANZEIGEN VALUES (2, '8/96', 22, 0.50, 'J')!
 
Enter command:
INSERT INTO ANZEIGEN VALUES (5, '8/96', 33, 1.00, 'N')!
 
Enter command:
INSERT INTO ANZEIGEN VALUES (1, '9/96', 15, 0.50, 'J')!
 
Enter command:
INSERT INTO ANZEIGEN VALUES (2, '9/96', 22, 1.00, 'N')!
 
Enter command:
INSERT INTO ANZEIGEN VALUES (5, '9/96', 33, 1.00, 'N')!
 
Enter command:
INSERT INTO ANZEIGEN VALUES (3, '9/96', 41, 1.00, 'J')!
 
Enter command:
SELECT KD.NAME
  FROM KUNDEN KD, ANZEIGEN AZ
 WHERE AZ.KDNR = KD.KDNR
GROUP BY KD.NAME
HAVING SUM (AZ.GROESSE * DECODE (AZ.COLOR, 'J', 2, 1)) >= 3 !
 
resultcount :                     0
 
Enter command:
FETCH INTO :A !
 
NAME
------------------------------
Clausen
Feddersen
Meyer
Schmidt
 
resultcount :                     4
 
Enter command:
SELECT KD.NAME
  FROM KUNDEN KD
 WHERE EXISTS
      (SELECT SUM (AZ_ALL.GROESSE),
              SUM (AZ_COL.GROESSE)
         FROM ANZEIGEN AZ_ALL, ANZEIGEN AZ_COL
        WHERE KD.KDNR        = AZ_ALL.KDNR
          AND AZ_ALL.KDNR    = AZ_COL.KDNR(+)
          AND AZ_ALL.TITEL   = AZ_COL.TITEL(+)
          AND AZ_ALL.SEITE   = AZ_COL.SEITE(+)
          AND AZ_COL.COLOR   = 'J'
        HAVING SUM (AZ_ALL.GROESSE) +
               SUM (AZ_COL.GROESSE) >= 3.0
            OR SUM (AZ_ALL.GROESSE) >= 3.0) !
 
resultcount :                     0
 
Enter command:
FETCH INTO :A !
 
NAME
------------------------------
Meyer
 
resultcount :                     1
 
Enter command:
DROP TABLE KUNDEN !
 
Enter command:
DROP TABLE AUSGABEN !
 
Enter command:
DROP TABLE ANZEIGEN!
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST   ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE BAHNHOF (
NAME              VARCHAR (10) PRIMARY KEY,
MIN_UMSTEIGE_ZEIT FIXED (5) NOT NULL)!
 
Enter command:
INSERT INTO BAHNHOF VALUES ('Muenchen' , 10)!
 
Enter command:
INSERT INTO BAHNHOF VALUES ('Hamburg ' , 10)!
 
Enter command:
INSERT INTO BAHNHOF VALUES ('Frankfurt', 15)!
 
Enter command:
CREATE TABLE ZUG (
NUMMER       VARCHAR (6) PRIMARY KEY,
VON_BAHNHOF  VARCHAR (10) REFERENCES BAHNHOF,
BIS_BAHNHOF  VARCHAR (10) REFERENCES BAHNHOF,
START_ZEIT   TIME NOT NULL,
ANKUNFT_ZEIT TIME NOT NULL,
PREIS        FIXED (6,2) NOT NULL)!
 
Enter command:
INSERT ZUG VALUES('ICE111','Muenchen ','Frankfurt','00090000','00130000',120)!
 
Enter command:
INSERT ZUG VALUES('IC121 ','Muenchen ','Frankfurt','00091000','00134000', 90)!
 
Enter command:
INSERT ZUG VALUES('ICE112','Muenchen ','Frankfurt','00102000','00141500',120)!
 
Enter command:
INSERT ZUG VALUES('IC122 ','Muenchen ','Frankfurt','00111100','00154000', 90)!
 
Enter command:
INSERT ZUG VALUES('ICE211','Frankfurt','Hamburg  ','00131000','00160000',100)!
 
Enter command:
INSERT ZUG VALUES('ICE113','Muenchen ','Frankfurt','00131200','00172000',120)!
 
Enter command:
INSERT ZUG VALUES('IC123 ','Muenchen ','Frankfurt','00132300','00180000', 90)!
 
Enter command:
INSERT ZUG VALUES('ICE124','Muenchen ','Frankfurt','00135000','00175000',120)!
 
Enter command:
INSERT ZUG VALUES('IC221 ','Frankfurt','Hamburg  ','00135000','00172000', 80)!
 
Enter command:
INSERT ZUG VALUES('ICE212','Frankfurt','Hamburg  ','00141000','00170000',100)!
 
Enter command:
INSERT ZUG VALUES('IC222 ','Frankfurt','Hamburg  ','00145000','00183000', 80)!
 
Enter command:
INSERT ZUG VALUES('IC223 ','Frankfurt','Hamburg  ','00171000','00204000', 80)!
 
Enter command:
INSERT ZUG VALUES('ICE213','Frankfurt','Hamburg  ','00173000','00204000',100)!
 
Enter command:
INSERT ZUG VALUES('IC224 ','Frankfurt','Hamburg  ','00182300','00220000', 80)!
 
Enter command:
INSERT ZUG VALUES('ICE214','Frankfurt','Hamburg  ','00190000','00220000',100)!
 
Enter command:
SELECT * FROM
(SELECT ZUG1.NUMMER NUM1,
       ZUG1.START_ZEIT START_M,
       ZUG1.ANKUNFT_ZEIT END_F,
       ZUG2.NUMMER NUM2,
       ZUG2.START_ZEIT START_F,
       ZUG2.ANKUNFT_ZEIT END_H,
       FIXED(HOUR  (ZUG2.ANKUNFT_ZEIT) * 60 +
       MINUTE(ZUG2.ANKUNFT_ZEIT)          -
       (HOUR (ZUG1.START_ZEIT) * 60 +
       MINUTE(ZUG1.START_ZEIT)), 3) DAUER,
       FIXED(ZUG1.PREIS + ZUG2.PREIS, 3) PREIS
  FROM ZUG ZUG1, ZUG ZUG2, BAHNHOF
 WHERE ZUG1.VON_BAHNHOF = 'Muenchen'
   AND (HOUR (ZUG1.ANKUNFT_ZEIT) * 60 +
       MINUTE(ZUG1.ANKUNFT_ZEIT)) + BAHNHOF.MIN_UMSTEIGE_ZEIT
         <= (HOUR(ZUG2.START_ZEIT) * 60 + MINUTE(ZUG2.START_ZEIT))
   AND ZUG2.VON_BAHNHOF = 'Frankfurt'
   AND ZUG1.BIS_BAHNHOF = BAHNHOF.NAME) XX
ORDER BY (DAUER+PREIS)
!
 
resultcount :                    28
 
Enter command:
FETCH INTO :A, :B, :C, :D, :E, :F, :G, :H!
 
NUM1   | START_M  | END_F    | NUM2   | START_F  | END_H    | DAUER | PREIS
-------+----------+----------+--------+----------+----------+-------+------
IC121  | TIMEYYYY | TIMEYYYY | ICE212 | TIMEYYYY | TIMEYYYY |  470  |  190
IC123  | TIMEYYYY | TIMEYYYY | IC224  | TIMEYYYY | TIMEYYYY |  517  |  170
ICE112 | TIMEYYYY | TIMEYYYY | IC222  | TIMEYYYY | TIMEYYYY |  490  |  200
ICE124 | TIMEYYYY | TIMEYYYY | IC224  | TIMEYYYY | TIMEYYYY |  490  |  200
ICE111 | TIMEYYYY | TIMEYYYY | IC221  | TIMEYYYY | TIMEYYYY |  500  |  200
ICE111 | TIMEYYYY | TIMEYYYY | ICE212 | TIMEYYYY | TIMEYYYY |  480  |  220
IC123  | TIMEYYYY | TIMEYYYY | ICE214 | TIMEYYYY | TIMEYYYY |  517  |  190
ICE124 | TIMEYYYY | TIMEYYYY | ICE214 | TIMEYYYY | TIMEYYYY |  490  |  220
ICE113 | TIMEYYYY | TIMEYYYY | IC224  | TIMEYYYY | TIMEYYYY |  528  |  200
IC121  | TIMEYYYY | TIMEYYYY | IC222  | TIMEYYYY | TIMEYYYY |  560  |  170
IC122  | TIMEYYYY | TIMEYYYY | IC223  | TIMEYYYY | TIMEYYYY |  569  |  170
ICE113 | TIMEYYYY | TIMEYYYY | ICE214 | TIMEYYYY | TIMEYYYY |  528  |  220
IC122  | TIMEYYYY | TIMEYYYY | ICE213 | TIMEYYYY | TIMEYYYY |  569  |  190
ICE111 | TIMEYYYY | TIMEYYYY | IC222  | TIMEYYYY | TIMEYYYY |  570  |  200
IC122  | TIMEYYYY | TIMEYYYY | IC224  | TIMEYYYY | TIMEYYYY |  649  |  170
ICE112 | TIMEYYYY | TIMEYYYY | IC223  | TIMEYYYY | TIMEYYYY |  620  |  200
IC122  | TIMEYYYY | TIMEYYYY | ICE214 | TIMEYYYY | TIMEYYYY |  649  |  190
 
NUM1   | START_M  | END_F    | NUM2   | START_F  | END_H    | DAUER | PREIS
-------+----------+----------+--------+----------+----------+-------+------
ICE112 | TIMEYYYY | TIMEYYYY | ICE213 | TIMEYYYY | TIMEYYYY |  620  |  220
IC121  | TIMEYYYY | TIMEYYYY | IC223  | TIMEYYYY | TIMEYYYY |  690  |  170
IC121  | TIMEYYYY | TIMEYYYY | ICE213 | TIMEYYYY | TIMEYYYY |  690  |  190
ICE111 | TIMEYYYY | TIMEYYYY | IC223  | TIMEYYYY | TIMEYYYY |  700  |  200
ICE112 | TIMEYYYY | TIMEYYYY | IC224  | TIMEYYYY | TIMEYYYY |  700  |  200
ICE111 | TIMEYYYY | TIMEYYYY | ICE213 | TIMEYYYY | TIMEYYYY |  700  |  220
ICE112 | TIMEYYYY | TIMEYYYY | ICE214 | TIMEYYYY | TIMEYYYY |  700  |  220
IC121  | TIMEYYYY | TIMEYYYY | IC224  | TIMEYYYY | TIMEYYYY |  770  |  170
IC121  | TIMEYYYY | TIMEYYYY | ICE214 | TIMEYYYY | TIMEYYYY |  770  |  190
ICE111 | TIMEYYYY | TIMEYYYY | IC224  | TIMEYYYY | TIMEYYYY |  780  |  200
ICE111 | TIMEYYYY | TIMEYYYY | ICE214 | TIMEYYYY | TIMEYYYY |  780  |  220
 
resultcount :                    28
 
Enter command:
COMMIT WORK RELEASE!
 
Enter command:
 
FILE CONNECT ( KERN TEST SQLMODE ORACLE !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE ORACLE ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE TABELLEN (
TABELLE      VARCHAR (30),
BESCHREIBUNG VARCHAR(100),
CONSTRAINT TABELLEN_PK PRIMARY KEY ( TABELLE))!
 
Enter command:
INSERT INTO TABELLEN VALUES ('Tabellen', 'Beschreibung aller Tabellen')!
 
Enter command:
INSERT INTO TABELLEN VALUES ('Spalten',
            'Beschreibung aller Tabellenspalten')!
 
Enter command:
INSERT INTO TABELLEN VALUES ('Indices', 'Beschreibung aller Indices')!
 
Enter command:
INSERT INTO TABELLEN VALUES ('Index_Spalten',
            'Beschreibung der Index Spalten')!
 
Enter command:
CREATE TABLE SPALTEN (
TABELLE    VARCHAR (30) CONSTRAINT SPTABFK
                              REFERENCES TABELLEN,
SPALTE     VARCHAR (30),
IS_KEY     VARCHAR(1) NOT NULL CONSTRAINT IS_KEY_CHECK
                              CHECK (IS_KEY IN ('Y', 'N')),
FREMDSCHL  VARCHAR (30) CONSTRAINT SPTABFK2
                              REFERENCES TABELLEN,
CONSTRAINT SPALTEN_PK PRIMARY KEY (TABELLE, SPALTE)) !
 
Enter command:
INSERT INTO SPALTEN VALUES ('Tabellen     ', 'Beschreibung', 'N', NULL)!
 
Enter command:
INSERT INTO SPALTEN VALUES ('Spalten      ', 'Fremdschl   ', 'N', 'Tabellen')!
 
Enter command:
INSERT INTO SPALTEN VALUES ('Indices      ', 'Index_Name  ', 'Y', NULL)!
 
Enter command:
INSERT INTO SPALTEN VALUES ('Index_Spalten', 'Index_Name  ', 'Y', 'Indices')!
 
Enter command:
INSERT INTO SPALTEN VALUES ('Spalten      ', 'Is_Key      ', 'N', NULL)!
 
Enter command:
INSERT INTO SPALTEN VALUES ('Index_Spalten', 'Sortierung  ', 'N', NULL)!
 
Enter command:
INSERT INTO SPALTEN VALUES ('Spalten      ', 'Spalte      ', 'Y', NULL)!
 
Enter command:
INSERT INTO SPALTEN VALUES ('Index_Spalten', 'Spalte      ', 'Y', NULL)!
 
Enter command:
INSERT INTO SPALTEN VALUES ('Index_Spalten', 'Tabelle     ', 'Y', 'Indices')!
 
Enter command:
INSERT INTO SPALTEN VALUES ('Tabellen     ', 'Tabelle     ', 'Y', NULL)!
 
Enter command:
INSERT INTO SPALTEN VALUES ('Spalten      ', 'Tabelle     ', 'Y', 'Tabellen')!
 
Enter command:
INSERT INTO SPALTEN VALUES ('Indices      ', 'Tabelle     ', 'Y', 'Tabellen')!
 
Enter command:
INSERT INTO SPALTEN VALUES ('Indices      ', 'Unique      ', 'N', NULL)!
 
Enter command:
PARS_THEN_EX !
 
Enter command:
DATA !
 
Enter command:
SELECT S1.TABELLE || '.' || S1.SPALTE || ' = ' ||
       S2.TABELLE || '.' || S1.SPALTE BEDINGUNG
FROM SPALTEN S1, SPALTEN S2
WHERE S1.TABELLE = :A
  AND S2.TABELLE = :B
  AND S1.FREMDSCHL = S2.TABELLE
  AND S1.SPALTE = S2.SPALTE
  AND NOT EXISTS
    (SELECT *
       FROM SPALTEN S3
      WHERE S1.TABELLE = S3.TABELLE
        AND S1.FREMDSCHL = S3.FREMDSCHL
        AND S3.SPALTE NOT IN
                (SELECT S4.SPALTE
                   FROM SPALTEN S4
                  WHERE S2.TABELLE = S4.TABELLE
                )
    )
UNION
SELECT S1.TABELLE || '.' || S1.SPALTE || ' = ' ||
       S2.TABELLE || '.' || S1.SPALTE BEDINGUNG
FROM SPALTEN S1, SPALTEN S2
WHERE S2.TABELLE = :A
  AND S1.TABELLE = :B
  AND S1.FREMDSCHL = S2.TABELLE
  AND S1.SPALTE = S2.SPALTE
  AND NOT EXISTS
    (SELECT *
       FROM SPALTEN S3
      WHERE S1.TABELLE = S3.TABELLE
        AND S1.FREMDSCHL = S3.FREMDSCHL
        AND S3.SPALTE NOT IN
                (SELECT S4.SPALTE
                   FROM SPALTEN S4
                  WHERE S2.TABELLE = S4.TABELLE
                )
    )!
 
c 30 'Tabellen' c 30 'Spalten'
c 30 'Tabellen' c 30 'Spalten'
 
***ERROR    100 Row not found                                              0001
 
Enter command:
NODATA !
 
Enter command:
FETCH INTO :A !
 
***ERROR    100 Row not found                                              0001
 
Enter command:
DATA !
 
Enter command:
SELECT S1.TABELLE || '.' || S1.SPALTE || ' = ' ||
       S2.TABELLE || '.' || S1.SPALTE BEDINGUNG
FROM SPALTEN S1, SPALTEN S2
WHERE S1.TABELLE = :A
  AND S2.TABELLE = :B
  AND S1.FREMDSCHL = S2.TABELLE
  AND S1.SPALTE = S2.SPALTE
  AND NOT EXISTS
    (SELECT *
       FROM SPALTEN S3
      WHERE S1.TABELLE = S3.TABELLE
        AND S1.FREMDSCHL = S3.FREMDSCHL
        AND S3.SPALTE NOT IN
                (SELECT S4.SPALTE
                   FROM SPALTEN S4
                  WHERE S2.TABELLE = S4.TABELLE
                )
    )
UNION
SELECT S1.TABELLE || '.' || S1.SPALTE || ' = ' ||
       S2.TABELLE || '.' || S1.SPALTE BEDINGUNG
FROM SPALTEN S1, SPALTEN S2
WHERE S2.TABELLE = :A
  AND S1.TABELLE = :B
  AND S1.FREMDSCHL = S2.TABELLE
  AND S1.SPALTE = S2.SPALTE
  AND NOT EXISTS
    (SELECT *
       FROM SPALTEN S3
      WHERE S1.TABELLE = S3.TABELLE
        AND S1.FREMDSCHL = S3.FREMDSCHL
        AND S3.SPALTE NOT IN
                (SELECT S4.SPALTE
                   FROM SPALTEN S4
                  WHERE S2.TABELLE = S4.TABELLE
                )
    )!
 
c 30 'Tabellen' c 30 'Indices'
c 30 'Tabellen' c 30 'Indices'
 
resultcount :                     0
 
Enter command:
NODATA !
 
Enter command:
FETCH INTO :A !
 
BEDINGUNG         :  Indices.Tabelle = Tabellen.Tabelle
 
resultcount :                     1
 
Enter command:
DATA !
 
Enter command:
SELECT S1.TABELLE || '.' || S1.SPALTE || ' = ' ||
       S2.TABELLE || '.' || S1.SPALTE BEDINGUNG
FROM SPALTEN S1, SPALTEN S2
WHERE S1.TABELLE = :A
  AND S2.TABELLE = :B
  AND S1.FREMDSCHL = S2.TABELLE
  AND S1.SPALTE = S2.SPALTE
  AND NOT EXISTS
    (SELECT *
       FROM SPALTEN S3
      WHERE S1.TABELLE = S3.TABELLE
        AND S1.FREMDSCHL = S3.FREMDSCHL
        AND S3.SPALTE NOT IN
                (SELECT S4.SPALTE
                   FROM SPALTEN S4
                  WHERE S2.TABELLE = S4.TABELLE
                )
    )
UNION
SELECT S1.TABELLE || '.' || S1.SPALTE || ' = ' ||
       S2.TABELLE || '.' || S1.SPALTE BEDINGUNG
FROM SPALTEN S1, SPALTEN S2
WHERE S2.TABELLE = :A
  AND S1.TABELLE = :B
  AND S1.FREMDSCHL = S2.TABELLE
  AND S1.SPALTE = S2.SPALTE
  AND NOT EXISTS
    (SELECT *
       FROM SPALTEN S3
      WHERE S1.TABELLE = S3.TABELLE
        AND S1.FREMDSCHL = S3.FREMDSCHL
        AND S3.SPALTE NOT IN
                (SELECT S4.SPALTE
                   FROM SPALTEN S4
                  WHERE S2.TABELLE = S4.TABELLE
                )
    )!
 
c 30 'Index_Spalten' c 30 'Indices'
c 30 'Index_Spalten' c 30 'Indices'
 
resultcount :                     0
 
Enter command:
NODATA !
 
Enter command:
FETCH INTO :A !
 
BEDINGUNG         :  Index_Spalten.Tabelle = Indices.Tabelle
--------------------------------------------------------------------------------
BEDINGUNG         :  Index_Spalten.Index_Name = Indices.Index_Name
 
resultcount :                     2
 
Enter command:
DATA !
 
Enter command:
SELECT S1.TABELLE || '.' || S1.SPALTE || ' = ' ||
       S2.TABELLE || '.' || S1.SPALTE BEDINGUNG
FROM SPALTEN S1, SPALTEN S2
WHERE S1.TABELLE = :A
  AND S2.TABELLE = :B
  AND S1.SPALTE = S2.SPALTE
  AND (S1.FREMDSCHL = S2.TABELLE
  AND NOT EXISTS
    (SELECT *
       FROM SPALTEN S3
      WHERE S1.TABELLE = S3.TABELLE
        AND S1.FREMDSCHL = S3.FREMDSCHL
        AND S3.SPALTE NOT IN
                (SELECT S4.SPALTE
                   FROM SPALTEN S4
                  WHERE S2.TABELLE = S4.TABELLE
                )
    )
OR
    S2.FREMDSCHL = S1.TABELLE
AND NOT EXISTS
   (SELECT *
      FROM SPALTEN S3
     WHERE S2.TABELLE = S3.TABELLE
       AND S2.FREMDSCHL = S3.FREMDSCHL
       AND S3.SPALTE NOT IN
           (SELECT S4.SPALTE
              FROM SPALTEN S4
             WHERE S1.TABELLE = S4.TABELLE
           )
   )
)!
 
c 30 'Tabellen' c 30 'Spalten'
 
***ERROR    100 Row not found                                              0001
 
Enter command:
NODATA !
 
Enter command:
FETCH INTO :A !
 
***ERROR    100 Row not found                                              0001
 
Enter command:
DATA !
 
Enter command:
SELECT S1.TABELLE || '.' || S1.SPALTE || ' = ' ||
       S2.TABELLE || '.' || S1.SPALTE BEDINGUNG
FROM SPALTEN S1, SPALTEN S2
WHERE S1.TABELLE = :A
  AND S2.TABELLE = :B
  AND S1.SPALTE = S2.SPALTE
  AND (S1.FREMDSCHL = S2.TABELLE
  AND NOT EXISTS
    (SELECT *
       FROM SPALTEN S3
      WHERE S1.TABELLE = S3.TABELLE
        AND S1.FREMDSCHL = S3.FREMDSCHL
        AND S3.SPALTE NOT IN
                (SELECT S4.SPALTE
                   FROM SPALTEN S4
                  WHERE S2.TABELLE = S4.TABELLE
                )
    )
OR
    S2.FREMDSCHL = S1.TABELLE
AND NOT EXISTS
   (SELECT *
      FROM SPALTEN S3
     WHERE S2.TABELLE = S3.TABELLE
       AND S2.FREMDSCHL = S3.FREMDSCHL
       AND S3.SPALTE NOT IN
           (SELECT S4.SPALTE
              FROM SPALTEN S4
             WHERE S1.TABELLE = S4.TABELLE
           )
   )
)!
 
c 30 'Tabellen' c 30 'Indices'
 
resultcount :                     0
 
Enter command:
NODATA !
 
Enter command:
FETCH INTO :A !
 
BEDINGUNG         :  Tabellen.Tabelle = Indices.Tabelle
 
resultcount :                     1
 
Enter command:
DATA !
 
Enter command:
SELECT S1.TABELLE || '.' || S1.SPALTE || ' = ' ||
       S2.TABELLE || '.' || S1.SPALTE BEDINGUNG
FROM SPALTEN S1, SPALTEN S2
WHERE S1.TABELLE = :A
  AND S2.TABELLE = :B
  AND S1.SPALTE = S2.SPALTE
  AND (S1.FREMDSCHL = S2.TABELLE
  AND NOT EXISTS
    (SELECT *
       FROM SPALTEN S3
      WHERE S1.TABELLE = S3.TABELLE
        AND S1.FREMDSCHL = S3.FREMDSCHL
        AND S3.SPALTE NOT IN
                (SELECT S4.SPALTE
                   FROM SPALTEN S4
                  WHERE S2.TABELLE = S4.TABELLE
                )
    )
OR
    S2.FREMDSCHL = S1.TABELLE
AND NOT EXISTS
   (SELECT *
      FROM SPALTEN S3
     WHERE S2.TABELLE = S3.TABELLE
       AND S2.FREMDSCHL = S3.FREMDSCHL
       AND S3.SPALTE NOT IN
           (SELECT S4.SPALTE
              FROM SPALTEN S4
             WHERE S1.TABELLE = S4.TABELLE
           )
   )
)!
 
c 30 'Index_Spalten' c 30 'Indices'
 
resultcount :                     0
 
Enter command:
NODATA !
 
Enter command:
FETCH INTO :A !
 
BEDINGUNG         :  Index_Spalten.Tabelle = Indices.Tabelle
--------------------------------------------------------------------------------
BEDINGUNG         :  Index_Spalten.Index_Name = Indices.Index_Name
 
resultcount :                     2
 
Enter command:
PARS_EXECUTE!
 
Enter command:
DROP TABLE TABELLEN !
 
Enter command:
DROP TABLE SPALTEN !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
FILE CONNECT ( SUT SUT !
 
Enter command:
CONNECT SUT IDENTIFIED BY SUT   ISOLATION LEVEL 1 !
 
Enter command:
DROP USER KERN !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( SUT SUT !
 
Enter command:
CONNECT SUT IDENTIFIED BY SUT   ISOLATION LEVEL 1 !
 
Enter command:
CREATE USER KERN PASSWORD TEST DBA NOT EXCLUSIVE !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST SQLMODE ORACLE !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE ORACLE ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE AUTOREN (
AUT_ID NUMBER CONSTRAINT AUTOREN_PK PRIMARY KEY,
NAME   VARCHAR(20))!
 
Enter command:
INSERT INTO AUTOREN VALUES (1, 'Bartels   ')!
 
Enter command:
INSERT INTO AUTOREN VALUES (2, 'Lenz      ')!
 
Enter command:
INSERT INTO AUTOREN VALUES (3, 'Unbescheid')!
 
Enter command:
INSERT INTO AUTOREN VALUES (4, 'Hermann   ')!
 
Enter command:
INSERT INTO AUTOREN VALUES (5, 'Stuerner  ')!
 
Enter command:
INSERT INTO AUTOREN VALUES (6, 'Wiesmeier ')!
 
Enter command:
CREATE TABLE BUECHER (
BUCH_ID NUMBER CONSTRAINT BUECHER_PK PRIMARY KEY,
TITEL   VARCHAR(20))!
 
Enter command:
INSERT INTO BUECHER VALUES (1, 'Oracle7    ')!
 
Enter command:
INSERT INTO BUECHER VALUES (2, 'SQL*Net    ')!
 
Enter command:
INSERT INTO BUECHER VALUES (3, 'Datenbanken')!
 
Enter command:
INSERT INTO BUECHER VALUES (4, 'Objekte    ')!
 
Enter command:
CREATE TABLE AUTOREN_REFERENZ (
BUCH_ID NUMBER CONSTRAINT REF_BUCH_FK REFERENCES BUECHER,
AUT_ID  NUMBER CONSTRAINT REF_AUTOR_FK REFERENCES AUTOREN,
LFD_NR  NUMBER,
CONSTRAINT AUTOREN_REFERENZ_PK PRIMARY KEY (BUCH_ID, AUT_ID, LFD_NR))!
 
Enter command:
INSERT INTO AUTOREN_REFERENZ VALUES (1, 1, 1)!
 
Enter command:
INSERT INTO AUTOREN_REFERENZ VALUES (2, 3, 2)!
 
Enter command:
INSERT INTO AUTOREN_REFERENZ VALUES (4, 3, 1)!
 
Enter command:
INSERT INTO AUTOREN_REFERENZ VALUES (3, 3, 3)!
 
Enter command:
INSERT INTO AUTOREN_REFERENZ VALUES (3, 4, 2)!
 
Enter command:
INSERT INTO AUTOREN_REFERENZ VALUES (3, 5, 1)!
 
Enter command:
INSERT INTO AUTOREN_REFERENZ VALUES (2, 6, 1)!
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
FILE CONNECT ( KERN TEST !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST   ISOLATION LEVEL 1 !
 
Enter command:
SELECT DECODE (ANZ_AUTOREN, 1, AUT1.NAME,
                            2, AUT1.NAME || ', ' || AUT2.NAME,
                               AUT1.NAME || ' et al') NAME,
       TITEL
FROM (SELECT BUCH_ID, COUNT(*) ANZ_AUTOREN
        FROM AUTOREN_REFERENZ
       GROUP BY BUCH_ID) CNTTAB,
      AUTOREN_REFERENZ AR,
      (SELECT BUCH_ID, NAME
         FROM AUTOREN_REFERENZ, AUTOREN
        WHERE AUTOREN_REFERENZ.AUT_ID = AUTOREN.AUT_ID
          AND LFD_NR = 1) AUT1,
      (SELECT BUCH_ID, NAME
         FROM AUTOREN_REFERENZ, AUTOREN
        WHERE AUTOREN_REFERENZ.AUT_ID = AUTOREN.AUT_ID
          AND (BUCH_ID, LFD_NR) = ANY (SELECT BUCH_ID, MAX(LFD_NR)
                                         FROM AUTOREN_REFERENZ
                                        GROUP BY BUCH_ID)) AUT2,
      BUECHER
WHERE AR.BUCH_ID = CNTTAB.BUCH_ID
  AND AR.BUCH_ID = AUT1.BUCH_ID
  AND AR.BUCH_ID = AUT2.BUCH_ID
  AND AR.BUCH_ID = BUECHER.BUCH_ID
  AND AR.LFD_NR  = 1
ORDER BY AR.BUCH_ID !
 
resultcount :                     4
 
Enter command:
FETCH!
 
NAME                                       | TITEL
-------------------------------------------+---------------------
Bartels                                    | Oracle7
Wiesmeier, Unbescheid                      | SQL*Net
Stuerner et al                             | Datenbanken
Unbescheid                                 | Objekte
 
resultcount :                     4
 
Enter command:
 
SELECT A.NAME, B.TITEL
  FROM BUECHER B,
       AUTOREN A,
       AUTOREN_REFERENZ R
 WHERE A.AUT_ID = R.AUT_ID
  AND B.BUCH_ID = R.BUCH_ID
  AND R.LFD_NR = 1
  AND 1 = (SELECT COUNT (*)
             FROM AUTOREN_REFERENZ RI
            WHERE B.BUCH_ID = RI.BUCH_ID)
UNION
SELECT A1.NAME || ', ' || A2.NAME NAME, B.TITEL
  FROM BUECHER B,
       AUTOREN A1,
       AUTOREN A2,
       AUTOREN_REFERENZ R1,
       AUTOREN_REFERENZ R2
 WHERE A1.AUT_ID = R1.AUT_ID
   AND A2.AUT_ID = R2.AUT_ID
   AND B.BUCH_ID = R1.BUCH_ID
   AND B.BUCH_ID = R2.BUCH_ID
   AND R1.LFD_NR = 1
   AND R2.LFD_NR = 2
   AND R1.BUCH_ID IN
          (SELECT RI.BUCH_ID
             FROM AUTOREN_REFERENZ RI
            GROUP BY RI.BUCH_ID
            HAVING COUNT(*) = 2 )
UNION
SELECT A.NAME || ' et. al.' NAME, B.TITEL
  FROM BUECHER B,
       AUTOREN A,
       AUTOREN_REFERENZ R
 WHERE A.AUT_ID = R.AUT_ID
   AND B.BUCH_ID = R.BUCH_ID
   AND R.LFD_NR = 1
   AND EXISTS (SELECT *
                 FROM AUTOREN_REFERENZ RI
                WHERE B.BUCH_ID = RI.BUCH_ID
                  AND RI.LFD_NR = 3)
ORDER BY 1 !
 
resultcount :                     4
 
Enter command:
FETCH INTO :A, :B !
 
NAME                                       | TITEL
-------------------------------------------+---------------------
Bartels                                    | Oracle7
Stuerner et. al.                           | Datenbanken
Unbescheid                                 | Objekte
Wiesmeier, Unbescheid                      | SQL*Net
 
resultcount :                     4
 
Enter command:
 
SELECT DECODE (AUT_ANZ.ANZAHL,
               1, A1.NAME,
               2, A1.NAME || ', ' || A2.NAME,
               A1.NAME || ' et. al.') NAME,
       B.TITEL
  FROM BUECHER B,
       AUTOREN A1,
       AUTOREN A2,
       AUTOREN_REFERENZ R1,
       AUTOREN_REFERENZ R2,
       (SELECT RI.BUCH_ID, COUNT(*) ANZAHL
          FROM AUTOREN_REFERENZ RI
         WHERE RI.LFD_NR <= 3
         GROUP BY RI.BUCH_ID) AUT_ANZ
 WHERE A1.AUT_ID      = R1.AUT_ID
   AND A2.AUT_ID (+)  = R2.AUT_ID
   AND B.BUCH_ID      = R1.BUCH_ID
   AND B.BUCH_ID      = R2.BUCH_ID (+)
   AND R1.LFD_NR      = 1
   AND R2.LFD_NR (+)  = 2
   AND R1.BUCH_ID     = AUT_ANZ.BUCH_ID
ORDER BY 1 !
 
resultcount :                     2
 
Enter command:
FETCH INTO :A, :B !
 
NAME                                       | TITEL
-------------------------------------------+---------------------
Stuerner et. al.                           | Datenbanken
Wiesmeier, Unbescheid                      | SQL*Net
 
resultcount :                     2
 
Enter command:
DROP TABLE AUTOREN !
 
Enter command:
DROP TABLE BUECHER !
 
Enter command:
DROP TABLE AUTOREN_REFERENZ !
 
Enter command:
COMMIT RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST SQLMODE ORACLE !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE ORACLE ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE FIRMEN (
F_ID   NUMBER CONSTRAINT FIRMEN_PK PRIMARY KEY,
F_NAME VARCHAR (20))!
 
Enter command:
INSERT INTO FIRMEN VALUES (1, 'Autohaus Meyer  ')!
 
Enter command:
INSERT INTO FIRMEN VALUES (8, 'Friseur Schulz  ')!
 
Enter command:
INSERT INTO FIRMEN VALUES (5, 'Klempner Schmidt')!
 
Enter command:
INSERT INTO FIRMEN VALUES (9, 'Werkstatt Grefe ')!
 
Enter command:
COMMIT !
 
Enter command:
CREATE TABLE PERSONEN (
P_ID    NUMBER CONSTRAINT PERSONEN_PK PRIMARY KEY,
P_F_ID  NUMBER CONSTRAINT PERSONEN_FIRMEN_FK REFERENCES FIRMEN,
P_NAME  VARCHAR (20))!
 
Enter command:
INSERT INTO PERSONEN VALUES (11, 5, 'Albrecht   ')!
 
Enter command:
INSERT INTO PERSONEN VALUES (22, 5, 'Clausen    ')!
 
Enter command:
INSERT INTO PERSONEN VALUES (55, 1, 'Fritz      ')!
 
Enter command:
INSERT INTO PERSONEN VALUES ( 9, 5, 'Graber     ')!
 
Enter command:
INSERT INTO PERSONEN VALUES (36, 9, 'Hansen     ')!
 
Enter command:
INSERT INTO PERSONEN VALUES (44, 9, 'Herrmann   ')!
 
Enter command:
INSERT INTO PERSONEN VALUES (77, 5, 'Jensen     ')!
 
Enter command:
INSERT INTO PERSONEN VALUES ( 2, 5, 'Kunz       ')!
 
Enter command:
INSERT INTO PERSONEN VALUES (56, 5, 'Linke      ')!
 
Enter command:
INSERT INTO PERSONEN VALUES (23, 8, 'Linkwitz   ')!
 
Enter command:
INSERT INTO PERSONEN VALUES (14, 1, 'Paulsen    ')!
 
Enter command:
INSERT INTO PERSONEN VALUES (12, 5, 'Petersen   ')!
 
Enter command:
INSERT INTO PERSONEN VALUES (25, 9, 'Rackwitz   ')!
 
Enter command:
INSERT INTO PERSONEN VALUES ( 5, 1, 'Schweizer  ')!
 
Enter command:
INSERT INTO PERSONEN VALUES (13, 5, 'Weidert    ')!
 
Enter command:
INSERT INTO PERSONEN VALUES (33, 9, 'Zimmer     ')!
 
Enter command:
COMMIT !
 
Enter command:
SELECT F_NAME, P_NAME, X.NUMMER
  FROM FIRMEN, PERSONEN,
       (SELECT COUNT(*) NUMMER, P1.P_ID
          FROM PERSONEN P1, PERSONEN P2
         WHERE P1.P_ID  >= P2.P_ID
           AND P1.P_F_ID = P2.P_F_ID
         GROUP BY P1.P_ID
       ) X
 WHERE FIRMEN.F_ID = PERSONEN.P_F_ID
   AND X.P_ID = PERSONEN.P_ID
   AND MOD (X.NUMMER, 3) = 1
ORDER BY 1,3 !
 
resultcount :                     0
 
Enter command:
FETCH INTO :A, :B, :C !
 
F_NAME               | P_NAME               | NUMMER
---------------------+----------------------+------------
Autohaus Meyer       | Schweizer            |           1
Friseur Schulz       | Linkwitz             |           1
Klempner Schmidt     | Kunz                 |           1
Klempner Schmidt     | Petersen             |           4
Klempner Schmidt     | Linke                |           7
Werkstatt Grefe      | Rackwitz             |           1
Werkstatt Grefe      | Herrmann             |           4
 
resultcount :                     7
 
Enter command:
SELECT F.F_NAME, P.P_NAME, COUNT(*) NUMMER
  FROM FIRMEN F,
       PERSONEN P,
       PERSONEN PZ
 WHERE F.F_ID   = P.P_F_ID
   AND P.P_F_ID = PZ.P_F_ID
   AND P.P_ID  >= PZ.P_ID
GROUP BY F.F_NAME, F.F_ID, P.P_NAME, P.P_ID
HAVING MOD(COUNT(*), 3) = 1
ORDER BY F_NAME, NUMMER !
 
resultcount :                     0
 
Enter command:
FETCH INTO :A, :B, :C !
 
F_NAME               | P_NAME               | NUMMER
---------------------+----------------------+------------
Autohaus Meyer       | Schweizer            |           1
Friseur Schulz       | Linkwitz             |           1
Klempner Schmidt     | Kunz                 |           1
Klempner Schmidt     | Petersen             |           4
Klempner Schmidt     | Linke                |           7
Werkstatt Grefe      | Rackwitz             |           1
Werkstatt Grefe      | Herrmann             |           4
 
resultcount :                     7
 
Enter command:
DROP TABLE FIRMEN !
 
Enter command:
DROP TABLE PERSONEN !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST SQLMODE ORACLE !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE ORACLE ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE MITARBEITER (
M_ID   NUMBER CONSTRAINT MA_PK PRIMARY KEY,
NAME   VARCHAR (10) NOT NULL)!
 
Enter command:
INSERT INTO MITARBEITER VALUES (2, 'Fitz')!
 
Enter command:
INSERT INTO MITARBEITER VALUES (3, 'Lenz')!
 
Enter command:
INSERT INTO MITARBEITER VALUES (1, 'Ofer')!
 
Enter command:
COMMIT WORK !
 
Enter command:
CREATE TABLE KENNTNISSE (
M_ID           NUMBER CONSTRAINT K_MA_FK REFERENCES MITARBEITER,
BEZEICHNUNG    VARCHAR (10),
CONSTRAINT K_PK PRIMARY KEY (M_ID, BEZEICHNUNG)) !
 
Enter command:
INSERT INTO KENNTNISSE VALUES (1, '4GL       ')!
 
Enter command:
INSERT INTO KENNTNISSE VALUES (3, 'C         ')!
 
Enter command:
INSERT INTO KENNTNISSE VALUES (3, 'C++       ')!
 
Enter command:
INSERT INTO KENNTNISSE VALUES (2, 'CICS      ')!
 
Enter command:
INSERT INTO KENNTNISSE VALUES (2, 'COBOL     ')!
 
Enter command:
INSERT INTO KENNTNISSE VALUES (3, 'DB-LIB    ')!
 
Enter command:
INSERT INTO KENNTNISSE VALUES (2, 'DB2 DBA   ')!
 
Enter command:
INSERT INTO KENNTNISSE VALUES (2, 'JCL       ')!
 
Enter command:
INSERT INTO KENNTNISSE VALUES (1, 'ORACLE DBA')!
 
Enter command:
INSERT INTO KENNTNISSE VALUES (3, 'SQL       ')!
 
Enter command:
INSERT INTO KENNTNISSE VALUES (1, 'SQL*NET   ')!
 
Enter command:
INSERT INTO KENNTNISSE VALUES (3, 'SYBASE DBA')!
 
Enter command:
COMMIT WORK !
 
Enter command:
CREATE TABLE OFFENE_POSITIONEN (
POS_ID       NUMBER,
BEZEICHNUNG  VARCHAR (10),
CONSTRAINT OP_PK PRIMARY KEY (POS_ID))!
 
Enter command:
INSERT INTO OFFENE_POSITIONEN VALUES (1, 'Entwickler')!
 
Enter command:
INSERT INTO OFFENE_POSITIONEN VALUES (2, 'WEB Spezi ')!
 
Enter command:
INSERT INTO OFFENE_POSITIONEN VALUES (3, 'Entwickler')!
 
Enter command:
INSERT INTO OFFENE_POSITIONEN VALUES (4, 'Entwickler')!
 
Enter command:
COMMIT !
 
Enter command:
CREATE TABLE NOTWENDIGE_KENNTNISSE (
POS_ID        NUMBER,
BEZEICHNUNG   VARCHAR (10),
CONSTRAINT NK_PK PRIMARY KEY (POS_ID, BEZEICHNUNG),
CONSTRAINT NK_OP_FK FOREIGN KEY (POS_ID) REFERENCES OFFENE_POSITIONEN)!
 
Enter command:
INSERT INTO NOTWENDIGE_KENNTNISSE VALUES (1, '4GL       ')!
 
Enter command:
INSERT INTO NOTWENDIGE_KENNTNISSE VALUES (2, 'C++       ')!
 
Enter command:
INSERT INTO NOTWENDIGE_KENNTNISSE VALUES (3, 'CICS      ')!
 
Enter command:
INSERT INTO NOTWENDIGE_KENNTNISSE VALUES (3, 'COBOL     ')!
 
Enter command:
INSERT INTO NOTWENDIGE_KENNTNISSE VALUES (2, 'DB2 DBA   ')!
 
Enter command:
INSERT INTO NOTWENDIGE_KENNTNISSE VALUES (2, 'JAVA      ')!
 
Enter command:
INSERT INTO NOTWENDIGE_KENNTNISSE VALUES (1, 'ORACLE DBA')!
 
Enter command:
INSERT INTO NOTWENDIGE_KENNTNISSE VALUES (2, 'SQL       ')!
 
Enter command:
INSERT INTO NOTWENDIGE_KENNTNISSE VALUES (4, 'ORACLE DBA')!
 
Enter command:
INSERT INTO NOTWENDIGE_KENNTNISSE VALUES (4, 'COBOL     ')!
 
Enter command:
INSERT INTO NOTWENDIGE_KENNTNISSE VALUES (4, 'SQL       ')!
 
Enter command:
COMMIT WORK !
 
Enter command:
SELECT OP.POS_ID, OP.BEZEICHNUNG
  FROM OFFENE_POSITIONEN OP, NOTWENDIGE_KENNTNISSE NOT_K
 WHERE OP.POS_ID = NOT_K.POS_ID
GROUP BY OP.POS_ID, OP.BEZEICHNUNG
HAVING COUNT(*) > ALL (SELECT COUNT(K.BEZEICHNUNG)
                         FROM KENNTNISSE K, NOTWENDIGE_KENNTNISSE NK
                        WHERE K.BEZEICHNUNG = NK.BEZEICHNUNG
                          AND NK.POS_ID = OP.POS_ID
                        GROUP BY K.M_ID)!
 
resultcount :                     0
 
Enter command:
FETCH INTO :A, :B !
 
POS_ID                     | BEZEICHNUNG
---------------------------+------------
 2.0000000000000000000E+00 | WEB Spezi
 4.0000000000000000000E+00 | Entwickler
 
resultcount :                     2
 
Enter command:
SELECT POS_ID, BEZEICHNUNG
  FROM OFFENE_POSITIONEN O
 WHERE NOT EXISTS
       (SELECT K.M_ID, COUNT(NK.BEZEICHNUNG)
          FROM NOTWENDIGE_KENNTNISSE NK,
               KENNTNISSE K
         WHERE NK.BEZEICHNUNG = K.BEZEICHNUNG
           AND NK.POS_ID = O.POS_ID
          GROUP BY NK.POS_ID, K.M_ID
          HAVING COUNT (NK.BEZEICHNUNG) =
                              (SELECT COUNT (NK2.BEZEICHNUNG)
                                 FROM NOTWENDIGE_KENNTNISSE NK2
                                WHERE NK.POS_ID = NK2.POS_ID
                              )
       ) !
 
resultcount :                     0
 
Enter command:
FETCH INTO :A, :B !
 
POS_ID                     | BEZEICHNUNG
---------------------------+------------
 2.0000000000000000000E+00 | WEB Spezi
 4.0000000000000000000E+00 | Entwickler
 
resultcount :                     2
 
Enter command:
DROP TABLE MITARBEITER !
 
Enter command:
DROP TABLE KENNTNISSE !
 
Enter command:
DROP TABLE OFFENE_POSITIONEN !
 
Enter command:
DROP TABLE NOTWENDIGE_KENNTNISSE !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
 
FILE CONNECT ( KERN TEST SQLMODE ORACLE !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE ORACLE ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE AUFTRAG (
AUF_ID  INTEGER CONSTRAINT AUFTRAG_PK PRIMARY KEY,
KD_NAME VARCHAR (10) NOT NULL)!
 
Enter command:
INSERT INTO AUFTRAG VALUES (1, 'Parthier')!
 
Enter command:
INSERT INTO AUFTRAG VALUES (2, 'Jansen')!
 
Enter command:
INSERT INTO AUFTRAG VALUES (3, 'Hagner')!
 
Enter command:
CREATE TABLE POSITION (
AUF_ID       INTEGER CONSTRAINT POS_AUF_FK REFERENCES AUFTRAG,
POSITION     INTEGER,
MENGE        INTEGER NOT NULL,
BEZEICHNUNG  VARCHAR(10) NOT NULL,
CONSTRAINT POSITION_PK PRIMARY KEY (AUF_ID, POSITION))!
 
Enter command:
INSERT INTO POSITION VALUES (1,1,5,'Blech')!
 
Enter command:
INSERT INTO POSITION VALUES (1,2,3,'Stuetze')!
 
Enter command:
INSERT INTO POSITION VALUES (1,3,2,'Halter')!
 
Enter command:
INSERT INTO POSITION VALUES (2,1,1,'Gehaeuse')!
 
Enter command:
INSERT INTO POSITION VALUES (2,2,4,'Lager')!
 
Enter command:
INSERT INTO POSITION VALUES (2,3,5,'Korpus')!
 
Enter command:
INSERT INTO POSITION VALUES (3,1,3,'Blech')!
 
Enter command:
INSERT INTO POSITION VALUES (3,2,1,'Lager')!
 
Enter command:
CREATE TABLE MASCHINE (
M_ID        INTEGER CONSTRAINT MASCHINE_PK PRIMARY KEY,
BEZEICHNUNG VARCHAR (10) NOT NULL,
DM_STUNDE   DECIMAL (8,2) NOT NULL)!
 
Enter command:
INSERT INTO MASCHINE VALUES (1, 'M1', 998.98)!
 
Enter command:
INSERT INTO MASCHINE VALUES (2, 'M2', 899.98)!
 
Enter command:
INSERT INTO MASCHINE VALUES (3, 'M3', 699.98)!
 
Enter command:
CREATE TABLE WERKZEUG (
W_ID        INTEGER CONSTRAINT WERKZEUG_PK PRIMARY KEY,
BEZEICHNUNG VARCHAR (10) NOT NULL,
DM_STUNDE   DECIMAL (8,2) NOT NULL)!
 
Enter command:
INSERT INTO WERKZEUG VALUES (1, 'Bohrer  ', 20.22)!
 
Enter command:
INSERT INTO WERKZEUG VALUES (2, 'Saege   ', 30.33)!
 
Enter command:
INSERT INTO WERKZEUG VALUES (3, 'Fraese  ', 40.44)!
 
Enter command:
INSERT INTO WERKZEUG VALUES (4, 'Schleifer',50.55)!
 
Enter command:
INSERT INTO WERKZEUG VALUES (5, 'Dreher  ', 60.66)!
 
Enter command:
CREATE TABLE MASCHINE_WERKZEUG (
M_ID        INTEGER CONSTRAINT MASCH_WK_MASCH_FK REFERENCES MASCHINE,
W_ID        INTEGER CONSTRAINT MASCH_WK_WK_FK REFERENCES WERKZEUG,
MAX_MASS    DECIMAL (8,2) NOT NULL,
CONSTRAINT MASCHINE_WERKZEUG_PK PRIMARY KEY (M_ID, W_ID))!
 
Enter command:
INSERT INTO MASCHINE_WERKZEUG VALUES (1,1,20.5)!
 
Enter command:
INSERT INTO MASCHINE_WERKZEUG VALUES (1,2,30.5)!
 
Enter command:
INSERT INTO MASCHINE_WERKZEUG VALUES (1,3,40.5)!
 
Enter command:
INSERT INTO MASCHINE_WERKZEUG VALUES (1,4,10.5)!
 
Enter command:
INSERT INTO MASCHINE_WERKZEUG VALUES (1,5,20.5)!
 
Enter command:
INSERT INTO MASCHINE_WERKZEUG VALUES (2,1,30.5)!
 
Enter command:
INSERT INTO MASCHINE_WERKZEUG VALUES (2,2,20.5)!
 
Enter command:
INSERT INTO MASCHINE_WERKZEUG VALUES (2,3,20.5)!
 
Enter command:
INSERT INTO MASCHINE_WERKZEUG VALUES (2,4,22.5)!
 
Enter command:
INSERT INTO MASCHINE_WERKZEUG VALUES (2,5,20.5)!
 
Enter command:
INSERT INTO MASCHINE_WERKZEUG VALUES (3,1,20.5)!
 
Enter command:
INSERT INTO MASCHINE_WERKZEUG VALUES (3,3,20.5)!
 
Enter command:
INSERT INTO MASCHINE_WERKZEUG VALUES (3,5,20.5)!
 
Enter command:
CREATE TABLE BEARBEITUNG (
AUF_ID     INTEGER,
POSITION   INTEGER,
SCHRITT    INTEGER,
W_ID       INTEGER NOT NULL CONSTRAINT BEARB_WK_FK REFERENCES WERKZEUG,
MASS       DECIMAL (8,2) NOT NULL,
DAUER      DECIMAL (4,2) NOT NULL,
CONSTRAINT BEARBEITUNG_PK PRIMARY KEY (AUF_ID, POSITION, SCHRITT),
CONSTRAINT BEARB_POS_FK FOREIGN KEY (AUF_ID, POSITION)
                       REFERENCES POSITION)!
 
Enter command:
INSERT INTO BEARBEITUNG VALUES (1,1,1,1,20.2,0.3)!
 
Enter command:
INSERT INTO BEARBEITUNG VALUES (1,1,2,3,20.2,0.1)!
 
Enter command:
INSERT INTO BEARBEITUNG VALUES (1,2,1,5,20.3,0.4)!
 
Enter command:
INSERT INTO BEARBEITUNG VALUES (1,2,2,3,20.1,0.3)!
 
Enter command:
INSERT INTO BEARBEITUNG VALUES (1,3,1,1,20.2,0.5)!
 
Enter command:
INSERT INTO BEARBEITUNG VALUES (1,3,2,5,20.1,0.6)!
 
Enter command:
INSERT INTO BEARBEITUNG VALUES (2,1,1,1,20.2,0.3)!
 
Enter command:
INSERT INTO BEARBEITUNG VALUES (2,1,2,3,20.2,0.1)!
 
Enter command:
INSERT INTO BEARBEITUNG VALUES (2,2,1,5,20.3,0.4)!
 
Enter command:
INSERT INTO BEARBEITUNG VALUES (2,2,2,3,40.1,0.7)!
 
Enter command:
INSERT INTO BEARBEITUNG VALUES (2,3,1,1,20.2,0.5)!
 
Enter command:
INSERT INTO BEARBEITUNG VALUES (2,3,2,5,20.1,0.6)!
 
Enter command:
INSERT INTO BEARBEITUNG VALUES (3,1,1,1,20.2,0.3)!
 
Enter command:
INSERT INTO BEARBEITUNG VALUES (3,1,2,3,20.2,0.1)!
 
Enter command:
INSERT INTO BEARBEITUNG VALUES (3,2,1,4,20.3,0.4)!
 
Enter command:
INSERT INTO BEARBEITUNG VALUES (3,2,2,3,40.1,0.7)!
 
Enter command:
COMMIT WORK RELEASE!
 
Enter command:
FILE CONNECT ( KERN TEST !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST   ISOLATION LEVEL 1 !
 
Enter command:
SELECT A.AUF_ID, M.M_ID, M.BEZEICHNUNG,
 FIXED (SUM(P.MENGE*B.DAUER*(M.DM_STUNDE+W.DM_STUNDE)),10,3)
FROM  AUFTRAG A,
      POSITION P,
      BEARBEITUNG B,
      WERKZEUG W,
      MASCHINE_WERKZEUG M_W,
      MASCHINE M
WHERE A.AUF_ID = P.AUF_ID
  AND P.AUF_ID = B.AUF_ID
  AND P.POSITION = B.POSITION
  AND B.W_ID = W.W_ID
  AND W.W_ID = M_W.W_ID
  AND B.MASS <= M_W.MAX_MASS
  AND M_W.M_ID = M.M_ID
GROUP BY A.AUF_ID, M.M_ID, M.BEZEICHNUNG
HAVING (COUNT(*) , A.AUF_ID) =
     ANY ( SELECT COUNT(*), AUF_ID FROM BEARBEITUNG GROUP BY AUF_ID)!
 
resultcount :                     4
 
Enter command:
FETCH INTO :A, :B, :C, :D !
 
AUF_ID                | M_ID                  | BEZEICHNUNG | EXPRESSION1
----------------------+-----------------------+-------------+-------------
                    1 |                     1 | M1          |     6546.324
                    1 |                     2 | M2          |     5922.624
                    1 |                     3 | M3          |     4662.624
                    2 |                     1 | M1          |    10742.422
 
resultcount :                     4
 
Enter command:
 
SELECT B.AUF_ID, M.M_ID, M.BEZEICHNUNG "Maschine",
       FIXED(SUM(P.MENGE*B.DAUER*(M.DM_STUNDE+W.DM_STUNDE)),7,2) "Preis"
FROM BEARBEITUNG B, WERKZEUG W, MASCHINE M, MASCHINE_WERKZEUG MW,
     POSITION P
WHERE
    B.W_ID = W.W_ID AND
    MW.W_ID = W.W_ID AND
    MW.M_ID = M.M_ID AND
    B.MASS <= MW.MAX_MASS AND
    P.AUF_ID = B.AUF_ID AND
    P.POSITION = B.POSITION
GROUP BY B.AUF_ID, M.M_ID, M.BEZEICHNUNG
HAVING COUNT(B.SCHRITT) = (
  SELECT COUNT(B1.SCHRITT)
  FROM BEARBEITUNG B1
  WHERE B1.AUF_ID = B.AUF_ID
)
ORDER BY B.AUF_ID, M.M_ID!
 
resultcount :                     4
 
Enter command:
FETCH INTO :A, :B, :C, :D !
 
AUF_ID                | M_ID                  | Maschine   | Preis
----------------------+-----------------------+------------+----------
                    1 |                     1 | M1         |   6546.32
                    1 |                     2 | M2         |   5922.62
                    1 |                     3 | M3         |   4662.62
                    2 |                     1 | M1         |  10742.42
 
resultcount :                     4
 
Enter command:
DROP TABLE AUFTRAG !
 
Enter command:
DROP TABLE POSITION !
 
Enter command:
DROP TABLE BEARBEITUNG !
 
Enter command:
DROP TABLE WERKZEUG !
 
Enter command:
DROP TABLE MASCHINE_WERKZEUG !
 
Enter command:
DROP TABLE MASCHINE!
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST SQLMODE ORACLE !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE ORACLE ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE MITARBEITER (
M_ID   NUMBER CONSTRAINT MA_PK PRIMARY KEY,
NAME   VARCHAR (10) NOT NULL)!
 
Enter command:
INSERT INTO MITARBEITER VALUES (2, 'Fitz')!
 
Enter command:
INSERT INTO MITARBEITER VALUES (3, 'Lenz')!
 
Enter command:
INSERT INTO MITARBEITER VALUES (1, 'Ofer')!
 
Enter command:
COMMIT WORK !
 
Enter command:
CREATE TABLE KENNTNISSE (
K_ID           NUMBER CONSTRAINT K_PK PRIMARY KEY,
BEZEICHNUNG    VARCHAR (10))!
 
Enter command:
INSERT INTO KENNTNISSE VALUES (1, '4GL       ')!
 
Enter command:
INSERT INTO KENNTNISSE VALUES (2, 'C         ')!
 
Enter command:
INSERT INTO KENNTNISSE VALUES (3, 'C++       ')!
 
Enter command:
INSERT INTO KENNTNISSE VALUES (4, 'CICS      ')!
 
Enter command:
INSERT INTO KENNTNISSE VALUES (5, 'COBOL     ')!
 
Enter command:
INSERT INTO KENNTNISSE VALUES (6, 'DB-LIB    ')!
 
Enter command:
INSERT INTO KENNTNISSE VALUES (7, 'DB2 DBA   ')!
 
Enter command:
INSERT INTO KENNTNISSE VALUES (8, 'JAVA      ')!
 
Enter command:
INSERT INTO KENNTNISSE VALUES (9, 'JCL       ')!
 
Enter command:
INSERT INTO KENNTNISSE VALUES (10, 'ORACLE DBA')!
 
Enter command:
INSERT INTO KENNTNISSE VALUES (11, 'SQL       ')!
 
Enter command:
INSERT INTO KENNTNISSE VALUES (12, 'SQL*NET   ')!
 
Enter command:
INSERT INTO KENNTNISSE VALUES (13, 'SYBASE DBA')!
 
Enter command:
COMMIT WORK !
 
Enter command:
CREATE TABLE VORHANDENE_KENNTNISSE (
M_ID         NUMBER CONSTRAINT VK_M_FK REFERENCES MITARBEITER,
K_ID         NUMBER CONSTRAINT VK_K_FK REFERENCES KENNTNISSE,
CONSTRAINT NK_PK PRIMARY KEY (M_ID, K_ID)) !
 
Enter command:
INSERT INTO VORHANDENE_KENNTNISSE VALUES (1, 1)!
 
Enter command:
INSERT INTO VORHANDENE_KENNTNISSE VALUES (3, 2)!
 
Enter command:
INSERT INTO VORHANDENE_KENNTNISSE VALUES (3, 3)!
 
Enter command:
INSERT INTO VORHANDENE_KENNTNISSE VALUES (2, 4)!
 
Enter command:
INSERT INTO VORHANDENE_KENNTNISSE VALUES (2, 5)!
 
Enter command:
INSERT INTO VORHANDENE_KENNTNISSE VALUES (3, 6)!
 
Enter command:
INSERT INTO VORHANDENE_KENNTNISSE VALUES (2, 7)!
 
Enter command:
INSERT INTO VORHANDENE_KENNTNISSE VALUES (2, 9)!
 
Enter command:
INSERT INTO VORHANDENE_KENNTNISSE VALUES (1,10)!
 
Enter command:
INSERT INTO VORHANDENE_KENNTNISSE VALUES (3,11)!
 
Enter command:
INSERT INTO VORHANDENE_KENNTNISSE VALUES (1,12)!
 
Enter command:
INSERT INTO VORHANDENE_KENNTNISSE VALUES (3,13)!
 
Enter command:
COMMIT WORK !
 
Enter command:
CREATE TABLE OFFENE_POSITIONEN (
POS_ID       NUMBER,
BEZEICHNUNG  VARCHAR (10),
CONSTRAINT OP_PK PRIMARY KEY (POS_ID))!
 
Enter command:
INSERT INTO OFFENE_POSITIONEN VALUES (1, 'Entwickler')!
 
Enter command:
INSERT INTO OFFENE_POSITIONEN VALUES (2, 'WEB Spezi ')!
 
Enter command:
INSERT INTO OFFENE_POSITIONEN VALUES (3, 'Entwickler')!
 
Enter command:
INSERT INTO OFFENE_POSITIONEN VALUES (4, 'Entwickler')!
 
Enter command:
COMMIT !
 
Enter command:
CREATE TABLE NOTWENDIGE_KENNTNISSE (
POS_ID        NUMBER CONSTRAINT NK_OP_FK REFERENCES OFFENE_POSITIONEN,
K_ID          NUMBER CONSTRAINT NK_K__FK REFERENCES KENNTNISSE,
CONSTRAINT NK_PK PRIMARY KEY (POS_ID, K_ID))!
 
Enter command:
INSERT INTO NOTWENDIGE_KENNTNISSE VALUES (1, 1)!
 
Enter command:
INSERT INTO NOTWENDIGE_KENNTNISSE VALUES (2, 3)!
 
Enter command:
INSERT INTO NOTWENDIGE_KENNTNISSE VALUES (3, 4)!
 
Enter command:
INSERT INTO NOTWENDIGE_KENNTNISSE VALUES (3, 5)!
 
Enter command:
INSERT INTO NOTWENDIGE_KENNTNISSE VALUES (4, 5)!
 
Enter command:
INSERT INTO NOTWENDIGE_KENNTNISSE VALUES (2, 7)!
 
Enter command:
INSERT INTO NOTWENDIGE_KENNTNISSE VALUES (2, 8)!
 
Enter command:
INSERT INTO NOTWENDIGE_KENNTNISSE VALUES (1,10)!
 
Enter command:
INSERT INTO NOTWENDIGE_KENNTNISSE VALUES (4,10)!
 
Enter command:
INSERT INTO NOTWENDIGE_KENNTNISSE VALUES (2,11)!
 
Enter command:
INSERT INTO NOTWENDIGE_KENNTNISSE VALUES (4,11)!
 
Enter command:
COMMIT WORK !
 
Enter command:
SELECT OP.POS_ID, OP.BEZEICHNUNG, NAME
  FROM OFFENE_POSITIONEN OP,
       MITARBEITER M,
       VORHANDENE_KENNTNISSE VK,
       NOTWENDIGE_KENNTNISSE NK
 WHERE OP.POS_ID = NK.POS_ID
   AND NK.K_ID   = VK.K_ID
   AND M.M_ID    = VK.M_ID
GROUP BY OP.POS_ID, OP.BEZEICHNUNG, NAME
HAVING COUNT(*) >= ALL ( SELECT COUNT(*)
                  FROM VORHANDENE_KENNTNISSE VK,
                       NOTWENDIGE_KENNTNISSE NK
                 WHERE NK.POS_ID  = OP.POS_ID
                   AND NK.K_ID   = VK.K_ID
                GROUP BY VK.M_ID
                  ) !
 
resultcount :                     0
 
Enter command:
FETCH INTO :A, :B, :C !
 
POS_ID                     | BEZEICHNUNG | NAME
---------------------------+-------------+-----------
 1.0000000000000000000E+00 | Entwickler  | Ofer
 2.0000000000000000000E+00 | WEB Spezi   | Lenz
 3.0000000000000000000E+00 | Entwickler  | Fitz
 4.0000000000000000000E+00 | Entwickler  | Fitz
 4.0000000000000000000E+00 | Entwickler  | Lenz
 4.0000000000000000000E+00 | Entwickler  | Ofer
 
resultcount :                     6
 
Enter command:
SELECT OP.POS_ID, OP.BEZEICHNUNG, NAME
  FROM OFFENE_POSITIONEN OP,
       MITARBEITER M,
       VORHANDENE_KENNTNISSE VK,
       NOTWENDIGE_KENNTNISSE NK
 WHERE OP.POS_ID = NK.POS_ID
   AND NK.K_ID   = VK.K_ID
   AND M.M_ID    = VK.M_ID
GROUP BY OP.POS_ID, OP.BEZEICHNUNG, NAME
HAVING NOT EXISTS (SELECT VK1.M_ID
                  FROM VORHANDENE_KENNTNISSE VK1,
                       NOTWENDIGE_KENNTNISSE NK1
                 WHERE NK1.POS_ID = OP.POS_ID
                   AND NK1.K_ID   = VK1.K_ID
                GROUP BY VK1.M_ID
    HAVING COUNT (VK1.K_ID) > COUNT (VK.K_ID)
                  ) !
 
resultcount :                     0
 
Enter command:
PARS_EXECUTE!
 
Enter command:
FETCH INTO :A, :B, :C !
 
POS_ID                     | BEZEICHNUNG | NAME
---------------------------+-------------+-----------
 1.0000000000000000000E+00 | Entwickler  | Ofer
 2.0000000000000000000E+00 | WEB Spezi   | Lenz
 3.0000000000000000000E+00 | Entwickler  | Fitz
 4.0000000000000000000E+00 | Entwickler  | Fitz
 4.0000000000000000000E+00 | Entwickler  | Lenz
 4.0000000000000000000E+00 | Entwickler  | Ofer
 
resultcount :                     6
 
Enter command:
DROP TABLE MITARBEITER !
 
Enter command:
DROP TABLE KENNTNISSE !
 
Enter command:
DROP TABLE VORHANDENE_KENNTNISSE !
 
Enter command:
DROP TABLE OFFENE_POSITIONEN !
 
Enter command:
DROP TABLE NOTWENDIGE_KENNTNISSE !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST   ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE KFZ (
KENNZEICHEN   VARCHAR (20) PRIMARY KEY,
AVG_VERBRAUCH DECIMAL)!
 
Enter command:
INSERT INTO KFZ VALUES ('HH-XY 1224', 10)!
 
Enter command:
INSERT INTO KFZ VALUES ('M-OC 5447', 12)!
 
Enter command:
INSERT INTO KFZ VALUES ('XQ-BZ 9090', 11)!
 
Enter command:
INSERT INTO KFZ VALUES ('QU-AA 0815', 13)!
 
Enter command:
CREATE TABLE TANKEN (
KENNZEICHEN VARCHAR (20) CONSTRAINT T_K_FK REFERENCES KFZ,
DAT         DATE NOT NULL,
KM          INTEGER CONSTRAINT T_KM_CHECK CHECK (KM > 0),
MENGE       DECIMAL NOT NULL CONSTRAINT T_M_CHECK CHECK (MENGE > 0),
PRIMARY KEY (KENNZEICHEN, KM))!
 
Enter command:
COMMIT RELEASE !
 
Enter command:
FILE CONNECT ( KERN TEST !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST   ISOLATION LEVEL 1 !
 
Enter command:
SET FORMAT EUR !
 
Enter command:
INSERT INTO TANKEN VALUES ('HH-XY 1224', '10.03.1997', 13100, 40)!
 
Enter command:
INSERT INTO TANKEN VALUES ('HH-XY 1224', '11.04.1997', 13800, 40)!
 
Enter command:
INSERT INTO TANKEN VALUES ('XQ-BZ 9090', '13.03.1997', 46720, 55)!
 
Enter command:
INSERT INTO TANKEN VALUES ('XQ-BZ 9090', '17.03.1997', 47320, 65)!
 
Enter command:
INSERT INTO TANKEN VALUES ('M-OC 5447' , '20.02.1997', 12345, 55)!
 
Enter command:
INSERT INTO TANKEN VALUES ('HH-XY 1224', '20.03.1997', 13420, 40)!
 
Enter command:
INSERT INTO TANKEN VALUES ('M-OC 5447' , '20.04.1997', 13870, 62)!
 
Enter command:
INSERT INTO TANKEN VALUES ('HH-XY 1224', '22.02.1997', 12345, 55)!
 
Enter command:
INSERT INTO TANKEN VALUES ('QU-AA 0815', '22.02.1997', 44556, 50)!
 
Enter command:
INSERT INTO TANKEN VALUES ('XQ-BZ 9090', '22.02.1997', 45678, 70)!
 
Enter command:
INSERT INTO TANKEN VALUES ('M-OC 5447' , '22.02.1997',128451, 62)!
 
Enter command:
INSERT INTO TANKEN VALUES ('M-OC 5447' , '22.04.1997', 14350, 58)!
 
Enter command:
INSERT INTO TANKEN VALUES ('QU-AA 0815', '22.04.1997', 45500, 60)!
 
Enter command:
INSERT INTO TANKEN VALUES ('QU-AA 0815', '23.04.1997', 46000, 65)!
 
Enter command:
INSERT INTO TANKEN VALUES ('QU-AA 0815', '24.02.1997',  5000, 65)!
 
Enter command:
INSERT INTO TANKEN VALUES ('HH-XY 1224', '25.02.1997', 12750, 40)!
 
Enter command:
INSERT INTO TANKEN VALUES ('XQ-BZ 9090', '25.02.1997', 45865, 60)!
 
Enter command:
INSERT INTO TANKEN VALUES ('QU-AA 0815', '27.03.1997', 45400, 50)!
 
Enter command:
INSERT INTO TANKEN VALUES ('QU-AA 0815', '27.04.1997', 46400, 60)!
 
Enter command:
INSERT INTO TANKEN VALUES ('XQ-BZ 9090', '28.02.1997', 46223, 50)!
 
Enter command:
INSERT INTO TANKEN VALUES ('M-OC 5447' , '30.03.1997', 13320, 63)!
 
Enter command:
SET FORMAT INTERNAL!
 
Enter command:
ALTER TABLE TANKEN ADD DATUM TIMESTAMP!
 
Enter command:
UPDATE TANKEN SET DATUM = TIMESTAMP (DAT, TIME)!
 
resultcount :                    21
 
Enter command:
COMMIT RELEASE !
 
Enter command:
FILE CONNECT ( KERN TEST !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST   ISOLATION LEVEL 1 !
 
Enter command:
SELECT K.KENNZEICHEN, K.AVG_VERBRAUCH,
T2.DAT AS LETZT_DATUM, T1.DAT AS AKT_DATUM,
DATEDIFF(T1.DAT, T2.DAT) AS TAGE,
T2.KM AS LETZT_KM, T1.KM AS AKT_KM
FROM KFZ K, TANKEN T1, TANKEN T2
WHERE
(T1.KENNZEICHEN = K.KENNZEICHEN) AND
(T2.KENNZEICHEN = K.KENNZEICHEN) AND
(T2.DAT < T1.DAT) AND
(T2.DAT = (SELECT MAX(DAT) FROM TANKEN
 EXCEPT (SELECT MAX(DAT) FROM TANKEN)))!
 
***ERROR    100 Row not found                                              0001
 
Enter command:
FETCH !
 
***ERROR    100 Row not found                                              0001
 
Enter command:
COMMIT RELEASE !
 
Enter command:
FILE CONNECT ( KERN TEST SQLMODE ORACLE !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE ORACLE ISOLATION LEVEL 1 !
 
Enter command:
SELECT K.KENNZEICHEN, K.AVG_VERBRAUCH AVG,
       T.DATUM DATUM_VON, TB.DATUM DATUM_BIS,
    T.DATUM - TB.DATUM TAGE,
    TB.KM KM_VON, T.KM KM_BIS,
    T.KM - TB.KM DISTANZ, T.MENGE,
    ROUND (T.MENGE / (T.KM - TB.KM) * 100, 2) VERBRAUCH,
       ROUND ((T.MENGE / (T.KM - TB.KM) * 100 - K.AVG_VERBRAUCH )
    / K.AVG_VERBRAUCH * 100, 2) "%Abw."
FROM KFZ K, TANKEN T,
       (SELECT MIN (TANK1.DATUM - TANK2.DATUM) MIN_TAGE,
    TANK2.KENNZEICHEN, TANK2.DATUM, TANK2.KM
    FROM TANKEN TANK1, TANKEN TANK2
    WHERE TANK1.KENNZEICHEN = TANK2.KENNZEICHEN
      AND TANK1.DATUM > TANK2.DATUM
   GROUP BY TANK2.KENNZEICHEN, TANK2.DATUM, TANK2.KM) TB
WHERE K.KENNZEICHEN = T.KENNZEICHEN
AND   K.KENNZEICHEN = TB.KENNZEICHEN
AND   T.DATUM > TB.DATUM
AND   T.DATUM - TB.DATUM = TB.MIN_TAGE
AND   ABS(ROUND((T.MENGE / (T.KM - TB.KM) * 100
       / K.AVG_VERBRAUCH - 1) * 100, 2)) > 50 !
 
resultcount :                     0
 
Enter command:
FETCH INTO :A, :B, :C, :D, :E, :F, :G, :H, :I, :J, :K !
 
KENNZEICHEN       :  M-OC 5447
AVG               :      12
DATUM_VON         :  22-FEB-97
DATUM_BIS         :  20-FEB-97
TAGE              :   2.0000000000000000000000000000000000000E+00
KM_VON            :        12345
KM_BIS            :       128451
DISTANZ           :        116106
MENGE             :      62
VERBRAUCH         :   5.0000000000000000000000000000000000000E-02
%Abw.             :  -9.9560000000000000000000000000000000000E+01
-----------------------------------------------------------------
KENNZEICHEN       :  M-OC 5447
AVG               :      12
DATUM_VON         :  30-MAR-97
DATUM_BIS         :  22-FEB-97
TAGE              :   3.6000000000000000000000000000000000000E+01
KM_VON            :       128451
KM_BIS            :        13320
DISTANZ           :       -115131
MENGE             :      63
VERBRAUCH         :  -5.0000000000000000000000000000000000000E-02
%Abw.             :  -1.0046000000000000000000000000000000000E+02
-----------------------------------------------------------------
KENNZEICHEN       :  QU-AA 0815
AVG               :      13
DATUM_VON         :  24-FEB-97
DATUM_BIS         :  22-FEB-97
TAGE              :   2.0000000000000000000000000000000000000E+00
KM_VON            :        44556
KM_BIS            :         5000
DISTANZ           :        -39556
MENGE             :      65
VERBRAUCH         :  -1.6000000000000000000000000000000000000E-01
%Abw.             :  -1.0126000000000000000000000000000000000E+02
-----------------------------------------------------------------
KENNZEICHEN       :  QU-AA 0815
AVG               :      13
DATUM_VON         :  27-MAR-97
DATUM_BIS         :  24-FEB-97
TAGE              :   3.1000000000000000000000000000000000000E+01
KM_VON            :         5000
KM_BIS            :        45400
DISTANZ           :         40400
MENGE             :      50
VERBRAUCH         :   1.2000000000000000000000000000000000000E-01
%Abw.             :  -9.9050000000000000000000000000000000000E+01
-----------------------------------------------------------------
KENNZEICHEN       :  QU-AA 0815
AVG               :      13
DATUM_VON         :  22-APR-97
DATUM_BIS         :  27-MAR-97
TAGE              :   2.6000000000000000000000000000000000000E+01
KM_VON            :        45400
KM_BIS            :        45500
DISTANZ           :           100
MENGE             :      60
VERBRAUCH         :   6.0000000000000000000000000000000000000E+01
%Abw.             :   3.6154000000000000000000000000000000000E+02
-----------------------------------------------------------------
KENNZEICHEN       :  XQ-BZ 9090
AVG               :      11
DATUM_VON         :  25-FEB-97
DATUM_BIS         :  22-FEB-97
TAGE              :   3.0000000000000000000000000000000000000E+00
KM_VON            :        45678
KM_BIS            :        45865
DISTANZ           :           187
MENGE             :      60
VERBRAUCH         :   3.2090000000000000000000000000000000000E+01
%Abw.             :   1.9169000000000000000000000000000000000E+02
 
resultcount :                     6
 
Enter command:
DROP TABLE TANKEN !
 
Enter command:
DROP TABLE KFZ !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST SQLMODE ORACLE !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE ORACLE ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE ARTIKEL (
ART_NR      INTEGER CONSTRAINT ARTIKEL_PK PRIMARY KEY,
BEZEICHNUNG VARCHAR (20) NOT NULL)!
 
Enter command:
INSERT INTO ARTIKEL VALUES (1, 'Apfelsaft')!
 
Enter command:
INSERT INTO ARTIKEL VALUES (2, 'Orangensaft')!
 
Enter command:
COMMIT WORK !
 
Enter command:
CREATE TABLE FLASCHEN (
FL_NR        INTEGER CONSTRAINT FLASCHEN_PK PRIMARY KEY,
BEZEICHNUNG  VARCHAR (20) NOT NULL,
INHALT       DECIMAL (5,2) NOT NULL
             CONSTRAINT INHALT_CHECK CHECK (INHALT > 0))!
 
Enter command:
INSERT INTO FLASCHEN VALUES (1, 'Pfandflasche', 1.0)!
 
Enter command:
INSERT INTO FLASCHEN VALUES (2, 'Flschchen'  , 0.2)!
 
Enter command:
INSERT INTO FLASCHEN VALUES (3, 'Halber'      , 0.5)!
 
Enter command:
COMMIT WORK !
 
Enter command:
CREATE TABLE KUNDEN (
KN_NR INTEGER CONSTRAINT KUNDEN_PK PRIMARY KEY,
NAME  VARCHAR (20) NOT NULL)!
 
Enter command:
INSERT INTO KUNDEN VALUES (1, 'Durstig')!
 
Enter command:
INSERT INTO KUNDEN VALUES (2, 'Saufaus')!
 
Enter command:
COMMIT WORK !
 
Enter command:
CREATE TABLE BESTELLUNG (
BESTELL_NR   INTEGER CONSTRAINT BESTELLUNG_PK PRIMARY KEY,
KD_NR        INTEGER
              CONSTRAINT BEST_KD_FK REFERENCES KUNDEN NOT NULL,
LIEFER_DATUM DATE NOT NULL)!
 
Enter command:
INSERT INTO BESTELLUNG VALUES (1, 1, '01-JAN-97')!
 
Enter command:
INSERT INTO BESTELLUNG VALUES (2, 1, '01-MAY-97')!
 
Enter command:
INSERT INTO BESTELLUNG VALUES (3, 1, '11-DEC-97')!
 
Enter command:
INSERT INTO BESTELLUNG VALUES (4, 2, '22-JUN-97')!
 
Enter command:
INSERT INTO BESTELLUNG VALUES (5, 2, '21-AUG-97')!
 
Enter command:
INSERT INTO BESTELLUNG VALUES (6, 1, '20-DEC-97')!
 
Enter command:
INSERT INTO BESTELLUNG VALUES (7, 2, '24-DEC-97')!
 
Enter command:
COMMIT WORK !
 
Enter command:
CREATE TABLE BESTELL_POS (
BESTELL_NR INTEGER,
POS        INTEGER,
ART_NR     INTEGER NOT NULL CONSTRAINT BP_ART_FK REFERENCES ARTIKEL,
FL_NR      INTEGER NOT NULL CONSTRAINT BP_FLA_FK REFERENCES FLASCHEN,
MENGE      INTEGER NOT NULL CONSTRAINT MENGE_CHECK CHECK (MENGE > 0),
CONSTRAINT BESTELL_POS_PK PRIMARY KEY (BESTELL_NR, POS),
CONSTRAINT BES_POS_U1 UNIQUE (BESTELL_NR, ART_NR, FL_NR))!
 
Enter command:
INSERT INTO BESTELL_POS VALUES (1,1,1,1, 100)!
 
Enter command:
INSERT INTO BESTELL_POS VALUES (1,2,2,3,  20)!
 
Enter command:
INSERT INTO BESTELL_POS VALUES (1,3,1,2, 200)!
 
Enter command:
INSERT INTO BESTELL_POS VALUES (2,1,2,2, 200)!
 
Enter command:
INSERT INTO BESTELL_POS VALUES (2,2,1,3,  15)!
 
Enter command:
INSERT INTO BESTELL_POS VALUES (2,3,2,1,  22)!
 
Enter command:
INSERT INTO BESTELL_POS VALUES (3,1,1,1,  11)!
 
Enter command:
INSERT INTO BESTELL_POS VALUES (3,2,2,1,  33)!
 
Enter command:
INSERT INTO BESTELL_POS VALUES (3,3,1,2,  44)!
 
Enter command:
INSERT INTO BESTELL_POS VALUES (3,4,1,3,  25)!
 
Enter command:
INSERT INTO BESTELL_POS VALUES (3,5,2,2,  37)!
 
Enter command:
INSERT INTO BESTELL_POS VALUES (3,6,2,3, 234)!
 
Enter command:
INSERT INTO BESTELL_POS VALUES (4,1,1,1,1111)!
 
Enter command:
INSERT INTO BESTELL_POS VALUES (4,2,2,2, 222)!
 
Enter command:
INSERT INTO BESTELL_POS VALUES (5,1,1,3, 234)!
 
Enter command:
INSERT INTO BESTELL_POS VALUES (6,1,2,3,1000)!
 
Enter command:
INSERT INTO BESTELL_POS VALUES (6,2,2,2, 100)!
 
Enter command:
INSERT INTO BESTELL_POS VALUES (7,1,1,1, 300)!
 
Enter command:
INSERT INTO BESTELL_POS VALUES (7,2,1,2, 300)!
 
Enter command:
INSERT INTO BESTELL_POS VALUES (7,3,1,3, 200)!
 
Enter command:
COMMIT WORK !
 
Enter command:
CREATE TABLE PRODUKTION (
ART_NR      INTEGER,
PROD_DATUM  DATE,
MENGE       DECIMAL (10,2) NOT NULL
             CONSTRAINT PROD_MENGE_CHECK CHECK (MENGE > 0),
CONSTRAINT PRODUKTION_PK PRIMARY KEY (ART_NR, PROD_DATUM))!
 
Enter command:
INSERT INTO PRODUKTION VALUES (1,'01-OCT-97',1000)!
 
Enter command:
INSERT INTO PRODUKTION VALUES (2,'01-OCT-97', 677)!
 
Enter command:
COMMIT WORK !
 
Enter command:
SELECT BP.ART_NR, BP.FL_NR,
       TO_CHAR(ROUND(SUM (BP.MENGE * F.INHALT) /
             SUM.SUMME * 100, 2), '99.99') PROZENT,
       TO_CHAR(ROUND(SUM (BP.MENGE * F.INHALT) /
             SUM.SUMME * P.MENGE), '9999') MENGE,
       TO_CHAR(ROUND(SUM (BP.MENGE * F.INHALT) /
             SUM.SUMME * P.MENGE / F.INHALT), '9999') FLASCHEN
  FROM BESTELL_POS BP,
       FLASCHEN F,
       PRODUKTION P,
       (SELECT BP.ART_NR,
               SUM (BP.MENGE * F.INHALT) SUMME
          FROM BESTELL_POS BP, FLASCHEN F
         WHERE BP.FL_NR = F.FL_NR
         GROUP BY BP.ART_NR)                      SUM
 WHERE BP.ART_NR = SUM.ART_NR
   AND BP.FL_NR  = F.FL_NR
   AND BP.ART_NR = P.ART_NR
   AND P.PROD_DATUM = '01-OCT-97'
 GROUP BY BP.ART_NR, BP.FL_NR, SUM.SUMME,
               F.INHALT, P.MENGE !
 
resultcount :                     0
 
Enter command:
FETCH INTO :A, :B, :C, :D, :E !
 
ART_NR                | FL_NR                 | PROZENT | MENGE | FLASCHEN
----------------------+-----------------------+---------+-------+---------
                    1 |                     1 |  81.49  |   815 |   815
                    1 |                     2 |   5.83  |    58 |   291
                    1 |                     3 |  12.69  |   127 |   254
                    2 |                     1 |   6.93  |    47 |    47
                    2 |                     2 |  14.08  |    95 |   477
                    2 |                     3 |  78.99  |   535 |  1069
 
resultcount :                     6
 
Enter command:
DROP TABLE ARTIKEL !
 
Enter command:
DROP TABLE FLASCHEN !
 
Enter command:
DROP TABLE KUNDEN !
 
Enter command:
DROP TABLE BESTELLUNG !
 
Enter command:
DROP TABLE BESTELL_POS !
 
Enter command:
DROP TABLE PRODUKTION !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST SQLMODE ORACLE !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE ORACLE ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE MESSUNGEN (
MESSUNG INTEGER CONSTRAINT MESSUNG_PK PRIMARY KEY,
WERT    DECIMAL (4,1) NOT NULL)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES ( 4, 11.3)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES ( 6, 11.7)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES ( 2, 12.2)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES ( 9, 12.8)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (11, 12.9)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (13, 13.3)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES ( 5, 13.4)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (18, 13.4)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES ( 8, 13.9)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (15, 13.9)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (20, 13.9)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (17, 14.0)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (10, 14.3)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (22, 14.5)!
 
Enter command:
INSERT INTO MESSUNGEN VALUES (25, 15.0)!
 
Enter command:
COMMIT RELEASE !
 
Enter command:
FILE CONNECT ( KERN TEST !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST   ISOLATION LEVEL 1 !
 
Enter command:
SELECT M1.MESSUNG, M1.WERT, FIXED(ROUND (AVG(M2.WERT),2),4,2),
       FIXED(ROUND((AVG(M2.WERT) - M1.WERT) * 100 / AVG(M2.WERT), 2),4,2)
FROM
           (SELECT ROWNO NR1, MESSUNG, WERT
              FROM MESSUNGEN
     GROUP BY MESSUNG, WERT) M1,
           (SELECT ROWNO NR2, MESSUNG, WERT
              FROM MESSUNGEN
     GROUP BY MESSUNG, WERT) M2
WHERE M2.NR2 BETWEEN M1.NR1-3 AND M1.NR1+3
GROUP BY M1.MESSUNG, M1.WERT
HAVING ABS(ROUND((AVG(M2.WERT) - M1.WERT) * 100 / AVG(M2.WERT), 2)) > 5!
 
resultcount :                     7
 
Enter command:
FETCH INTO :A, :B, :C, :D !
 
MESSUNG               | WERT   | EXPRESSION1 | EXPRESSION2
----------------------+--------+-------------+------------
                    4 |   11.3 |  12.50      |   9.60
                    5 |   13.4 |  12.55      |  -6.77
                    6 |   11.7 |  12.80      |   8.59
                    8 |   13.9 |  12.90      |  -7.75
                   10 |   14.3 |  13.26      |  -7.87
                   11 |   12.9 |  13.59      |   5.05
                   25 |   15.0 |  14.20      |  -5.63
 
resultcount :                     7
 
Enter command:
SELECT M1.MESSUNG, M1.WERT,
       FIXED(ROUND(AVG (M2.WERT), 2),4,2) AVGR,
       FIXED(ROUND((AVG(M2.WERT) - M1.WERT) /
                    AVG (M2.WERT) * 100, 2),4,2) ABW
  FROM MESSUNGEN M1, MESSUNGEN M2
 WHERE M1.MESSUNG <= M2.MESSUNG
   AND 4 >= (SELECT COUNT (*)
               FROM MESSUNGEN MI
              WHERE MI.MESSUNG BETWEEN M1.MESSUNG AND M2.MESSUNG
            )
    OR
       M1.MESSUNG >= M2.MESSUNG
   AND 4 >= (SELECT COUNT (*)
               FROM MESSUNGEN MI
              WHERE MI.MESSUNG BETWEEN M2.MESSUNG AND M1.MESSUNG
            )
 GROUP BY M1.MESSUNG, M1.WERT
HAVING ROUND ((AVG(M2.WERT) - M1.WERT) /
               AVG(M2.WERT) * 100, 2)
       NOT BETWEEN -5 AND 5 !
 
resultcount :                     7
 
Enter command:
FETCH INTO :A, :B, :C, :D !
 
MESSUNG               | WERT   | AVGR   | ABW
----------------------+--------+--------+-------
                    4 |   11.3 |  12.50 |   9.60
                    5 |   13.4 |  12.55 |  -6.77
                    6 |   11.7 |  12.80 |   8.59
                    8 |   13.9 |  12.90 |  -7.75
                   10 |   14.3 |  13.26 |  -7.87
                   11 |   12.9 |  13.59 |   5.05
                   25 |   15.0 |  14.20 |  -5.63
 
resultcount :                     7
 
Enter command:
SELECT C.MESSUNG1 AS MESSUNG,
       ROUND(C.WERT1,1) AS WERT,
       FIXED(ROUND(AVG(C.WERT2),2),4,2) AS AVGR,
       FIXED(ROUND(100-(C.WERT1*100 / AVG(C.WERT2)),2),4,2) AS ABW
  FROM (SELECT B.MESSUNG AS MESSUNG1, B.WERT AS WERT1,
               A.MESSUNG AS MESSUNG2, A.WERT AS WERT2
          FROM MESSUNGEN A, MESSUNGEN B
         WHERE A.MESSUNG = B.MESSUNG
        UNION
        SELECT B.MESSUNG AS MESSUNG1, B.WERT AS WERT1,
               A.MESSUNG AS MESSUNG2, A.WERT AS WERT2
          FROM MESSUNGEN A, MESSUNGEN B
         WHERE A.MESSUNG =
               (SELECT MIN(MESSUNG)
                  FROM MESSUNGEN
                 WHERE MESSUNG > B.MESSUNG)
        UNION
        SELECT B.MESSUNG AS MESSUNG1, B.WERT AS WERT1,
               A.MESSUNG AS MESSUNG2, A.WERT AS WERT2
          FROM MESSUNGEN A, MESSUNGEN B
         WHERE A.MESSUNG =
               (SELECT MIN(MESSUNG)
                  FROM MESSUNGEN
                 WHERE MESSUNG >
                       (SELECT MIN(MESSUNG)
                          FROM MESSUNGEN
                         WHERE MESSUNG > B.MESSUNG))
        UNION
        SELECT B.MESSUNG AS MESSUNG1, B.WERT AS WERT1,
               A.MESSUNG AS MESSUNG2, A.WERT AS WERT2
          FROM MESSUNGEN A, MESSUNGEN B
         WHERE A.MESSUNG =
               (SELECT MIN(MESSUNG)
                  FROM MESSUNGEN
                 WHERE MESSUNG >
                       (SELECT MIN(MESSUNG)
                          FROM MESSUNGEN
                         WHERE MESSUNG >
                               (SELECT MIN(MESSUNG)
                                  FROM MESSUNGEN
                                 WHERE MESSUNG > B.MESSUNG)))
        UNION
        SELECT B.MESSUNG AS MESSUNG1, B.WERT AS WERT1,
               A.MESSUNG AS MESSUNG2, A.WERT AS WERT2
          FROM MESSUNGEN A, MESSUNGEN B
         WHERE A.MESSUNG =
               (SELECT MAX(MESSUNG)
                  FROM MESSUNGEN
                 WHERE MESSUNG < B.MESSUNG)
        UNION
        SELECT B.MESSUNG AS MESSUNG1, B.WERT AS WERT1,
               A.MESSUNG AS MESSUNG2, A.WERT AS WERT2
          FROM MESSUNGEN A, MESSUNGEN B
         WHERE A.MESSUNG =
               (SELECT MAX(MESSUNG)
                  FROM MESSUNGEN
                 WHERE MESSUNG <
                       (SELECT MAX(MESSUNG)
                          FROM MESSUNGEN
                         WHERE MESSUNG < B.MESSUNG))
        UNION
        SELECT B.MESSUNG AS MESSUNG1, B.WERT AS WERT1,
               A.MESSUNG AS MESSUNG2, A.WERT AS WERT2
          FROM MESSUNGEN A, MESSUNGEN B
         WHERE A.MESSUNG =
               (SELECT MAX(MESSUNG)
                  FROM MESSUNGEN
                 WHERE MESSUNG <
                       (SELECT MAX(MESSUNG)
                          FROM MESSUNGEN
                         WHERE MESSUNG <
                               (SELECT MAX(MESSUNG)
                                  FROM MESSUNGEN
                                 WHERE MESSUNG < B.MESSUNG)))
         ) C
GROUP BY MESSUNG1,WERT1
HAVING ABS(100-(C.WERT1*100/AVG(C.WERT2))) > 5!
 
resultcount :                     7
 
Enter command:
FETCH INTO :A, :B, :C, :D !
 
MESSUNG               | WERT   | AVGR   | ABW
----------------------+--------+--------+-------
                    4 |   11.3 |  12.50 |   9.60
                    5 |   13.4 |  12.55 |  -6.77
                    6 |   11.7 |  12.80 |   8.59
                    8 |   13.9 |  12.90 |  -7.75
                   10 |   14.3 |  13.26 |  -7.87
                   11 |   12.9 |  13.59 |   5.05
                   25 |   15.0 |  14.20 |  -5.63
 
resultcount :                     7
 
Enter command:
DROP TABLE MESSUNGEN !
 
Enter command:
COMMIT RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST   ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE PERSONEN (
P_ID INTEGER PRIMARY KEY,
NAME CHAR (10) NOT NULL)!
 
Enter command:
INSERT INTO PERSONEN VALUES (1, 'Golf')!
 
Enter command:
INSERT INTO PERSONEN VALUES (2, 'John')!
 
Enter command:
INSERT INTO PERSONEN VALUES (3, 'Peter')!
 
Enter command:
COMMIT !
 
Enter command:
CREATE TABLE ACCOUNTING (
LOGIN_ID INTEGER PRIMARY KEY,
P_ID     INTEGER NOT NULL REFERENCES PERSONEN,
LOGIN    TIMESTAMP NOT NULL,
LOGOUT   TIMESTAMP NOT NULL,
CONSTRAINT DATE_CHECK CHECK (LOGIN < LOGOUT))!
 
Enter command:
INSERT INTO ACCOUNTING VALUES
 ( 1,1,'19971210100000000000','19971210120000000000')!
 
Enter command:
INSERT INTO ACCOUNTING VALUES
 ( 2,1,'19971210110000000000','19971210140000000000')!
 
Enter command:
INSERT INTO ACCOUNTING VALUES
 ( 3,1,'19971210150000000000','19971210190000000000')!
 
Enter command:
INSERT INTO ACCOUNTING VALUES
 ( 4,1,'19971210150000000000','19971210160000000000')!
 
Enter command:
INSERT INTO ACCOUNTING VALUES
 ( 5,1,'19971210170000000000','19971210180000000000')!
 
Enter command:
INSERT INTO ACCOUNTING VALUES
 ( 6,2,'19971210090000000000','19971210130000000000')!
 
Enter command:
INSERT INTO ACCOUNTING VALUES
 ( 7,2,'19971210150000000000','19971210160000000000')!
 
Enter command:
INSERT INTO ACCOUNTING VALUES
 ( 8,2,'19971210150000000000','19971210160000000000')!
 
Enter command:
INSERT INTO ACCOUNTING VALUES
 ( 9,3,'19971210100000000000','19971210140000000000')!
 
Enter command:
INSERT INTO ACCOUNTING VALUES
 (10,3,'19971210130000000000','19971210150000000000')!
 
Enter command:
INSERT INTO ACCOUNTING VALUES
 (11,3,'19971210130000000000','19971210150000000000')!
 
Enter command:
INSERT INTO ACCOUNTING VALUES
 (12,3,'19971210150000000000','19971210170000000000')!
 
Enter command:
COMMIT WORK !
 
Enter command:
CREATE TABLE PREISE (
ANZAHL INTEGER PRIMARY KEY,
BETRAG DECIMAL (10,2) NOT NULL)!
 
Enter command:
INSERT INTO PREISE VALUES (1, 1.00)!
 
Enter command:
INSERT INTO PREISE VALUES (2, 0.70)!
 
Enter command:
INSERT INTO PREISE VALUES (3, 0.55)!
 
Enter command:
INSERT INTO PREISE VALUES (4, 0.45)!
 
Enter command:
INSERT INTO PREISE VALUES (5, 0.40)!
 
Enter command:
COMMIT WORK !
 
Enter command:
SELECT P.NAME, A.LOGIN_ID, MAX(PR.BETRAG)
  FROM PERSONEN P,
       ACCOUNTING A,
       PREISE PR
 WHERE P.P_ID = A.P_ID
   AND PR.ANZAHL >= ALL
                (SELECT COUNT (*)
                   FROM ACCOUNTING A1,
                        ACCOUNTING A2
                  WHERE A1.LOGIN >= A.LOGIN
                    AND A1.LOGIN <  A.LOGOUT
                    AND A1.LOGIN >= A2.LOGIN
                    AND A1.LOGIN <  A2.LOGOUT
                    AND A1.P_ID  =  P.P_ID
                    AND A1.P_ID  =  A2.P_ID
                 GROUP BY A1.LOGIN_ID)
GROUP BY P.NAME, A.LOGIN_ID !
 
resultcount :                    12
 
Enter command:
FETCH INTO :A, :B, :C !
 
NAME       | LOGIN_ID    | EXPRESSION1
-----------+-------------+-------------
Golf       |           1 |         0.70
Golf       |           2 |         0.70
Golf       |           3 |         0.70
Golf       |           4 |         0.70
Golf       |           5 |         0.70
John       |           6 |         1.00
John       |           7 |         0.70
John       |           8 |         0.70
Peter      |           9 |         0.55
Peter      |          10 |         0.55
Peter      |          11 |         0.55
Peter      |          12 |         1.00
 
resultcount :                    12
 
Enter command:
DROP TABLE PERSONEN !
 
Enter command:
DROP TABLE ACCOUNTING !
 
Enter command:
DROP TABLE PREISE !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
FILE CONNECT ( SUT SUT !
 
Enter command:
CONNECT SUT IDENTIFIED BY SUT   ISOLATION LEVEL 1 !
 
Enter command:
DROP USER KERN !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( SUT SUT !
 
Enter command:
CONNECT SUT IDENTIFIED BY SUT   ISOLATION LEVEL 1 !
 
Enter command:
CREATE USER KERN PASSWORD TEST DBA NOT EXCLUSIVE !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST SQLMODE ORACLE !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE ORACLE ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE STEUERKLASSE (
KLASSE       INTEGER CONSTRAINT STEUERKLASSE_PK PRIMARY KEY,
BESCHREIBUNG VARCHAR (30))!
 
Enter command:
INSERT INTO STEUERKLASSE VALUES (1, 'Alleinstehend')!
 
Enter command:
INSERT INTO STEUERKLASSE VALUES (2, 'Alleinerziehend')!
 
Enter command:
INSERT INTO STEUERKLASSE VALUES (3, 'Verheiratet')!
 
Enter command:
COMMIT WORK!
 
Enter command:
CREATE TABLE EINKOMMEN (
NAME   VARCHAR (10) CONSTRAINT EINKOMMEN_PK PRIMARY KEY,
KLASSE INTEGER NOT NULL
         CONSTRAINT EIN_KLASSE_FK REFERENCES STEUERKLASSE,
BETRAG DECIMAL NOT NULL)!
 
Enter command:
INSERT INTO EINKOMMEN VALUES ('Mayer',   1, 32123)!
 
Enter command:
INSERT INTO EINKOMMEN VALUES ('Schmidt', 2, 33333)!
 
Enter command:
INSERT INTO EINKOMMEN VALUES ('Franz',   3, 34567)!
 
Enter command:
INSERT INTO EINKOMMEN VALUES ('Fredl',   2, 39876)!
 
Enter command:
COMMIT WORK !
 
Enter command:
CREATE TABLE STEUER (
KLASSE        INTEGER NOT NULL
              CONSTRAINT STEUER_KLASSE_FK REFERENCES STEUERKLASSE,
OBER_GRENZE   DECIMAL NOT NULL
              CONSTRAINT ST_OBER_CHECK CHECK (OBER_GRENZE > 0),
STEUER_BETRAG DECIMAL NOT NULL
              CONSTRAINT ST_BETRAG_CHECK CHECK (STEUER_BETRAG >= 0))!
 
Enter command:
INSERT INTO STEUER VALUES (1,31000, 7610)!
 
Enter command:
INSERT INTO STEUER VALUES (1,32000, 8240)!
 
Enter command:
INSERT INTO STEUER VALUES (1,33000, 8890)!
 
Enter command:
INSERT INTO STEUER VALUES (1,34000, 9560)!
 
Enter command:
INSERT INTO STEUER VALUES (1,35000,10250)!
 
Enter command:
INSERT INTO STEUER VALUES (1,36000,10960)!
 
Enter command:
INSERT INTO STEUER VALUES (1,37000,11690)!
 
Enter command:
INSERT INTO STEUER VALUES (1,38000,12440)!
 
Enter command:
INSERT INTO STEUER VALUES (1,39000,13210)!
 
Enter command:
INSERT INTO STEUER VALUES (1,40000,14000)!
 
Enter command:
INSERT INTO STEUER VALUES (2,31000, 6370)!
 
Enter command:
INSERT INTO STEUER VALUES (2,32000, 6960)!
 
Enter command:
INSERT INTO STEUER VALUES (2,33000, 7570)!
 
Enter command:
INSERT INTO STEUER VALUES (2,34000, 8200)!
 
Enter command:
INSERT INTO STEUER VALUES (2,35000, 8850)!
 
Enter command:
INSERT INTO STEUER VALUES (2,36000, 9520)!
 
Enter command:
INSERT INTO STEUER VALUES (2,37000,10210)!
 
Enter command:
INSERT INTO STEUER VALUES (2,38000,10920)!
 
Enter command:
INSERT INTO STEUER VALUES (2,39000,11650)!
 
Enter command:
INSERT INTO STEUER VALUES (2,40000,12400)!
 
Enter command:
INSERT INTO STEUER VALUES (3,31000, 5715)!
 
Enter command:
INSERT INTO STEUER VALUES (3,32000, 6210)!
 
Enter command:
INSERT INTO STEUER VALUES (3,33000, 6735)!
 
Enter command:
INSERT INTO STEUER VALUES (3,34000, 7290)!
 
Enter command:
INSERT INTO STEUER VALUES (3,35000, 7875)!
 
Enter command:
INSERT INTO STEUER VALUES (3,36000, 8490)!
 
Enter command:
INSERT INTO STEUER VALUES (3,37000, 9135)!
 
Enter command:
INSERT INTO STEUER VALUES (3,38000, 9810)!
 
Enter command:
INSERT INTO STEUER VALUES (3,39000,10515)!
 
Enter command:
INSERT INTO STEUER VALUES (3,40000,11250)!
 
Enter command:
COMMIT WORK !
 
Enter command:
SELECT E.NAME, TO_CHAR(E.KLASSE, '9'), TO_CHAR(E.BETRAG,'99999'),
       TO_CHAR(ST1.STEUER_BETRAG, '99999') STEUER_MIN,
       TO_CHAR(ST2.STEUER_BETRAG, '99999') STEUER_MAX,
       TO_CHAR(ROUND(
       ST1.STEUER_BETRAG +
       ((E.BETRAG - ST1.OBER_GRENZE) *
        (ST2.STEUER_BETRAG - ST1.STEUER_BETRAG)) /
       ( ST2.OBER_GRENZE - ST1.OBER_GRENZE), 2), '99999.99') STEUER
  FROM EINKOMMEN E,
       STEUER ST1,
       STEUER ST2
 WHERE E.KLASSE = ST1.KLASSE
   AND E.KLASSE = ST2.KLASSE
   AND ST1.OBER_GRENZE = (SELECT MAX(OBER_GRENZE)
                            FROM STEUER SX
                           WHERE E.BETRAG > SX.OBER_GRENZE
                             AND E.KLASSE = SX.KLASSE
                         )
   AND ST2.OBER_GRENZE = (SELECT MIN(OBER_GRENZE)
                            FROM STEUER SY
                           WHERE E.BETRAG < SY.OBER_GRENZE
                             AND E.KLASSE = SY.KLASSE
                         ) !
 
resultcount :                     0
 
Enter command:
FETCH INTO :A, :B, :C, :D, :E, :F !
 
NAME       | EXPRESSION1 | EXPRESSION2 | STEUER_MIN | STEUER_MAX | STEUER
-----------+-------------+-------------+------------+------------+----------
Mayer      |  1          |  32123      |   8240     |   8890     |   8319.95
Schmidt    |  2          |  33333      |   7570     |   8200     |   7779.79
Franz      |  3          |  34567      |   7290     |   7875     |   7621.70
Fredl      |  2          |  39876      |  11650     |  12400     |  12307.00
 
resultcount :                     4
 
Enter command:
SELECT E.NAME, TO_CHAR(E.KLASSE, '9'), TO_CHAR(E.BETRAG,'99999'),
       TO_CHAR (MAX (S2.STEUER_BETRAG), '99999') STEUER_MIN,
       TO_CHAR (MIN (S1.STEUER_BETRAG), '99999') STEUER_MAX,
       TO_CHAR (ROUND (
       MAX (S2.STEUER_BETRAG) +
       (MIN (S1.STEUER_BETRAG) - MAX (S2.STEUER_BETRAG)) /
       (MIN (S1.OBER_GRENZE) - MAX (S2.OBER_GRENZE)) *
       (E.BETRAG - MAX (S2.OBER_GRENZE)), 2), '99999.99') STEUER
  FROM EINKOMMEN E, STEUER S1, STEUER S2
 WHERE E.KLASSE = S1.KLASSE
   AND E.BETRAG <= S1.OBER_GRENZE
   AND E.KLASSE = S2.KLASSE
   AND E.BETRAG >= S2.OBER_GRENZE
GROUP BY E.NAME, E.KLASSE, E.BETRAG !
 
resultcount :                     0
 
Enter command:
FETCH INTO :A, :B, :C, :D, :E, :F !
 
NAME       | EXPRESSION1 | EXPRESSION2 | STEUER_MIN | STEUER_MAX | STEUER
-----------+-------------+-------------+------------+------------+----------
Franz      |  3          |  34567      |   7290     |   7875     |   7621.70
Fredl      |  2          |  39876      |  11650     |  12400     |  12307.00
Mayer      |  1          |  32123      |   8240     |   8890     |   8319.95
Schmidt    |  2          |  33333      |   7570     |   8200     |   7779.79
 
resultcount :                     4
 
Enter command:
DROP TABLE STEUERKLASSE!
 
Enter command:
DROP TABLE EINKOMMEN !
 
Enter command:
DROP TABLE STEUER !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST SQLMODE ORACLE !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE ORACLE ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE PERSONEN (
P_ID    INTEGER CONSTRAINT PERSONEN_PK PRIMARY KEY,
NAME    CHAR (10) NOT NULL,
GEB_DAT DATE NOT NULL)!
 
Enter command:
INSERT INTO PERSONEN VALUES ( 6, 'Albrecht ', '11-APR_67')!
 
Enter command:
INSERT INTO PERSONEN VALUES ( 8, 'Baader   ', '20-JUN_55')!
 
Enter command:
INSERT INTO PERSONEN VALUES (12, 'Hessen   ', '11-JAN_71')!
 
Enter command:
INSERT INTO PERSONEN VALUES ( 1, 'Jansen   ', '01-JAN_65')!
 
Enter command:
INSERT INTO PERSONEN VALUES ( 2, 'Johannsen', '02-FEB_66')!
 
Enter command:
INSERT INTO PERSONEN VALUES ( 3, 'Lenze    ', '05-AUG_60')!
 
Enter command:
INSERT INTO PERSONEN VALUES ( 7, 'Linke    ', '30-JUL_49')!
 
Enter command:
INSERT INTO PERSONEN VALUES ( 9, 'Orterer  ', '18-JAN_70')!
 
Enter command:
INSERT INTO PERSONEN VALUES (11, 'Pape     ', '20-JUN_55')!
 
Enter command:
INSERT INTO PERSONEN VALUES ( 4, 'Raupp    ', '09-SEP_58')!
 
Enter command:
INSERT INTO PERSONEN VALUES (10, 'Smith    ', '19-FEB_66')!
 
Enter command:
INSERT INTO PERSONEN VALUES ( 5, 'Weiss    ', '22-MAR_51')!
 
Enter command:
PARS_THEN_EX !
 
Enter command:
DATA !
 
Enter command:
SELECT TO_CHAR(P1.P_ID, '99') P_ID,
       P1.NAME,
       P1.GEB_DAT,
       COUNT(*) NUMMER,
       TO_CHAR (TRUNC (:ANZAHL_GRUPPEN * (COUNT(*) - 1) /
                 P_ANZ.ANZAHL) + 1, '99') GRUPPE
  FROM PERSONEN P1, PERSONEN P2,
       (SELECT COUNT(*) ANZAHL FROM PERSONEN) P_ANZ
 WHERE P2.GEB_DAT < P1.GEB_DAT
    OR (P2.GEB_DAT = P1.GEB_DAT AND
        P2.P_ID <= P1.P_ID)
GROUP BY P1.GEB_DAT, P1.P_ID, P1.NAME, P_ANZ.ANZAHL !
 
n 38 4
 
resultcount :                     0
 
Enter command:
FETCH INTO :A, :B, :C, :D, :E !
 
P_ID | NAME       | GEB_DAT                    | NUMMER      | GRUPPE
-----+------------+----------------------------+-------------+-------
  7  | Linke      | 30-JUL-49                  |           1 |   1
  5  | Weiss      | 22-MAR-51                  |           2 |   1
  8  | Baader     | 20-JUN-55                  |           3 |   1
 11  | Pape       | 20-JUN-55                  |           4 |   2
  4  | Raupp      | 09-SEP-58                  |           5 |   2
  3  | Lenze      | 05-AUG-60                  |           6 |   2
  1  | Jansen     | 01-JAN-65                  |           7 |   3
  2  | Johannsen  | 02-FEB-66                  |           8 |   3
 10  | Smith      | 19-FEB-66                  |           9 |   3
  6  | Albrecht   | 11-APR-67                  |          10 |   4
  9  | Orterer    | 18-JAN-70                  |          11 |   4
 12  | Hessen     | 11-JAN-71                  |          12 |   4
 
resultcount :                    12
 
Enter command:
SELECT TO_CHAR(P1.P_ID, '99') P_ID,
       P1.NAME,
       P1.GEB_DAT,
       COUNT(DISTINCT P2.P_ID) NUMMER,
       TO_CHAR (TRUNC ((COUNT (DISTINCT P2.P_ID) - 1) /
                (COUNT (DISTINCT P3.P_ID) /
                :ANZAHL_GRUPPEN)) + 1, '99') GRUPPE
  FROM PERSONEN P1, PERSONEN P2, PERSONEN P3
 WHERE P2.GEB_DAT < P1.GEB_DAT
    OR (P2.GEB_DAT = P1.GEB_DAT AND
        P2.P_ID <= P1.P_ID)
GROUP BY P1.P_ID, P1.NAME, P1.GEB_DAT
ORDER BY P1.GEB_DAT !
 
n 38 5
 
resultcount :                     0
 
Enter command:
FETCH INTO :A, :B, :C, :D, :E !
 
P_ID | NAME       | GEB_DAT                    | NUMMER      | GRUPPE
-----+------------+----------------------------+-------------+-------
  7  | Linke      | 30-JUL-49                  |           1 |   1
  5  | Weiss      | 22-MAR-51                  |           2 |   1
  8  | Baader     | 20-JUN-55                  |           3 |   1
 11  | Pape       | 20-JUN-55                  |           4 |   2
  4  | Raupp      | 09-SEP-58                  |           5 |   2
  3  | Lenze      | 05-AUG-60                  |           6 |   3
  1  | Jansen     | 01-JAN-65                  |           7 |   3
  2  | Johannsen  | 02-FEB-66                  |           8 |   3
 10  | Smith      | 19-FEB-66                  |           9 |   4
  6  | Albrecht   | 11-APR-67                  |          10 |   4
  9  | Orterer    | 18-JAN-70                  |          11 |   5
 12  | Hessen     | 11-JAN-71                  |          12 |   5
 
resultcount :                    12
 
Enter command:
PARS_EXECUTE!
 
Enter command:
NODATA!
 
Enter command:
DROP TABLE PERSONEN !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST SQLMODE ORACLE !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE ORACLE ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE ERGEBNISSE (
NAME   VARCHAR (10) NOT NULL,
ORT    VARCHAR (10) NOT NULL,
ANTEIL DECIMAL (3,1))!
 
Enter command:
INSERT INTO ERGEBNISSE VALUES ('Sagad    ', 'Verschwand', 34)!
 
Enter command:
INSERT INTO ERGEBNISSE VALUES ('Obergram ', 'Unterach  ', 92)!
 
Enter command:
INSERT INTO ERGEBNISSE VALUES ('Lakitz   ', 'Klamau    ', 67)!
 
Enter command:
INSERT INTO ERGEBNISSE VALUES ('Fitzken  ', 'Borkenbach', 55)!
 
Enter command:
INSERT INTO ERGEBNISSE VALUES ('Aberhoff ', 'Klegil    ', 84)!
 
Enter command:
INSERT INTO ERGEBNISSE VALUES ('Klabutz  ', 'Borstberg ', 23)!
 
Enter command:
SELECT N.NAME, O.ORT
FROM
  (SELECT E1.NAME, COUNT(*) NTEIL
    FROM ERGEBNISSE E1, ERGEBNISSE E2
   WHERE E1.ANTEIL >= E2.ANTEIL
   GROUP BY E1.NAME) N,
  (SELECT E1.ORT, COUNT(*) OTEIL
    FROM ERGEBNISSE E1, ERGEBNISSE E2
   WHERE E1.ANTEIL <= E2.ANTEIL
   GROUP BY E1.ORT) O
WHERE N.NTEIL = O.OTEIL
ORDER BY N.NTEIL DESC!
 
resultcount :                     0
 
Enter command:
FETCH INTO :A, :B!
 
NAME       | ORT
-----------+-----------
Obergram   | Borstberg
Aberhoff   | Verschwand
Lakitz     | Borkenbach
Fitzken    | Klamau
Sagad      | Klegil
Klabutz    | Unterach
 
resultcount :                     6
 
Enter command:
SELECT E1.NAME, E2.ORT
  FROM ERGEBNISSE E1, ERGEBNISSE E2
 WHERE NOT EXISTS
     (SELECT COUNT(*)
        FROM ERGEBNISSE E3
       WHERE E3.ANTEIL < E1.ANTEIL
      MINUS
      SELECT COUNT(*)
        FROM ERGEBNISSE E4
       WHERE E4.ANTEIL > E2.ANTEIL) !
 
***ERROR  -7011 Correlated subquery not allowed                            0129
 
Enter command:
FETCH INTO :A, :B!
 
***ERROR  -4000 Unknown result table                                       0001
 
Enter command:
DROP TABLE ERGEBNISSE !
 
Enter command:
COMMIT WORK RELEASE!
 
Enter command:
 
FILE CONNECT ( KERN TEST !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST   ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE LOGIN_VERSUCH (
MASCHINE VARCHAR (10),
LOGIN_NO INTEGER,
ZEIT     TIMESTAMP NOT NULL,
TERMINAL VARCHAR (10) NOT NULL,
USERNAME VARCHAR (10) NOT NULL,
CONSTRAINT LV_PK PRIMARY KEY (MASCHINE, LOGIN_NO))!
 
Enter command:
INSERT INTO LOGIN_VERSUCH VALUES
  ('UX1',  2, '19970220131111000000', 'MODEM1', 'HINZ')!
 
Enter command:
INSERT INTO LOGIN_VERSUCH VALUES
  ('UX1',  3, '19970220131123000000', 'MODEM2', 'HINZ')!
 
Enter command:
INSERT INTO LOGIN_VERSUCH VALUES
  ('UX1',  4, '19970220131137000000', 'MODEM3', 'HINZ')!
 
Enter command:
INSERT INTO LOGIN_VERSUCH VALUES
  ('UX1',  5, '19970220142200000000', 'PC1', 'KUNZ')!
 
Enter command:
INSERT INTO LOGIN_VERSUCH VALUES
  ('UX1',  6, '19970220142311000000', 'PC1', 'KUNZ')!
 
Enter command:
INSERT INTO LOGIN_VERSUCH VALUES
  ('UX1',  7, '19970220142510000000', 'PC1', 'KUNZ')!
 
Enter command:
INSERT INTO LOGIN_VERSUCH VALUES
  ('UX1',  9, '19970220150001000000', 'MODEM1', 'ROOT')!
 
Enter command:
INSERT INTO LOGIN_VERSUCH VALUES
  ('UX1', 10, '19970220150005000000', 'MODEM1', 'ADMIN')!
 
Enter command:
INSERT INTO LOGIN_VERSUCH VALUES
  ('UX1', 11, '19970220150011000000', 'MODEM1', 'SYS')!
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
FILE CONNECT ( KERN TEST SQLMODE ORACLE !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE ORACLE ISOLATION LEVEL 1 !
 
Enter command:
 
SELECT L1.LOGIN_NO L1, L1.ZEIT Z1,
       L2.LOGIN_NO L2, L2.ZEIT Z2
  FROM LOGIN_VERSUCH L1, LOGIN_VERSUCH L2
 WHERE (L1.LOGIN_NO, L1.ZEIT, L2.LOGIN_NO, L2.ZEIT) = ANY
  (SELECT LV1.LOGIN_NO L1, LV1.ZEIT Z1,
       LV2.LOGIN_NO L2, LV2.ZEIT Z2
  FROM LOGIN_VERSUCH LV1, LOGIN_VERSUCH LV2
 WHERE LV1.ZEIT BETWEEN LV2.ZEIT AND LV2.ZEIT + 2)
!
 
resultcount :                     0
 
Enter command:
FETCH INTO :A, :B, :C, :D !
 
L1                :            2
Z1                :  20-FEB-97
L2                :            2
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            3
Z1                :  20-FEB-97
L2                :            2
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            3
Z1                :  20-FEB-97
L2                :            3
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            4
Z1                :  20-FEB-97
L2                :            2
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            4
Z1                :  20-FEB-97
L2                :            3
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            4
Z1                :  20-FEB-97
L2                :            4
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            5
Z1                :  20-FEB-97
L2                :            2
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            5
Z1                :  20-FEB-97
L2                :            3
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            5
Z1                :  20-FEB-97
L2                :            4
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            5
Z1                :  20-FEB-97
L2                :            5
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            6
Z1                :  20-FEB-97
L2                :            2
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            6
Z1                :  20-FEB-97
L2                :            3
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            6
Z1                :  20-FEB-97
L2                :            4
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            6
Z1                :  20-FEB-97
L2                :            5
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            6
Z1                :  20-FEB-97
L2                :            6
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            7
Z1                :  20-FEB-97
L2                :            2
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            7
Z1                :  20-FEB-97
L2                :            3
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            7
Z1                :  20-FEB-97
L2                :            4
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            7
Z1                :  20-FEB-97
L2                :            5
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            7
Z1                :  20-FEB-97
L2                :            6
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            7
Z1                :  20-FEB-97
L2                :            7
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            9
Z1                :  20-FEB-97
L2                :            2
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            9
Z1                :  20-FEB-97
L2                :            3
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            9
Z1                :  20-FEB-97
L2                :            4
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            9
Z1                :  20-FEB-97
L2                :            5
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            9
Z1                :  20-FEB-97
L2                :            6
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            9
Z1                :  20-FEB-97
L2                :            7
Z2                :  20-FEB-97
-----------------------------------------------
L1                :            9
Z1                :  20-FEB-97
L2                :            9
Z2                :  20-FEB-97
-----------------------------------------------
L1                :           10
Z1                :  20-FEB-97
L2                :            2
Z2                :  20-FEB-97
-----------------------------------------------
L1                :           10
Z1                :  20-FEB-97
L2                :            3
Z2                :  20-FEB-97
-----------------------------------------------
L1                :           10
Z1                :  20-FEB-97
L2                :            4
Z2                :  20-FEB-97
-----------------------------------------------
L1                :           10
Z1                :  20-FEB-97
L2                :            5
Z2                :  20-FEB-97
-----------------------------------------------
L1                :           10
Z1                :  20-FEB-97
L2                :            6
Z2                :  20-FEB-97
-----------------------------------------------
L1                :           10
Z1                :  20-FEB-97
L2                :            7
Z2                :  20-FEB-97
-----------------------------------------------
L1                :           10
Z1                :  20-FEB-97
L2                :            9
Z2                :  20-FEB-97
-----------------------------------------------
L1                :           10
Z1                :  20-FEB-97
L2                :           10
Z2                :  20-FEB-97
-----------------------------------------------
L1                :           11
Z1                :  20-FEB-97
L2                :            2
Z2                :  20-FEB-97
-----------------------------------------------
L1                :           11
Z1                :  20-FEB-97
L2                :            3
Z2                :  20-FEB-97
-----------------------------------------------
L1                :           11
Z1                :  20-FEB-97
L2                :            4
Z2                :  20-FEB-97
-----------------------------------------------
L1                :           11
Z1                :  20-FEB-97
L2                :            5
Z2                :  20-FEB-97
-----------------------------------------------
L1                :           11
Z1                :  20-FEB-97
L2                :            6
Z2                :  20-FEB-97
-----------------------------------------------
L1                :           11
Z1                :  20-FEB-97
L2                :            7
Z2                :  20-FEB-97
-----------------------------------------------
L1                :           11
Z1                :  20-FEB-97
L2                :            9
Z2                :  20-FEB-97
-----------------------------------------------
L1                :           11
Z1                :  20-FEB-97
L2                :           10
Z2                :  20-FEB-97
-----------------------------------------------
L1                :           11
Z1                :  20-FEB-97
L2                :           11
Z2                :  20-FEB-97
 
resultcount :                    45
 
Enter command:
SELECT LV3.MASCHINE, LV3.ZEIT, LV3.TERMINAL, LV3.USERNAME
  FROM LOGIN_VERSUCH LV1, LOGIN_VERSUCH LV3
 WHERE LV1.MASCHINE = LV3.MASCHINE
   AND LV1.USERNAME = LV3.USERNAME
   AND LV3.ZEIT BETWEEN
       LV1.ZEIT AND LV1.ZEIT + 1 / 24 / 60
   AND 3 <= (SELECT COUNT (*)
               FROM LOGIN_VERSUCH LV2
              WHERE LV1.MASCHINE = LV2.MASCHINE
                AND LV1.USERNAME = LV2.USERNAME
                AND LV2.ZEIT BETWEEN
                    LV1.ZEIT AND LV1.ZEIT + 1 / 24 / 60)
UNION
SELECT LV3.MASCHINE, TO_CHAR(LV3.ZEIT,'DD MM YYYY HH24 MI SS'),
       LV3.TERMINAL, LV3.USERNAME
  FROM LOGIN_VERSUCH LV1, LOGIN_VERSUCH LV3
 WHERE LV1.MASCHINE = LV3.MASCHINE
   AND LV1.TERMINAL = LV3.TERMINAL
   AND LV3.ZEIT BETWEEN
       LV1.ZEIT AND LV1.ZEIT + 1 / 24 / 60
   AND 3 <= (SELECT COUNT (*)
               FROM LOGIN_VERSUCH LV2
              WHERE LV1.MASCHINE = LV2.MASCHINE
                AND LV1.TERMINAL = LV2.TERMINAL
                AND LV2.ZEIT BETWEEN
                    LV1.ZEIT AND LV1.ZEIT + 1 / 24 / 60)
ORDER BY 2 !
 
resultcount :                     0
 
Enter command:
FETCH INTO :A, :B, :C, :D !
 
MASCHINE   | ZEIT                       | TERMINAL   | USERNAME
-----------+----------------------------+------------+-----------
UX1        | 20 02 1997 15 00 01        | MODEM1     | ROOT
UX1        | 20 02 1997 15 00 05        | MODEM1     | ADMIN
UX1        | 20 02 1997 15 00 11        | MODEM1     | SYS
UX1        | 20-FEB-97                  | MODEM1     | HINZ
UX1        | 20-FEB-97                  | MODEM2     | HINZ
UX1        | 20-FEB-97                  | MODEM3     | HINZ
 
resultcount :                     6
 
Enter command:
SELECT LV3.MASCHINE, TO_CHAR(LV3.ZEIT,'DD MM YYYY HH24 MI SS'),
       LV3.TERMINAL, LV3.USERNAME
  FROM LOGIN_VERSUCH LV1, LOGIN_VERSUCH LV3
 WHERE LV1.MASCHINE = LV3.MASCHINE
   AND LV1.USERNAME = LV3.USERNAME
   AND LV3.ZEIT BETWEEN
       LV1.ZEIT AND LV1.ZEIT + 1 / 24 / 60
   AND 3 <= (SELECT COUNT (*)
               FROM LOGIN_VERSUCH LV2
              WHERE LV1.MASCHINE = LV2.MASCHINE
                AND LV1.USERNAME = LV2.USERNAME
                AND LV2.ZEIT BETWEEN
                    LV1.ZEIT AND LV1.ZEIT + 1 / 24 / 60)
UNION
SELECT LV3.MASCHINE, TO_CHAR(LV3.ZEIT,'DD MM YYYY HH24 MI SS'),
       LV3.TERMINAL, LV3.USERNAME
  FROM LOGIN_VERSUCH LV1, LOGIN_VERSUCH LV3
 WHERE LV1.MASCHINE = LV3.MASCHINE
   AND LV1.TERMINAL = LV3.TERMINAL
   AND LV3.ZEIT BETWEEN
       LV1.ZEIT AND LV1.ZEIT + 1 / 24 / 60
   AND 3 <= (SELECT COUNT (*)
               FROM LOGIN_VERSUCH LV2
              WHERE LV1.MASCHINE = LV2.MASCHINE
                AND LV1.TERMINAL = LV2.TERMINAL
                AND LV2.ZEIT BETWEEN
                    LV1.ZEIT AND LV1.ZEIT + 1 / 24 / 60)
ORDER BY 2 !
 
resultcount :                     0
 
Enter command:
FETCH INTO :A, :B, :C, :D !
 
MASCHINE   | EXPRESSION1         | TERMINAL   | USERNAME
-----------+---------------------+------------+-----------
UX1        | 20 02 1997 13 11 11 | MODEM1     | HINZ
UX1        | 20 02 1997 13 11 23 | MODEM2     | HINZ
UX1        | 20 02 1997 13 11 37 | MODEM3     | HINZ
UX1        | 20 02 1997 15 00 01 | MODEM1     | ROOT
UX1        | 20 02 1997 15 00 05 | MODEM1     | ADMIN
UX1        | 20 02 1997 15 00 11 | MODEM1     | SYS
 
resultcount :                     6
 
Enter command:
SELECT LV3.MASCHINE, TO_CHAR(LV3.ZEIT,'DD MM YYYY HH24 MI SS'),
       LV3.TERMINAL, LV3.USERNAME
  FROM LOGIN_VERSUCH LV1, LOGIN_VERSUCH LV3
 WHERE LV1.MASCHINE = LV3.MASCHINE
   AND (LV1.TERMINAL = LV3.TERMINAL OR LV1.USERNAME = LV3.USERNAME)
   AND LV3.ZEIT BETWEEN
       LV1.ZEIT AND LV1.ZEIT + 1 / 24 / 60
   AND 3 <= (SELECT COUNT (*)
               FROM LOGIN_VERSUCH LV2
              WHERE LV1.MASCHINE = LV2.MASCHINE
                AND (LV1.TERMINAL = LV3.TERMINAL OR
                     LV1.USERNAME = LV3.USERNAME)
                AND LV2.ZEIT BETWEEN
                    LV1.ZEIT AND LV1.ZEIT + 1 / 24 / 60)
ORDER BY 2 !
 
resultcount :                     0
 
Enter command:
FETCH INTO :A, :B, :C, :D !
 
MASCHINE   | EXPRESSION1         | TERMINAL   | USERNAME
-----------+---------------------+------------+-----------
UX1        | 20 02 1997 13 11 11 | MODEM1     | HINZ
UX1        | 20 02 1997 13 11 23 | MODEM2     | HINZ
UX1        | 20 02 1997 13 11 37 | MODEM3     | HINZ
UX1        | 20 02 1997 15 00 01 | MODEM1     | ROOT
UX1        | 20 02 1997 15 00 05 | MODEM1     | ADMIN
UX1        | 20 02 1997 15 00 11 | MODEM1     | SYS
 
resultcount :                     6
 
Enter command:
SELECT A.MASCHINE, TO_CHAR(A.ZEIT,'DD MM YYYY HH24 MI SS'),
       A.TERMINAL, A.USERNAME
  FROM LOGIN_VERSUCH A, LOGIN_VERSUCH B
 WHERE B.MASCHINE = A.MASCHINE
   AND (B.TERMINAL = A.TERMINAL OR
        B.USERNAME = A.USERNAME)
   AND B.ZEIT BETWEEN A.ZEIT - 1 / 24 / 60
                  AND A.ZEIT + 1 / 24 / 60
   AND A.LOGIN_NO != B.LOGIN_NO
GROUP BY A.MASCHINE, A.ZEIT, A.TERMINAL, A.USERNAME
HAVING COUNT (*) > 1
ORDER BY 2 !
 
resultcount :                     0
 
Enter command:
FETCH INTO :A, :B, :C, :D !
 
MASCHINE   | EXPRESSION1         | TERMINAL   | USERNAME
-----------+---------------------+------------+-----------
UX1        | 20 02 1997 13 11 11 | MODEM1     | HINZ
UX1        | 20 02 1997 13 11 23 | MODEM2     | HINZ
UX1        | 20 02 1997 13 11 37 | MODEM3     | HINZ
UX1        | 20 02 1997 15 00 01 | MODEM1     | ROOT
UX1        | 20 02 1997 15 00 05 | MODEM1     | ADMIN
UX1        | 20 02 1997 15 00 11 | MODEM1     | SYS
 
resultcount :                     6
 
Enter command:
DROP TABLE LOGIN_VERSUCH !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST   ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE MITARBEITER (
MA_NO FIXED(4) PRIMARY KEY,
NAME  VARCHAR (10) NOT NULL)!
 
Enter command:
INSERT INTO MITARBEITER VALUES (1, 'Schmidt')!
 
Enter command:
INSERT INTO MITARBEITER VALUES (2, 'Paulus')!
 
Enter command:
CREATE TABLE STEMPELKARTEN (
MA_NO      FIXED (4) REFERENCES MITARBEITER,
PROJEKT    VARCHAR (10) NOT NULL,
STARTDATUM DATE NOT NULL,
ENDDATUM   DATE NOT NULL,
PRIMARY KEY (MA_NO, PROJEKT, STARTDATUM))!
 
Enter command:
SET FORMAT EUR !
 
Enter command:
INSERT INTO STEMPELKARTEN VALUES(1,'P1','01.01.1998','03.01.1998')!
 
Enter command:
INSERT INTO STEMPELKARTEN VALUES(1,'P2','02.01.1998','04.01.1998')!
 
Enter command:
INSERT INTO STEMPELKARTEN VALUES(2,'P1','02.01.1998','03.01.1998')!
 
Enter command:
INSERT INTO STEMPELKARTEN VALUES(2,'P2','02.01.1998','04.01.1998')!
 
Enter command:
INSERT INTO STEMPELKARTEN VALUES(2,'P3','03.01.1998','05.01.1998')!
 
Enter command:
INSERT INTO STEMPELKARTEN VALUES(1,'P3','04.01.1998','05.01.1998')!
 
Enter command:
INSERT INTO STEMPELKARTEN VALUES(1,'P4','06.01.1998','09.01.1998')!
 
Enter command:
INSERT INTO STEMPELKARTEN VALUES(2,'P4','06.01.1998','09.01.1998')!
 
Enter command:
INSERT INTO STEMPELKARTEN VALUES(1,'P5','09.01.1998','09.01.1998')!
 
Enter command:
INSERT INTO STEMPELKARTEN VALUES(1,'P6','09.01.1998','09.01.1998')!
 
Enter command:
INSERT INTO STEMPELKARTEN VALUES(2,'P6','09.01.1998','10.01.1998')!
 
Enter command:
INSERT INTO STEMPELKARTEN VALUES(2,'P5','09.01.1998','09.01.1998')!
 
Enter command:
INSERT INTO STEMPELKARTEN VALUES(1,'P7','12.01.1998','15.01.1998')!
 
Enter command:
INSERT INTO STEMPELKARTEN VALUES(2,'P7','12.01.1998','15.01.1998')!
 
Enter command:
INSERT INTO STEMPELKARTEN VALUES(1,'P8','13.01.1998','14.01.1998')!
 
Enter command:
INSERT INTO STEMPELKARTEN VALUES(2,'P8','13.01.1998','14.01.1998')!
 
Enter command:
INSERT INTO STEMPELKARTEN VALUES(1,'P9','14.01.1998','14.01.1998')!
 
Enter command:
INSERT INTO STEMPELKARTEN VALUES(2,'P9','14.01.1998','14.01.1998')!
 
Enter command:
INSERT INTO STEMPELKARTEN VALUES(1,'P10','17.01.1998','17.01.1998')!
 
Enter command:
INSERT INTO STEMPELKARTEN VALUES(2,'P10','17.01.1998','18.01.1998')!
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
FILE CONNECT ( KERN TEST SQLMODE ORACLE !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE ORACLE ISOLATION LEVEL 1 !
 
Enter command:
SELECT M.NAME, T1.STARTDATUM, MIN(T2.ENDDATUM) ENDDATUM
  FROM STEMPELKARTEN T1, STEMPELKARTEN T2, MITARBEITER M
 WHERE T1.ENDDATUM <= T2.ENDDATUM
   AND T1.MA_NO = T2.MA_NO
   AND NOT EXISTS
          (SELECT *
             FROM STEMPELKARTEN T3
            WHERE T1.MA_NO = T3.MA_NO
              AND T1.STARTDATUM > T3.STARTDATUM
              AND T1.STARTDATUM <= T3.ENDDATUM)
   AND NOT EXISTS
          (SELECT *
             FROM STEMPELKARTEN T3
            WHERE T1.MA_NO = T3.MA_NO
              AND T2.ENDDATUM >= T3.STARTDATUM
              AND T2.ENDDATUM < T3.ENDDATUM)
   AND T1.MA_NO = M.MA_NO
 GROUP BY M.NAME, T1.STARTDATUM !
 
resultcount :                     0
 
Enter command:
FETCH INTO :A, :B, :C !
 
NAME       | STARTDATUM | ENDDATUM
-----------+------------+-----------
Paulus     | 19980102   | 19980105
Paulus     | 19980106   | 19980110
Paulus     | 19980112   | 19980115
Paulus     | 19980117   | 19980118
Schmidt    | 19980101   | 19980105
Schmidt    | 19980106   | 19980109
Schmidt    | 19980112   | 19980115
Schmidt    | 19980117   | 19980117
 
resultcount :                     8
 
Enter command:
SELECT M.NAME, T1.STARTDATUM, MIN(T2.ENDDATUM) ENDDATUM
  FROM STEMPELKARTEN T1, STEMPELKARTEN T2, MITARBEITER M
 WHERE T1.ENDDATUM <= T2.ENDDATUM
   AND T1.MA_NO = T2.MA_NO
   AND NOT EXISTS
          (SELECT *
             FROM STEMPELKARTEN T3
            WHERE T1.MA_NO = T3.MA_NO
              AND ((T1.STARTDATUM > T3.STARTDATUM
              AND   T1.STARTDATUM <= T3.ENDDATUM)
               OR  (T2.ENDDATUM >= T3.STARTDATUM
              AND   T2.ENDDATUM < T3.ENDDATUM)))
   AND T1.MA_NO = M.MA_NO
 GROUP BY M.NAME, T1.STARTDATUM !
 
resultcount :                     0
 
Enter command:
FETCH INTO :A, :B, :C !
 
NAME       | STARTDATUM | ENDDATUM
-----------+------------+-----------
Paulus     | 19980102   | 19980105
Paulus     | 19980106   | 19980110
Paulus     | 19980112   | 19980115
Paulus     | 19980117   | 19980118
Schmidt    | 19980101   | 19980105
Schmidt    | 19980106   | 19980109
Schmidt    | 19980112   | 19980115
Schmidt    | 19980117   | 19980117
 
resultcount :                     8
 
Enter command:
DROP TABLE MITARBEITER !
 
Enter command:
DROP TABLE STEMPELKARTEN !
 
Enter command:
COMMIT WORK RELEASE!
 
Enter command:
 
FILE CONNECT ( KERN TEST SQLMODE ORACLE !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE ORACLE ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE AUFTRAG_KOPF (
AUFTRAG_ID INTEGER CONSTRAINT AUFTRAG_KOPF_PK PRIMARY KEY,
BESTELLER  VARCHAR(15) NOT NULL) !
 
Enter command:
INSERT INTO AUFTRAG_KOPF VALUES (1, 'Hansen')!
 
Enter command:
INSERT INTO AUFTRAG_KOPF VALUES (2, 'Paulsen')!
 
Enter command:
INSERT INTO AUFTRAG_KOPF VALUES (3, 'Petersen')!
 
Enter command:
INSERT INTO AUFTRAG_KOPF VALUES (4, 'Klausen')!
 
Enter command:
INSERT INTO AUFTRAG_KOPF VALUES (5, 'Feddersen')!
 
Enter command:
INSERT INTO AUFTRAG_KOPF VALUES (6, 'Feddersen')!
 
Enter command:
INSERT INTO AUFTRAG_KOPF VALUES (7, 'Feddersen')!
 
Enter command:
COMMIT!
 
Enter command:
CREATE TABLE ARTIKEL (
ARTIKEL_ID  INTEGER CONSTRAINT ARTIKEL_PK PRIMARY KEY,
BEZEICHNUNG VARCHAR(15) NOT NULL)!
 
Enter command:
INSERT INTO ARTIKEL VALUES (1, 'Hammer')!
 
Enter command:
INSERT INTO ARTIKEL VALUES (2, 'Zange')!
 
Enter command:
INSERT INTO ARTIKEL VALUES (3, 'Feder')!
 
Enter command:
INSERT INTO ARTIKEL VALUES (4, 'Zollstock')!
 
Enter command:
INSERT INTO ARTIKEL VALUES (5, 'Schluessel')!
 
Enter command:
COMMIT!
 
Enter command:
CREATE TABLE AUFTRAG_POSITION (
AUFTRAG_ID INTEGER CONSTRAINT AP_AUF_FK REFERENCES AUFTRAG_KOPF,
POS_ID     INTEGER,
ARTIKEL_ID INTEGER CONSTRAINT AP_ART_FK REFERENCES ARTIKEL,
MENGE      INTEGER NOT NULL,
CONSTRAINT AUFTRAG_POSITION_PK PRIMARY KEY (AUFTRAG_ID, POS_ID),
CONSTRAINT AUFTRAG_POSITION_UK UNIQUE (AUFTRAG_ID, ARTIKEL_ID))!
 
Enter command:
INSERT INTO AUFTRAG_POSITION VALUES (1,1,1,1)!
 
Enter command:
INSERT INTO AUFTRAG_POSITION VALUES (1,2,2,2)!
 
Enter command:
INSERT INTO AUFTRAG_POSITION VALUES (1,3,3,3)!
 
Enter command:
INSERT INTO AUFTRAG_POSITION VALUES (1,4,4,4)!
 
Enter command:
INSERT INTO AUFTRAG_POSITION VALUES (1,5,5,5)!
 
Enter command:
INSERT INTO AUFTRAG_POSITION VALUES (2,1,2,1)!
 
Enter command:
INSERT INTO AUFTRAG_POSITION VALUES (2,2,1,2)!
 
Enter command:
INSERT INTO AUFTRAG_POSITION VALUES (3,1,1,2)!
 
Enter command:
INSERT INTO AUFTRAG_POSITION VALUES (3,2,2,1)!
 
Enter command:
INSERT INTO AUFTRAG_POSITION VALUES (4,1,3,3)!
 
Enter command:
INSERT INTO AUFTRAG_POSITION VALUES (4,2,4,4)!
 
Enter command:
INSERT INTO AUFTRAG_POSITION VALUES (4,3,5,5)!
 
Enter command:
INSERT INTO AUFTRAG_POSITION VALUES (5,1,3,3)!
 
Enter command:
INSERT INTO AUFTRAG_POSITION VALUES (5,2,4,4)!
 
Enter command:
INSERT INTO AUFTRAG_POSITION VALUES (5,3,5,5)!
 
Enter command:
INSERT INTO AUFTRAG_POSITION VALUES (6,1,3,3)!
 
Enter command:
INSERT INTO AUFTRAG_POSITION VALUES (6,2,4,3)!
 
Enter command:
INSERT INTO AUFTRAG_POSITION VALUES (6,3,5,5)!
 
Enter command:
INSERT INTO AUFTRAG_POSITION VALUES (7,1,1,1)!
 
Enter command:
COMMIT!
 
Enter command:
SELECT K2.AUFTRAG_ID, COUNT(*)
  FROM AUFTRAG_KOPF K1, AUFTRAG_KOPF K2
 WHERE (K1.AUFTRAG_ID, K2.AUFTRAG_ID) IN
       (SELECT P6.AUFTRAG_ID, MIN(P5.AUFTRAG_ID)
          FROM AUFTRAG_KOPF P5, AUFTRAG_KOPF P6
         WHERE P5.AUFTRAG_ID <= P6.AUFTRAG_ID
           AND NOT EXISTS
              (SELECT *
                 FROM AUFTRAG_POSITION P1,
                      AUFTRAG_POSITION P2
                WHERE P6.AUFTRAG_ID = P2.AUFTRAG_ID
                  AND P5.AUFTRAG_ID = P1.AUFTRAG_ID
                  AND P1.AUFTRAG_ID <= P2.AUFTRAG_ID
                  AND ((P1.ARTIKEL_ID = P2.ARTIKEL_ID
                        AND
                        P1.MENGE <> P2.MENGE)
                     OR NOT EXISTS
                       (SELECT ARTIKEL_ID
                          FROM AUFTRAG_POSITION P3
                         WHERE P3.AUFTRAG_ID = P2.AUFTRAG_ID
                           AND P3.ARTIKEL_ID = P1.ARTIKEL_ID)
                     OR NOT EXISTS
                       (SELECT *
                          FROM AUFTRAG_POSITION P4
                         WHERE P4.AUFTRAG_ID = P1.AUFTRAG_ID
                           AND P4.ARTIKEL_ID = P2.ARTIKEL_ID)
                       )
              )
           GROUP BY P6.AUFTRAG_ID)
GROUP BY K2.AUFTRAG_ID !
 
resultcount :                     0
 
Enter command:
FETCH INTO :A, :B !
 
AUFTRAG_ID            | EXPRESSION1
----------------------+------------
                    1 |           1
                    2 |           2
                    4 |           2
                    6 |           1
                    7 |           1
 
resultcount :                     5
 
Enter command:
DROP TABLE AUFTRAG_KOPF !
 
Enter command:
DROP TABLE ARTIKEL !
 
Enter command:
DROP TABLE AUFTRAG_POSITION !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
FILE CONNECT ( SUT SUT !
 
Enter command:
CONNECT SUT IDENTIFIED BY SUT   ISOLATION LEVEL 1 !
 
Enter command:
DROP USER KERN !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( SUT SUT !
 
Enter command:
CONNECT SUT IDENTIFIED BY SUT   ISOLATION LEVEL 1 !
 
Enter command:
CREATE USER KERN PASSWORD TEST DBA NOT EXCLUSIVE !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
FILE CONNECT ( KERN TEST !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST   ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE TA (A1 INT, A2 INT, A3 INT) !
 
Enter command:
INSERT TA VALUES (1, 1, 1) !
 
Enter command:
INSERT TA VALUES (2, 1, 1) !
 
Enter command:
CREATE TABLE TB (B1 INT, B2 INT, B3 INT) !
 
Enter command:
INSERT TB VALUES (1, 2, 2) !
 
Enter command:
INSERT TB VALUES (2, 2, 2) !
 
Enter command:
CREATE TABLE TC (C1 INT, C2 INT, C3 INT) !
 
Enter command:
INSERT TC VALUES (1, 3, 3) !
 
Enter command:
INSERT TC VALUES (2, 3, 3) !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
FILE CONNECT ( KERN TEST SQLMODE INTERNAL !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE INTERNAL ISOLATION LEVEL 1 !
 
Enter command:
 SELECT *
 FROM TC, (SELECT *
       FROM TB, TA)!
 
resultcount :                     8
 
Enter command:
FETCH INTO :A,:B,:C,:D,:E,:F,:G,:H,:I!
 
C1                :            1
C2                :            3
C3                :            3
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
--------------------------------
C1                :            1
C2                :            3
C3                :            3
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
--------------------------------
C1                :            1
C2                :            3
C3                :            3
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
--------------------------------
C1                :            1
C2                :            3
C3                :            3
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
--------------------------------
C1                :            2
C2                :            3
C3                :            3
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
--------------------------------
C1                :            2
C2                :            3
C3                :            3
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
--------------------------------
C1                :            2
C2                :            3
C3                :            3
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
--------------------------------
C1                :            2
C2                :            3
C3                :            3
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
 
resultcount :                     8
 
Enter command:
 SELECT *
 FROM (SELECT *
       FROM TB, TA), TC!
 
resultcount :                     8
 
Enter command:
FETCH INTO :A,:B,:C,:D,:E,:F,:G,:H,:I!
 
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
 
resultcount :                     8
 
Enter command:
 SELECT *
 FROM (SELECT *
       FROM TB), TA, TC!
 
resultcount :                     8
 
Enter command:
FETCH INTO :A,:B,:C,:D,:E,:F,:G,:H,:I!
 
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
 
resultcount :                     8
 
Enter command:
 SELECT *
 FROM TA, (SELECT *
       FROM TB), TC!
 
resultcount :                     8
 
Enter command:
FETCH INTO :A,:B,:C,:D,:E,:F,:G,:H,:I!
 
A1                :            1
A2                :            1
A3                :            1
B1                :            1
B2                :            2
B3                :            2
C1                :            1
C2                :            3
C3                :            3
--------------------------------
A1                :            1
A2                :            1
A3                :            1
B1                :            1
B2                :            2
B3                :            2
C1                :            2
C2                :            3
C3                :            3
--------------------------------
A1                :            1
A2                :            1
A3                :            1
B1                :            2
B2                :            2
B3                :            2
C1                :            1
C2                :            3
C3                :            3
--------------------------------
A1                :            1
A2                :            1
A3                :            1
B1                :            2
B2                :            2
B3                :            2
C1                :            2
C2                :            3
C3                :            3
--------------------------------
A1                :            2
A2                :            1
A3                :            1
B1                :            1
B2                :            2
B3                :            2
C1                :            1
C2                :            3
C3                :            3
--------------------------------
A1                :            2
A2                :            1
A3                :            1
B1                :            1
B2                :            2
B3                :            2
C1                :            2
C2                :            3
C3                :            3
--------------------------------
A1                :            2
A2                :            1
A3                :            1
B1                :            2
B2                :            2
B3                :            2
C1                :            1
C2                :            3
C3                :            3
--------------------------------
A1                :            2
A2                :            1
A3                :            1
B1                :            2
B2                :            2
B3                :            2
C1                :            2
C2                :            3
C3                :            3
 
resultcount :                     8
 
Enter command:
 SELECT *
 FROM (SELECT *
       FROM TA, TC), (SELECT * FROM TB) !
 
resultcount :                     8
 
Enter command:
FETCH INTO :A,:B,:C,:D,:E,:F,:G,:H,:I!
 
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
B1                :            1
B2                :            2
B3                :            2
--------------------------------
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
B1                :            2
B2                :            2
B3                :            2
--------------------------------
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
B1                :            1
B2                :            2
B3                :            2
--------------------------------
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
B1                :            2
B2                :            2
B3                :            2
--------------------------------
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
B1                :            1
B2                :            2
B3                :            2
--------------------------------
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
B1                :            2
B2                :            2
B3                :            2
--------------------------------
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
B1                :            1
B2                :            2
B3                :            2
--------------------------------
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
B1                :            2
B2                :            2
B3                :            2
 
resultcount :                     8
 
Enter command:
 SELECT *
 FROM (SELECT *
       FROM TB), (SELECT * FROM TA, TC)!
 
resultcount :                     8
 
Enter command:
FETCH INTO :A,:B,:C,:D,:E,:F,:G,:H,:I!
 
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
 
resultcount :                     8
 
Enter command:
 SELECT *
 FROM (SELECT *
       FROM TB), (SELECT * FROM TA), TC!
 
resultcount :                     8
 
Enter command:
FETCH INTO :A,:B,:C,:D,:E,:F,:G,:H,:I!
 
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
 
resultcount :                     8
 
Enter command:
 SELECT *
 FROM (SELECT *
       FROM TB), (SELECT * FROM TA), (SELECT * FROM TC)!
 
resultcount :                     8
 
Enter command:
FETCH INTO :A,:B,:C,:D,:E,:F,:G,:H,:I!
 
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
 
resultcount :                     8
 
Enter command:
ROLLBACK !
 
Enter command:
 SELECT *
 FROM (SELECT *
       FROM (SELECT * FROM TB, TA), (SELECT * FROM TC))!
 
resultcount :                     8
 
Enter command:
FETCH INTO :A,:B,:C,:D,:E,:F,:G,:H,:I!
 
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
 
resultcount :                     8
 
Enter command:
 SELECT *
 FROM (SELECT *
       FROM (SELECT *
             FROM TB, (SELECT * FROM TA)), (SELECT * FROM TC))!
 
resultcount :                     8
 
Enter command:
FETCH INTO :A,:B,:C,:D,:E,:F,:G,:H,:I!
 
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
 
resultcount :                     8
 
Enter command:
 SELECT *
 FROM (SELECT *
       FROM (SELECT * FROM TB, (SELECT * FROM TA, (SELECT * FROM TC))))!
 
resultcount :                     8
 
Enter command:
FETCH INTO :A,:B,:C,:D,:E,:F,:G,:H,:I!
 
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
 
resultcount :                     8
 
Enter command:
ROLLBACK !
 
Enter command:
 SELECT *
 FROM (SELECT *
 FROM (SELECT *
 FROM (SELECT *
 FROM (SELECT *
 FROM (SELECT *
       FROM (SELECT * FROM TB, (SELECT * FROM TA,
       (SELECT * FROM TC))))))))!
 
resultcount :                     8
 
Enter command:
FETCH INTO :A,:B,:C,:D,:E,:F,:G,:H,:I!
 
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
 
resultcount :                     8
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
FILE CONNECT ( KERN TEST SQLMODE ORACLE !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST SQLMODE ORACLE ISOLATION LEVEL 1 !
 
Enter command:
 SELECT *
 FROM TC, (SELECT *
       FROM TB, TA)!
 
resultcount :                     0
 
Enter command:
FETCH INTO :A,:B,:C,:D,:E,:F,:G,:H,:I!
 
C1                :            1
C2                :            3
C3                :            3
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
--------------------------------
C1                :            1
C2                :            3
C3                :            3
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
--------------------------------
C1                :            1
C2                :            3
C3                :            3
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
--------------------------------
C1                :            1
C2                :            3
C3                :            3
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
--------------------------------
C1                :            2
C2                :            3
C3                :            3
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
--------------------------------
C1                :            2
C2                :            3
C3                :            3
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
--------------------------------
C1                :            2
C2                :            3
C3                :            3
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
--------------------------------
C1                :            2
C2                :            3
C3                :            3
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
 
resultcount :                     8
 
Enter command:
 SELECT *
 FROM (SELECT *
       FROM TB, TA), TC!
 
resultcount :                     0
 
Enter command:
FETCH INTO :A,:B,:C,:D,:E,:F,:G,:H,:I!
 
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
 
resultcount :                     8
 
Enter command:
 SELECT *
 FROM (SELECT *
       FROM TB), TA, TC!
 
resultcount :                     0
 
Enter command:
FETCH INTO :A,:B,:C,:D,:E,:F,:G,:H,:I!
 
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
 
resultcount :                     8
 
Enter command:
 SELECT *
 FROM TA, (SELECT *
       FROM TB), TC!
 
resultcount :                     0
 
Enter command:
FETCH INTO :A,:B,:C,:D,:E,:F,:G,:H,:I!
 
A1                :            1
A2                :            1
A3                :            1
B1                :            1
B2                :            2
B3                :            2
C1                :            1
C2                :            3
C3                :            3
--------------------------------
A1                :            1
A2                :            1
A3                :            1
B1                :            1
B2                :            2
B3                :            2
C1                :            2
C2                :            3
C3                :            3
--------------------------------
A1                :            1
A2                :            1
A3                :            1
B1                :            2
B2                :            2
B3                :            2
C1                :            1
C2                :            3
C3                :            3
--------------------------------
A1                :            1
A2                :            1
A3                :            1
B1                :            2
B2                :            2
B3                :            2
C1                :            2
C2                :            3
C3                :            3
--------------------------------
A1                :            2
A2                :            1
A3                :            1
B1                :            1
B2                :            2
B3                :            2
C1                :            1
C2                :            3
C3                :            3
--------------------------------
A1                :            2
A2                :            1
A3                :            1
B1                :            1
B2                :            2
B3                :            2
C1                :            2
C2                :            3
C3                :            3
--------------------------------
A1                :            2
A2                :            1
A3                :            1
B1                :            2
B2                :            2
B3                :            2
C1                :            1
C2                :            3
C3                :            3
--------------------------------
A1                :            2
A2                :            1
A3                :            1
B1                :            2
B2                :            2
B3                :            2
C1                :            2
C2                :            3
C3                :            3
 
resultcount :                     8
 
Enter command:
 SELECT *
 FROM (SELECT *
       FROM TA, TC), (SELECT * FROM TB) !
 
resultcount :                     0
 
Enter command:
FETCH INTO :A,:B,:C,:D,:E,:F,:G,:H,:I!
 
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
B1                :            1
B2                :            2
B3                :            2
--------------------------------
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
B1                :            2
B2                :            2
B3                :            2
--------------------------------
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
B1                :            1
B2                :            2
B3                :            2
--------------------------------
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
B1                :            2
B2                :            2
B3                :            2
--------------------------------
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
B1                :            1
B2                :            2
B3                :            2
--------------------------------
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
B1                :            2
B2                :            2
B3                :            2
--------------------------------
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
B1                :            1
B2                :            2
B3                :            2
--------------------------------
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
B1                :            2
B2                :            2
B3                :            2
 
resultcount :                     8
 
Enter command:
 SELECT *
 FROM (SELECT *
       FROM TB), (SELECT * FROM TA, TC)!
 
resultcount :                     0
 
Enter command:
FETCH INTO :A,:B,:C,:D,:E,:F,:G,:H,:I!
 
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
 
resultcount :                     8
 
Enter command:
 SELECT *
 FROM (SELECT *
       FROM TB), (SELECT * FROM TA), TC!
 
resultcount :                     0
 
Enter command:
FETCH INTO :A,:B,:C,:D,:E,:F,:G,:H,:I!
 
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
 
resultcount :                     8
 
Enter command:
 SELECT *
 FROM (SELECT *
       FROM TB), (SELECT * FROM TA), (SELECT * FROM TC)!
 
resultcount :                     0
 
Enter command:
FETCH INTO :A,:B,:C,:D,:E,:F,:G,:H,:I!
 
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
 
resultcount :                     8
 
Enter command:
ROLLBACK !
 
Enter command:
 SELECT *
 FROM (SELECT *
       FROM (SELECT * FROM TB, TA), (SELECT * FROM TC))!
 
resultcount :                     0
 
Enter command:
FETCH INTO :A,:B,:C,:D,:E,:F,:G,:H,:I!
 
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
 
resultcount :                     8
 
Enter command:
 SELECT *
 FROM (SELECT *
       FROM (SELECT *
             FROM TB, (SELECT * FROM TA)), (SELECT * FROM TC))!
 
resultcount :                     0
 
Enter command:
FETCH INTO :A,:B,:C,:D,:E,:F,:G,:H,:I!
 
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
 
resultcount :                     8
 
Enter command:
 SELECT *
 FROM (SELECT *
       FROM (SELECT * FROM TB, (SELECT * FROM TA, (SELECT * FROM TC))))!
 
resultcount :                     0
 
Enter command:
FETCH INTO :A,:B,:C,:D,:E,:F,:G,:H,:I!
 
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
 
resultcount :                     8
 
Enter command:
ROLLBACK !
 
Enter command:
 SELECT *
 FROM (SELECT *
 FROM (SELECT *
 FROM (SELECT *
 FROM (SELECT *
 FROM (SELECT *
       FROM (SELECT * FROM TB, (SELECT * FROM TA,
       (SELECT * FROM TC))))))))!
 
resultcount :                     0
 
Enter command:
FETCH INTO :A,:B,:C,:D,:E,:F,:G,:H,:I!
 
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            1
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            1
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            1
C2                :            3
C3                :            3
--------------------------------
B1                :            2
B2                :            2
B3                :            2
A1                :            2
A2                :            1
A3                :            1
C1                :            2
C2                :            3
C3                :            3
 
resultcount :                     8
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST   ISOLATION LEVEL 1 !
 
Enter command:
CREATE INDEX I3 ON TC (C3)!
 
Enter command:
CREATE INDEX I1 ON TC (C1)!
 
Enter command:
CREATE VIEW VCOMPLEX AS
 SELECT DISTINCT TA.A2
   FROM TA,TB
  WHERE TA.A1 = TB.B1 !
 
Enter command:
PARSING !
 
Enter command:
 SELECT *
 FROM TC, (SELECT *
       FROM TB, VCOMPLEX) FROMSEL, TA
WHERE TC.C3 = :P
  AND FROMSEL.B1 = TC.C1
  AND TC.C1 = TA.A1 !
parsing idnr :       1
 
Enter command:
EXECUTING !
 
Enter command:
DATA !
 
Enter command:
 SELECT * !
Parsing idnr :      1
Result name  :    JDBC_CURSOR_18
 
n 10 3
 
resultcount :                     2
 
Enter command:
NODATA !
 
Enter command:
PARS_EXECUTE !
 
Enter command:
DESCRIBE "JDBC_CURSOR_18" !
 
Enter command:
PARS_THEN_EX !
 
Enter command:
FETCH "JDBC_CURSOR_18" !
 
C1                :            1
C2                :            3
C3                :            3
B1                :            1
B2                :            2
B3                :            2
A2                :            1
A1                :            1
A2                :            1
A3                :            1
--------------------------------
C1                :            2
C2                :            3
C3                :            3
B1                :            2
B2                :            2
B3                :            2
A2                :            1
A1                :            2
A2                :            1
A3                :            1
 
resultcount :                     2
 
Enter command:
PARS_EXECUTE !
 
Enter command:
DROP TABLE TA !
 
Enter command:
DROP TABLE TB !
 
Enter command:
DROP TABLE TC !
 
Enter command:
COMMIT RELEASE !
 
Enter command:
FILE CONNECT ( SUT SUT !
 
Enter command:
CONNECT SUT IDENTIFIED BY SUT   ISOLATION LEVEL 1 !
 
Enter command:
DROP USER KERN !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( SUT SUT !
 
Enter command:
CONNECT SUT IDENTIFIED BY SUT   ISOLATION LEVEL 1 !
 
Enter command:
CREATE USER KERN PASSWORD TEST DBA NOT EXCLUSIVE !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
FILE CONNECT ( KERN TEST !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST   ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE ABF
    (
     ABFALL CHAR(6) NOT NULL
    )
!
 
Enter command:
INSERT ABF VALUES ('S    ') !
 
Enter command:
INSERT ABF VALUES ('AC   ') !
 
Enter command:
INSERT ABF VALUES ('HM   ') !
 
Enter command:
INSERT ABF VALUES ('KW   ') !
 
Enter command:
INSERT ABF VALUES ('APC  ') !
 
Enter command:
INSERT ABF VALUES ('KEH  ') !
 
Enter command:
INSERT ABF VALUES ('IND  ') !
 
Enter command:
INSERT ABF VALUES ('MAR  ') !
 
Enter command:
INSERT ABF VALUES ('PAP  ') !
 
Enter command:
INSERT ABF VALUES ('LAU  ') !
 
Enter command:
INSERT ABF VALUES ('GUL  ') !
 
Enter command:
INSERT ABF VALUES ('INS  ') !
 
Enter command:
INSERT ABF VALUES ('SPM  ') !
 
Enter command:
INSERT ABF VALUES ('RBMAE') !
 
Enter command:
INSERT ABF VALUES ('WIEGE') !
 
Enter command:
INSERT ABF VALUES ('BSAIN') !
 
Enter command:
INSERT ABF VALUES ('RZGBE') !
 
Enter command:
INSERT ABF VALUES ('RYMAA') !
 
Enter command:
INSERT ABF VALUES ('RYPAA') !
 
Enter command:
INSERT ABF VALUES ('RYHOA') !
 
Enter command:
INSERT ABF VALUES ('RZCRE') !
 
Enter command:
INSERT ABF VALUES ('RZGWE') !
 
Enter command:
INSERT ABF VALUES ('RZGBZ') !
 
Enter command:
INSERT ABF VALUES ('HOSUS') !
 
Enter command:
INSERT ABF VALUES ('RYSSA') !
 
Enter command:
CREATE TABLE BIL_A ( ABFALL CHAR(6), AUSGANG INTEGER) !
 
Enter command:
INSERT BIL_A VALUES ('AC   ', 5126) !
 
Enter command:
INSERT BIL_A VALUES ('APC  ', 3946) !
 
Enter command:
INSERT BIL_A VALUES ('GUL  ', 3150) !
 
Enter command:
INSERT BIL_A VALUES ('IND  ', 80782) !
 
Enter command:
INSERT BIL_A VALUES ('INS  ', 5176) !
 
Enter command:
INSERT BIL_A VALUES ('KEH  ', 5522) !
 
Enter command:
INSERT BIL_A VALUES ('KW   ', 88) !
 
Enter command:
INSERT BIL_A VALUES ('RYMAA', 440) !
 
Enter command:
INSERT BIL_A VALUES ('S    ', 244759) !
 
Enter command:
CREATE TABLE BIL_E ( ABFALL CHAR(6), EINGANG INTEGER) !
 
Enter command:
INSERT BIL_E VALUES ('BSAIN', 366) !
 
Enter command:
INSERT BIL_E VALUES ('HM   ', 137502) !
 
Enter command:
INSERT BIL_E VALUES ('HOSUS', 292) !
 
Enter command:
INSERT BIL_E VALUES ('KEH  ', 6404) !
 
Enter command:
INSERT BIL_E VALUES ('LAU  ', 1962) !
 
Enter command:
INSERT BIL_E VALUES ('MAR  ', 551) !
 
Enter command:
INSERT BIL_E VALUES ('PAP  ', 34) !
 
Enter command:
INSERT BIL_E VALUES ('RBMAE', 198) !
 
Enter command:
INSERT BIL_E VALUES ('RYHOA', 696) !
 
Enter command:
INSERT BIL_E VALUES ('RYPAA', 156) !
 
Enter command:
INSERT BIL_E VALUES ('RYSSA', 1434) !
 
Enter command:
INSERT BIL_E VALUES ('RZCRE', 2346) !
 
Enter command:
INSERT BIL_E VALUES ('RZGBE', 64) !
 
Enter command:
INSERT BIL_E VALUES ('RZGBZ', 3812) !
 
Enter command:
INSERT BIL_E VALUES ('RZGWE', 54) !
 
Enter command:
INSERT BIL_E VALUES ('SPM  ', 17539) !
 
Enter command:
INSERT BIL_E VALUES ('WIEGE', 3337) !
 
Enter command:
COMMIT WORK !
 
Enter command:
SELECT TMP_TAB.ABFALL, EINGANG, AUSGANG
FROM (SELECT ABF.ABFALL, EINGANG FROM BIL_E, ABF
WHERE ABF.ABFALL = BIL_E.ABFALL (+)) TMP_TAB, BIL_A
WHERE    TMP_TAB.ABFALL =BIL_A.ABFALL(+)
ORDER BY TMP_TAB.ABFALL
!
 
resultcount :                    25
 
Enter command:
FETCH !
 
ABFALL | EINGANG     | AUSGANG
-------+-------------+------------
AC     | ??????????? |        5126
APC    | ??????????? |        3946
BSAIN  |         366 | ???????????
GUL    | ??????????? |        3150
HM     |      137502 | ???????????
HOSUS  |         292 | ???????????
IND    | ??????????? |       80782
INS    | ??????????? |        5176
KEH    |        6404 |        5522
KW     | ??????????? |          88
LAU    |        1962 | ???????????
MAR    |         551 | ???????????
PAP    |          34 | ???????????
RBMAE  |         198 | ???????????
RYHOA  |         696 | ???????????
RYMAA  | ??????????? |         440
RYPAA  |         156 | ???????????
 
ABFALL | EINGANG     | AUSGANG
-------+-------------+------------
RYSSA  |        1434 | ???????????
RZCRE  |        2346 | ???????????
RZGBE  |          64 | ???????????
RZGBZ  |        3812 | ???????????
RZGWE  |          54 | ???????????
S      | ??????????? |      244759
SPM    |       17539 | ???????????
WIEGE  |        3337 | ???????????
 
resultcount :                    25
 
Enter command:
SELECT TMP_TAB.ABFALL, EINGANG, AUSGANG
FROM (SELECT ABF.ABFALL, EINGANG FROM BIL_E, ABF
WHERE ABF.ABFALL =BIL_E.ABFALL (+)) TMP_TAB, BIL_A
WHERE    TMP_TAB.ABFALL =BIL_A.ABFALL(+)
ORDER BY TMP_TAB.ABFALL
!
 
resultcount :                    25
 
Enter command:
FETCH !
 
ABFALL | EINGANG     | AUSGANG
-------+-------------+------------
AC     | ??????????? |        5126
APC    | ??????????? |        3946
BSAIN  |         366 | ???????????
GUL    | ??????????? |        3150
HM     |      137502 | ???????????
HOSUS  |         292 | ???????????
IND    | ??????????? |       80782
INS    | ??????????? |        5176
KEH    |        6404 |        5522
KW     | ??????????? |          88
LAU    |        1962 | ???????????
MAR    |         551 | ???????????
PAP    |          34 | ???????????
RBMAE  |         198 | ???????????
RYHOA  |         696 | ???????????
RYMAA  | ??????????? |         440
RYPAA  |         156 | ???????????
 
ABFALL | EINGANG     | AUSGANG
-------+-------------+------------
RYSSA  |        1434 | ???????????
RZCRE  |        2346 | ???????????
RZGBE  |          64 | ???????????
RZGBZ  |        3812 | ???????????
RZGWE  |          54 | ???????????
S      | ??????????? |      244759
SPM    |       17539 | ???????????
WIEGE  |        3337 | ???????????
 
resultcount :                    25
 
Enter command:
COMMIT WORK !
 
Enter command:
DROP TABLE ABF !
 
Enter command:
DROP TABLE BIL_A !
 
Enter command:
DROP TABLE BIL_E !
 
Enter command:
CREATE TABLE TA (A1 FIXED (4) KEY, A2 INT) !
 
Enter command:
INSERT TA VALUES (1, 1) !
 
Enter command:
INSERT TA VALUES (2, 10) !
 
Enter command:
INSERT TA VALUES (3, 10) !
 
Enter command:
INSERT TA VALUES (4, 1) !
 
Enter command:
INSERT TA VALUES (6, 1) !
 
Enter command:
INSERT TA VALUES (8, 1) !
 
Enter command:
CREATE TABLE TB (B1 FIXED (6) KEY, B2 INT) !
 
Enter command:
INSERT TB VALUES (2, 20) !
 
Enter command:
INSERT TB VALUES (3, 20) !
 
Enter command:
INSERT TB VALUES (5, 2) !
 
Enter command:
INSERT TB VALUES (7, 2) !
 
Enter command:
CREATE TABLE TC (C1 FIXED (6) KEY, C2 INT) !
 
Enter command:
INSERT TC VALUES (3, 20) !
 
Enter command:
INSERT TC VALUES (4, 2) !
 
Enter command:
INSERT TC VALUES (6, 2) !
 
Enter command:
COMMIT WORK !
 
Enter command:
SELECT R1.*, R2.* FROM
    (SELECT TA.*, TB.* FROM TA, TB WHERE A1 (+)= B1) R1, TC R2
    WHERE R1.A1 (+)= R2.C1 !
 
resultcount :                     3
 
Enter command:
FETCH !
 
A1    | A2          | B1      | B2          | C1      | C2
------+-------------+---------+-------------+---------+------------
    3 |          10 |       3 |          20 |       3 |          20
????? | ??????????? | ??????? | ??????????? |       4 |           2
????? | ??????????? | ??????? | ??????????? |       6 |           2
 
resultcount :                     3
 
Enter command:
SELECT R1.*, R2.* FROM TC R2,
    (SELECT TA.*, TB.* FROM TA, TB WHERE A1 (+)= B1) R1
    WHERE R1.A1 (+)= R2.C1 !
 
resultcount :                     3
 
Enter command:
FETCH !
 
A1    | A2          | B1      | B2          | C1      | C2
------+-------------+---------+-------------+---------+------------
    3 |          10 |       3 |          20 |       3 |          20
????? | ??????????? | ??????? | ??????????? |       4 |           2
????? | ??????????? | ??????? | ??????????? |       6 |           2
 
resultcount :                     3
 
Enter command:
SELECT R1.*, R2.* FROM TA R1,
    (SELECT TB.*, TC.* FROM TB, TC WHERE B1 (+)= C1) R2
    WHERE R1.A1 (+)= R2.C1 !
 
resultcount :                     3
 
Enter command:
FETCH !
 
A1    | A2          | B1      | B2          | C1      | C2
------+-------------+---------+-------------+---------+------------
    3 |          10 |       3 |          20 |       3 |          20
    4 |           1 | ??????? | ??????????? |       4 |           2
    6 |           1 | ??????? | ??????????? |       6 |           2
 
resultcount :                     3
 
Enter command:
SELECT R1.*, R2.* FROM
    (SELECT TB.*, TC.* FROM TB, TC WHERE B1 (+)= C1) R2, TA R1
    WHERE R1.A1 (+)= R2.C1 !
 
resultcount :                     3
 
Enter command:
FETCH !
 
A1    | A2          | B1      | B2          | C1      | C2
------+-------------+---------+-------------+---------+------------
    3 |          10 |       3 |          20 |       3 |          20
    4 |           1 | ??????? | ??????????? |       4 |           2
    6 |           1 | ??????? | ??????????? |       6 |           2
 
resultcount :                     3
 
Enter command:
SELECT A1, A2, B1, B2, C1, C2 FROM
    (SELECT TA.*, TB.* FROM TA, TB WHERE A1 (+)= B1), TC
    WHERE A1 (+)= C1 !
 
resultcount :                     3
 
Enter command:
FETCH !
 
A1    | A2          | B1      | B2          | C1      | C2
------+-------------+---------+-------------+---------+------------
    3 |          10 |       3 |          20 |       3 |          20
????? | ??????????? | ??????? | ??????????? |       4 |           2
????? | ??????????? | ??????? | ??????????? |       6 |           2
 
resultcount :                     3
 
Enter command:
SELECT A1, A2, B1, B2, C1, C2 FROM TC,
    (SELECT TA.*, TB.* FROM TA, TB WHERE A1 (+)= B1)
    WHERE A1 (+)= C1 !
 
resultcount :                     3
 
Enter command:
FETCH !
 
A1    | A2          | B1      | B2          | C1      | C2
------+-------------+---------+-------------+---------+------------
    3 |          10 |       3 |          20 |       3 |          20
????? | ??????????? | ??????? | ??????????? |       4 |           2
????? | ??????????? | ??????? | ??????????? |       6 |           2
 
resultcount :                     3
 
Enter command:
SELECT A1, A2, B1, B2, C1, C2 FROM TA,
    (SELECT TB.*, TC.* FROM TB, TC WHERE B1 (+)= C1)
    WHERE A1 (+)= C1 !
 
resultcount :                     3
 
Enter command:
FETCH !
 
A1    | A2          | B1      | B2          | C1      | C2
------+-------------+---------+-------------+---------+------------
    3 |          10 |       3 |          20 |       3 |          20
    4 |           1 | ??????? | ??????????? |       4 |           2
    6 |           1 | ??????? | ??????????? |       6 |           2
 
resultcount :                     3
 
Enter command:
SELECT A1, A2, B1, B2, C1, C2 FROM
    (SELECT TB.*, TC.* FROM TB, TC WHERE B1 (+)= C1), TA
    WHERE A1 (+)= C1 !
 
resultcount :                     3
 
Enter command:
FETCH !
 
A1    | A2          | B1      | B2          | C1      | C2
------+-------------+---------+-------------+---------+------------
    3 |          10 |       3 |          20 |       3 |          20
    4 |           1 | ??????? | ??????????? |       4 |           2
    6 |           1 | ??????? | ??????????? |       6 |           2
 
resultcount :                     3
 
Enter command:
SELECT A1, A2, B1, B2, C1, C2 FROM
    (SELECT * FROM TA, TB WHERE A1 (+)= B1), TC
    WHERE A1 (+)= C1 !
 
resultcount :                     3
 
Enter command:
FETCH !
 
A1    | A2          | B1      | B2          | C1      | C2
------+-------------+---------+-------------+---------+------------
    3 |          10 |       3 |          20 |       3 |          20
????? | ??????????? | ??????? | ??????????? |       4 |           2
????? | ??????????? | ??????? | ??????????? |       6 |           2
 
resultcount :                     3
 
Enter command:
SELECT A1, A2, B1, B2, C1, C2 FROM TC,
    (SELECT * FROM TA, TB WHERE A1 (+)= B1)
    WHERE A1 (+)= C1 !
 
resultcount :                     3
 
Enter command:
FETCH !
 
A1    | A2          | B1      | B2          | C1      | C2
------+-------------+---------+-------------+---------+------------
    3 |          10 |       3 |          20 |       3 |          20
????? | ??????????? | ??????? | ??????????? |       4 |           2
????? | ??????????? | ??????? | ??????????? |       6 |           2
 
resultcount :                     3
 
Enter command:
SELECT A1, A2, B1, B2, C1, C2 FROM TB,
    (SELECT * FROM TA, TC WHERE A1 (+)= C1)
    WHERE A1 (+)= B1 !
 
resultcount :                     4
 
Enter command:
FETCH !
 
A1    | A2          | B1      | B2          | C1      | C2
------+-------------+---------+-------------+---------+------------
????? | ??????????? |       2 |          20 | ??????? | ???????????
    3 |          10 |       3 |          20 |       3 |          20
????? | ??????????? |       5 |           2 | ??????? | ???????????
????? | ??????????? |       7 |           2 | ??????? | ???????????
 
resultcount :                     4
 
Enter command:
SELECT A1, A2, B1, B2, C1, C2 FROM
    (SELECT * FROM TA, TC WHERE A1 (+)= C1), TB
    WHERE A1 (+)= B1 !
 
resultcount :                     4
 
Enter command:
FETCH !
 
A1    | A2          | B1      | B2          | C1      | C2
------+-------------+---------+-------------+---------+------------
????? | ??????????? |       2 |          20 | ??????? | ???????????
    3 |          10 |       3 |          20 |       3 |          20
????? | ??????????? |       5 |           2 | ??????? | ???????????
????? | ??????????? |       7 |           2 | ??????? | ???????????
 
resultcount :                     4
 
Enter command:
COMMIT RELEASE !
 
Enter command:
FILE CONNECT ( SUT SUT !
 
Enter command:
CONNECT SUT IDENTIFIED BY SUT   ISOLATION LEVEL 1 !
 
Enter command:
DROP USER KERN !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
FILE CONNECT ( SUT SUT !
 
Enter command:
CONNECT SUT IDENTIFIED BY SUT   ISOLATION LEVEL 1 !
 
Enter command:
CREATE USER KERN PASSWORD TEST DBA NOT EXCLUSIVE !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
FILE CONNECT ( KERN TEST !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST   ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE T1 (A1 CHAR(5), A2 CHAR(5)) !
 
Enter command:
INSERT T1 VALUES ('aaaaa','bba21') !
 
Enter command:
INSERT T1 VALUES ('aaaaa','zza22') !
 
Enter command:
CREATE TABLE T2 (B1 CHAR(5), B2 CHAR(5)) !
 
Enter command:
INSERT T2 VALUES ('bbbbb','xxb21') !
 
Enter command:
INSERT T2 VALUES ('bbbbb','eeb22') !
 
Enter command:
CREATE TABLE T3 (C1 CHAR(5), C2 CHAR(5)) !
 
Enter command:
INSERT T3 VALUES ('ccccc','aac21') !
 
Enter command:
INSERT T3 VALUES ('ccccc','zzc22') !
 
Enter command:
SELECT * FROM
  (SELECT A1, A2 FROM T1 WHERE A1 = 'aaaaa'
   UNION
   SELECT B1, B2 FROM T2 WHERE B1 = 'bbbbb')
UNION
SELECT C1, C2 FROM T3 WHERE C1 = 'ccccc'
UNION
SELECT A2, B1 FROM T1, T2 WHERE B2 = 'xxxxx'
ORDER BY 2 !
 
resultcount :                     6
 
Enter command:
FETCH !
 
A1    | A2
------+------
ccccc | aac21
aaaaa | bba21
bbbbb | eeb22
bbbbb | xxb21
aaaaa | zza22
ccccc | zzc22
 
resultcount :                     6
 
Enter command:
SELECT * FROM
  (SELECT A1, A2, SUBSTR ('table t1', 1) FROM T1 WHERE A1 = 'aaaaa'
   UNION
   SELECT B1, B2, SUBSTR ('table t2', 1) FROM T2 WHERE B1 = 'bbbbb')
UNION
SELECT C1, C2, SUBSTR ('table t3', 1) FROM T3 WHERE C1 = 'ccccc'
UNION
SELECT A2, B1, SUBSTR ('table t1, t2', 1) FROM T1, T2 WHERE B2 = 'xxxxx' !
 
resultcount :                     6
 
Enter command:
FETCH !
 
A1    | A2    | EXPRESSION1
------+-------+-------------
aaaaa | bba21 | table t1
ccccc | aac21 | table t3
bbbbb | eeb22 | table t2
aaaaa | zza22 | table t1
bbbbb | xxb21 | table t2
ccccc | zzc22 | table t3
 
resultcount :                     6
 
Enter command:
SELECT C1, C2, SUBSTR ('table t3', 1) FROM T3 WHERE C1 = 'ccccc'
UNION
SELECT A2, B1, SUBSTR ('table t1, t2', 1) FROM T1, T2 WHERE B2 = 'xxxxx'
UNION
SELECT * FROM
  (SELECT * FROM
        (SELECT A1, A2, SUBSTR ('table t1', 1) FROM T1 WHERE A1 = 'aaaaa')
UNION
SELECT B1, B2, SUBSTR ('table t2', 1) FROM T2 WHERE B1 = 'bbbbb')
ORDER BY 3 !
 
resultcount :                     6
 
Enter command:
FETCH !
 
C1    | C2    | EXPRESSION1
------+-------+-------------
aaaaa | bba21 | table t1
aaaaa | zza22 | table t1
bbbbb | eeb22 | table t2
bbbbb | xxb21 | table t2
ccccc | aac21 | table t3
ccccc | zzc22 | table t3
 
resultcount :                     6
 
Enter command:
SELECT * FROM
  (SELECT A1, A2, SUBSTR ('table t1', 1) FROM T1 WHERE A1 = 'aaaaa'
   UNION
   SELECT B1, B2, SUBSTR ('table t2', 1) FROM T2 WHERE B1 = 'bbbbb')
UNION
SELECT C1, C2, SUBSTR ('table t3', 1) FROM T3 WHERE C1 = 'ccccc'
UNION
SELECT A2, B1, SUBSTR ('table t1, t2', 1) FROM T1, T2 WHERE B2 = 'xxxxx'
ORDER BY 3 !
 
resultcount :                     6
 
Enter command:
FETCH !
 
A1    | A2    | EXPRESSION1
------+-------+-------------
aaaaa | bba21 | table t1
aaaaa | zza22 | table t1
bbbbb | eeb22 | table t2
bbbbb | xxb21 | table t2
ccccc | aac21 | table t3
ccccc | zzc22 | table t3
 
resultcount :                     6
 
Enter command:
EXPLAIN SELECT * FROM (SELECT * FROM T1 X, T1 Y) !
 
***ERROR  -6001 Duplicate column name:A1                                   0031
 
Enter command:
SELECT * FROM (SELECT * FROM T1 X, T1 Y)
ORDER BY X.A1, Y.A2 !
 
***ERROR  -6001 Duplicate column name:A1                                   0023
 
Enter command:
FETCH !
 
***ERROR    100 Row not found                                              0001
 
Enter command:
SELECT * FROM (SELECT * FROM T1 X, T1 Y) !
 
***ERROR  -6001 Duplicate column name:A1                                   0023
 
Enter command:
FETCH !
 
***ERROR    100 Row not found                                              0001
 
Enter command:
SELECT * FROM (SELECT X.A1 SP11, X.A2 SP12, Y.A1 SP21, Y.A2 SP22
FROM T1 X, T1 Y) X
ORDER BY X.SP11, X.SP12 !
 
resultcount :                     4
 
Enter command:
FETCH !
 
SP11  | SP12  | SP21  | SP22
------+-------+-------+------
aaaaa | bba21 | aaaaa | bba21
aaaaa | bba21 | aaaaa | zza22
aaaaa | zza22 | aaaaa | bba21
aaaaa | zza22 | aaaaa | zza22
 
resultcount :                     4
 
Enter command:
COMMIT RELEASE !
 
Enter command:
 
FILE CONNECT ( KERN TEST !
 
Enter command:
CONNECT KERN IDENTIFIED BY TEST   ISOLATION LEVEL 1 !
 
Enter command:
CREATE TABLE PVC_VSETELEMHIST (
OBJECTID        INT,
ACTIVATIONSEQNO INT,
VERSIONID       INT,
VERSIONSETID    INT,
MODOPERATION INT,
AUTOVERSION  INT,
DEACTIVATED  BOOLEAN) !
 
Enter command:
CREATE INDEX I ON PVC_VSETELEMHIST (VERSIONSETID) !
 
Enter command:
INSERT INTO PVC_VSETELEMHIST VALUES
(1,1,1,1,1,1,TRUE)!
 
Enter command:
 
CREATE TABLE DAV_RESOURCE (
RESOURCEID   INT,
PATHURI      CHAR (20) ) !
 
Enter command:
INSERT INTO DAV_RESOURCE VALUES (1, 'abc')!
 
Enter command:
 
CREATE TABLE PVC_VSINTEGRATION (
TARGETVSID     INT,
SEQUENCENUMBER INT,
CREATIONTIME   TIME) !
 
Enter command:
CREATE INDEX I ON PVC_VSINTEGRATION (TARGETVSID) !
 
Enter command:
INSERT INTO PVC_VSINTEGRATION VALUES (1,1,TIME)!
 
Enter command:
 
CREATE TABLE DAV_MOVEHISTORY  (
VERSIONSETID    INT,
INTEGRATIONTIME INT,
OLDVERSIONID    INT,
INTEGRATIONSEQNO INT) !
 
Enter command:
INSERT INTO DAV_MOVEHISTORY VALUES (1,1,1,1)!
 
Enter command:
 
CREATE TABLE PVC_VERSION (
VERSIONID INT,
OBJECTID  INT) !
 
Enter command:
INSERT INTO PVC_VERSION VALUES (1,1)!
 
Enter command:
 
PARSING !
 
Enter command:
           SELECT VSEH.OBJECTID
                , VSEH.ACTIVATIONSEQNO
                , VSEH.VERSIONID
                , VSEH.VERSIONSETID
                , MODOPERATION
                , AUTOVERSION
                , DEACTIVATED
            FROM
                PVC_VSETELEMHIST VSEH
                , DAV_RESOURCE R,
                (SELECT VSEH.OBJECTID, MAX(ACTIVATIONSEQNO) AS ASN
                FROM PVC_VSINTEGRATION VSI
                , PVC_VSETELEMHIST VSEH
                WHERE VSI.TARGETVSID = VSEH.VERSIONSETID
                AND VSI.SEQUENCENUMBER = VSEH.ACTIVATIONSEQNO
                AND VSI.TARGETVSID = ?
                GROUP BY VSEH.OBJECTID
                ) MAXS
            WHERE
                VSEH.OBJECTID = MAXS.OBJECTID
                AND VSEH.ACTIVATIONSEQNO = MAXS.ASN
                AND VSEH.VERSIONSETID = ?
                AND VSEH.VERSIONID = R.RESOURCEID
                AND R.PATHURI LIKE ?
            UNION
            SELECT
                VSEH.OBJECTID
                , VSEH.ACTIVATIONSEQNO
                , VSEH.VERSIONID
                , VSEH.VERSIONSETID
                , MODOPERATION
                , AUTOVERSION
                , DEACTIVATED
            FROM
                PVC_VSETELEMHIST VSEH
                , (SELECT MH.INTEGRATIONSEQNO
                , V.OBJECTID
                FROM DAV_MOVEHISTORY MH
                , DAV_RESOURCE R
                , PVC_VERSION V
                WHERE MH.VERSIONSETID = ?
                AND R.RESOURCEID = MH.OLDVERSIONID
                AND R.PATHURI LIKE ?
                AND V.VERSIONID = MH.OLDVERSIONID
                ) MOVES
            WHERE
                VSEH.VERSIONSETID = ?
                AND VSEH.ACTIVATIONSEQNO = MOVES.INTEGRATIONSEQNO
                AND VSEH.OBJECTID = MOVES.OBJECTID
            ORDER BY 1, 2 DESC!
parsing idnr :       1
 
Enter command:
EXECUTING !
 
Enter command:
DATA !
 
Enter command:
SELECT !
Parsing idnr :      1
 
n 10 1
n 10 1
c 30 'abc'
n 10 1
c 30 'abc'
n 10 1
 
resultcount :                     1
 
Enter command:
PARS_THEN_EX !
 
Enter command:
NODATA !
 
Enter command:
FETCH INTO :A, :B, :C, :D, :E, :F, :G !
 
OBJECTID          :  <objectid>
ACTIVATIONSEQNO   :            1
VERSIONID         :            1
VERSIONSETID      :            1
MODOPERATION      :            1
AUTOVERSION       :            1
DEACTIVATED       :  1
 
resultcount :                     1
 
Enter command:
EXECUTING !
 
Enter command:
DATA !
 
Enter command:
SELECT !
Parsing idnr :      1
 
n 10 1
n 10 1
c 30 'abc'
n 10 1
c 30 'abc'
n 10 1
 
resultcount :                     1
 
Enter command:
PARS_THEN_EX !
 
Enter command:
NODATA !
 
Enter command:
FETCH INTO :A, :B, :C, :D, :E, :F, :G !
 
OBJECTID          :  <objectid>
ACTIVATIONSEQNO   :            1
VERSIONID         :            1
VERSIONSETID      :            1
MODOPERATION      :            1
AUTOVERSION       :            1
DEACTIVATED       :  1
 
resultcount :                     1
 
Enter command:
PARS_EXECUTE !
 
Enter command:
ROLLBACK RELEASE !
 
Enter command:
FILE CONNECT ( SUT SUT !
 
Enter command:
CONNECT SUT IDENTIFIED BY SUT   ISOLATION LEVEL 1 !
 
Enter command:
DROP USER KERN !
 
Enter command:
COMMIT WORK RELEASE !
 
Enter command:
 
 
FILE SHUTDOWN !
 
Enter command:
DBMCLI SUPERDBA,COLDUSER!
UTIL_CONNECT SUT,SUT!
OK
 
DB_OFFLINE!
OK
 
BYE!
 
Enter command:
VDNEXIT !
SESSION END
 
