file connect ( kern test !
* bis 6.1.1 Cl15C hat INSERT SELECT, das beim 1. Strategiesuchen
* inv_only bekam, nicht auf second_part umgeschaltet. Da der 
* Messbuffer aber modifiziert wurde, lieferte die 2. Strategiesuche
* eine Strategie, die eine Zweiphasigkeit erfordert haette.
* ==> falsches Ergebnis, wenn DISTINCT angegeben war !
CREATE TABLE PI7NER                                    (
"NERADMNO          " CHAR      (11) ASCII    ,
"NERNO             " FIXED     (3,0) 
, PRIMARY KEY ("NERADMNO          "
)) !
CREATE TABLE PI7PRT                                    (
"PRTADMNO          " CHAR      (10) ASCII    ,
"PRTNO             " FIXED     (8,0) ,
"PRTAREA           " FIXED     (2,0) ,
"PRT123            " FIXED     (2,0) ,
"PRTDEB            " CHAR      (12) ASCII    ,
"PRTMAINDEB        " CHAR      (12) ASCII    ,
"PRTDATF           " CHAR      (8) ASCII    ,
"PRTTXT            " FIXED     (2,0) ,
"PRTSTORNONO       " FIXED     (8,0) ,
"PRTSSENO          " FIXED     (4,0) ,
"PRTDATT           " CHAR      (8) ASCII    ,
"PRTDAY            " FIXED     (4,0) ,
"PRTCCNO           " VARCHAR   (24) ASCII    ,
"PRTPRACCBS        " VARCHAR   (24) ASCII    ,
"PRTDES            " CHAR      (35) ASCII    ,
"PRTTARIF          " CHAR      (12) ASCII    ,
"PRTUNIT           " FIXED     (10,2) ,
"PRTTOTAL          " FIXED     (10,2) ,
"PRTDEBUNIT        " FIXED     (10,2) ,
"PRTDEBAMT         " FIXED     (10,2) ,
"PRTDEBPERC        " FIXED     (10,2) ,
"PRTNUMBER         " FIXED     (8,0) ,
"PRTSYSDAT         " CHAR      (8) ASCII    ,
"PRTSETLDAT        " CHAR      (8) ASCII    ,
"PRTDICMAT         " CHAR      (12) ASCII    
, PRIMARY KEY ("PRTADMNO          "
,"PRTNO             "
,"PRTAREA           "
,"PRT123            "
,"PRTDEB            "
,"PRTMAINDEB        "
,"PRTDATF           "
,"PRTTXT            "
,"PRTSTORNONO       "
,"PRTSSENO          "
))!
insert pi7prt values('800000009',3,0,3,'3000009','3000009','19910101',
0,22,0,'19910131',31,'0969001',
'0400009','Pflegesatz','AS',86.00,2666.00,86.00,0.00,100.00,81000379,
'19910225','19910131',null)!
insert pi7prt values('804000364',373,5,1,'1253066','1253066','19941214',
0,0,43,'19941231',18,'0969001',
'0400024','PauschaleAerztlicheVersorgung','AEV',5.50,99.00,5.50,0.00,
100.00,85000250,'19950102','19941231',null)!
insert pi7prt values('804000364',373,5,3,'6000364','6000364','19941214',
0,0,44,'19941231',18,'0969001',
'0401004','Pers.hygienischerSachbedarf','HS',0.40,7.20,0.40,0.00,100.00,
85000462,'19950102','19941231',null)!
insert pi7prt values('804000364',374,0,3,'6000364','6000364','19950101',
0,0,0,'19950131',31,'0969001',
'0400125','Pflegesatz','PZ',133.80,4147.80,133.80,0.00,100.00,85000993,
'19950209','19950131',null)!
insert pi7prt values('804000364',374,5,1,'1253066','1253066','19950101',
0,0,37,'19950131',31,'0969001',
'0400020','PauschaleAerztlicheVersorgung','AEV',5.50,170.50,5.50,0.00,
100.00,85000810,'19950209','19950131',null)!
insert pi7prt values('804000364',374,5,3,'6000364','6000364','19950101',
0,0,38,'19950131',31,'0969001',
'0401005','Pers.hygienischerSachbedarf','HS',0.40,12.40,0.40,0.00,100.00,
85000993,'19950209','19950131',null)!
insert pi7prt values('804000364',374,6,1,'1253066','1253066','19941231',
0,0,1,'19941231',1,'0969001',
'0400054','Heil-/Hilfsmittel','',79.85,79.85,79.85,0.00,100.00,85000810,
'19950209','19941231',null)!
insert pi7prt values('804000364',376,0,3,'6000364','6000364','19950201',
0,0,0,'19950228',28,'0969001',
'0400125','Pflegesatz','PZ',133.80,3746.40,133.80,0.00,100.00,85001558,
'19950308','19950228',null)!
insert pi7prt values('804000364',376,5,1,'1253066','1253066','19950201',
0,0,36,'19950228',28,'0969001',
'0400020','PauschaleAerztlicheVersorgung','AEV',5.50,154.00,5.50,0.00,
100.00,85001353,'19950308','19950228',null)!
insert pi7prt values('804000364',376,5,3,'6000364','6000364','19950201',
0,0,37,'19950228',28,'0969001',
'0401005','Pers.hygienischerSachbedarf','HS',0.40,11.20,0.40,0.00,100.00,
85001558,'19950308','19950228',null)!
insert pi7prt values('804000364',376,6,1,'1253066','1253066','19950131',
0,0,2,'19950131',1,'0969001',
'0400055','Heil-/Hilfsmittel','',76.28,76.28,76.28,0.00,100.00,85001353,
'19950308','19950131',null)!
insert pi7prt values('804000364',377,0,3,'6000364','6000364','19950301',
0,0,0,'19950331',31,'0969001',
'0400125','Pflegesatz','PZ',133.80,4147.80,133.80,0.00,100.00,85002155,
'19950411','19950331',null)!
insert pi7prt values('804000364',377,5,1,'1253066','1253066','19950301',
0,0,36,'19950331',31,'0969001',
'0400020','PauschaleAerztlicheVersorgung','AEV',5.50,170.50,5.50,0.00,
100.00,85001981,'19950411','19950331',null)!
insert pi7prt values('804000364',377,5,3,'6000364','6000364','19950301',
0,0,37,'19950331',31,'0969001',
'0401005','Pers.hygienischerSachbedarf','HS',0.40,12.40,0.40,0.00,100.00,
85002155,'19950411','19950331',null)!
insert pi7prt values('804000364',377,6,1,'1253066','1253066','19950228',
0,0,3,'19950228',1,'0969001',
'0400055','Heil-/Hilfsmittel','',63.35,63.35,63.35,0.00,100.00,85001981,
'19950411','19950228',null)!
insert pi7prt values('804000364',379,0,3,'6000364','6000364','19950401',
0,0,0,'19950430',30,'0969001',
'0400125','Pflegesatz','PZ',133.80,4014.00,133.80,0.00,100.00,85002759,
'19950508','19950430',null)!
insert pi7prt values('804000364',379,5,1,'1253066','1253066','19950401',
0,0,36,'19950430',30,'0969001',
'0400020','PauschaleAerztlicheVersorgung','AEV',5.50,165.00,5.50,0.00,
100.00,85002570,'19950508','19950430',null)!
insert pi7prt values('804000364',379,5,3,'6000364','6000364','19950401',
0,0,37,'19950430',30,'0969001',
'0401005','Pers.hygienischerSachbedarf','HS',0.40,12.00,0.40,0.00,100.00,
85002759,'19950508','19950430',null)!
insert pi7prt values('804000364',379,6,1,'1253066','1253066','19950331',
0,0,4,'19950331',1,'0969001',
'0400055','Heil-/Hilfsmittel','',63.48,63.48,63.48,0.00,100.00,85002570,
'19950508','19950331',null)!
insert pi7prt values('804000364',380,0,3,'6000364','6000364','19950501',
0,0,0,'19950531',31,'0969001',
'0400125','Pflegesatz','PZ',133.80,4147.80,133.80,0.00,100.00,85003267,
'19950627','19950531',null)!
insert pi7prt values('804000364',380,5,1,'1253066','1253066','19950501',
0,0,36,'19950531',31,'0969001',
'0400020','PauschaleAerztlicheVersorgung','AEV',5.50,170.50,5.50,0.00,
100.00,85003127,'19950627','19950531',null)!
insert pi7prt values('804000364',380,5,3,'6000364','6000364','19950501',
0,0,37,'19950531',31,'0969001',
'0401005','Pers.hygienischerSachbedarf','HS',0.40,12.40,0.40,0.00,100.00,
85003267,'19950627','19950531',null)!
insert pi7prt values('804000364',380,6,1,'1253066','1253066','19950430',
0,0,5,'19950430',1,'0969001',
'0400055','Heil-/Hilfsmittel','',76.19,76.19,76.19,0.00,100.00,85003127,
'19950627','19950430',null)!
insert pi7prt values('804000364',380,6,1,'1253066','1253066','19950531',
0,0,6,'19950531',1,'0969001',
'0400055','Heil-/Hilfsmittel','',28.01,28.01,28.01,0.00,100.00,85003127,
'19950627','19950531',null)!
insert pi7prt values('804000364',387,0,3,'6000364','6000364','19950601',
0,0,0,'19950630',30,'0969001',
'0400125','Pflegesatz','PZ',133.80,4014.00,133.80,0.00,100.00,85003801,
'19950711','19950630',null)!
insert pi7prt values('804000364',387,5,1,'1253066','1253066','19950601',
0,0,32,'19950630',30,'0969001',
'0400020','PauschaleAerztlicheVersorgung','AEV',5.50,165.00,5.50,0.00,
100.00,85003666,'19950711','19950630',null)!
insert pi7prt values('804000364',387,5,3,'6000364','6000364','19950601',
0,0,33,'19950630',30,'0969001',
'0401005','Pers.hygienischerSachbedarf','HS',0.40,12.00,0.40,0.00,100.00,
85003801,'19950711','19950630',null)!
insert pi7prt values('804000364',387,6,1,'1253066','1253066','19950630',
0,0,7,'19950630',1,'0969001',
'0400055','Heil-/Hilfsmittel','',37.62,37.62,37.62,0.00,100.00,85003666,
'19950711','19950630',null)!
insert pi7prt values('804000364',395,0,3,'6000364','6000364','19950701',
0,0,0,'19950731',31,'0969001',
'0400125','Pflegesatz','PZ',133.80,4147.80,133.80,0.00,100.00,85004450,
'19950807','19950731',null)!
insert pi7prt values('804000364',395,5,1,'1253066','1253066','19950701',
0,0,30,'19950731',31,'0969001',
'0400020','PauschaleAerztlicheVersorgung','AEV',5.50,170.50,5.50,0.00,
100.00,85004280,'19950807','19950731',null)!
insert pi7prt values('804000364',395,5,3,'6000364','6000364','19950701',
0,0,31,'19950731',31,'0969001',
'0401005','Pers.hygienischerSachbedarf','HS',0.40,12.40,0.40,0.00,100.00,
85004450,'19950807','19950731',null)!
insert pi7prt values('804000364',398,0,3,'6000364','6000364','19950801',
0,0,0,'19950831',31,'0969001',
'0400125','Pflegesatz','PZ',136.20,4222.20,136.20,0.00,100.00,85004999,
'19950904','19950831',null)!
insert pi7prt values('804000364',398,5,1,'1253066','1253066','19950801',
0,0,159,'19950831',31,'0969001',
'0400020','PauschaleAerztlicheVersorgung','AEV',5.50,170.50,5.50,0.00,
100.00,85004832,'19950904','19950831',null)!
insert pi7prt values('804000364',398,5,3,'6000364','6000364','19950801',
0,0,160,'19950831',31,'0969001',
'0401005','Pers.hygienischerSachbedarf','HS',0.40,12.40,0.40,0.00,100.00
,85004999,'19950904','19950831',null)!
insert pi7prt values('804000364',398,6,1,'1253066','1253066','19950731',
0,0,8,'19950731',1,'0969001',
'0400055','Heil-/Hilfsmittel','',42.56,42.56,42.56,0.00,100.00,85004832,
'19950904','19950731',null)!
insert pi7prt values('804000364',419,0,1,'1124406','1124406','19950901',
0,0,0,'19950930',30,'0969001',
'0400125','Pflegesatz','PZ',136.20,4086.00,136.20,0.00,100.00,85005901,
'19951010','19950930',null)!
insert pi7prt values('804000364',419,5,1,'1253066','1253066','19950901',
0,0,1,'19950930',30,'0969001',
'0400020','PauschaleAerztlicheVersorgung','AEV',5.50,165.00,5.50,0.00,
100.00,85005910,'19951010','19950930',null)!
insert pi7prt values('804000364',419,5,3,'6000364','6000364','19950901',
0,0,2,'19950930',30,'0969001',
'0401005','Pers.hygienischerSachbedarf','HS',0.40,12.00,0.40,0.00,100.00,
85005928,'19951010','19950930',null)!
insert pi7prt values('804000364',419,6,1,'1253066','1253066','19950831',
0,0,9,'19950831',1,'0969001',
'0400055','Heil-/Hilfsmittel','',46.19,46.19,46.19,0.00,100.00,85005910,
'19951010','19950831',null)!
insert pi7prt values('804000364',419,6,1,'1253066','1253066','19950930',
0,0,10,'19950930',1,'0969001',
'0400055','Heil-/Hilfsmittel','',42.75,42.75,42.75,0.00,100.00,85005910,
'19951010','19950930',null)!
insert pi7prt values('805000007',374,0,3,'6300007','6300007','19950104',
0,0,0,'19950131',28,'0969001',
'0400125','Pflegesatz','PZ',133.80,3746.40,133.80,0.00,100.00,85001086,
'19950209','19950131',null)!
insert pi7prt values('805000007',374,5,3,'6300007','6300007','19950104',
0,0,39,'19950131',28,'0969001',
'0401005','Pers.hygienischerSachbedarf','HS',0.40,11.20,0.40,0.00,100.00,
85001086,'19950209','19950131',null)!
insert pi7prt values('805000007',376,0,3,'6300007','6300007','19950201',
0,0,0,'19950228',28,'0969001',
'0400125','Pflegesatz','PZ',133.80,3746.40,133.80,0.00,100.00,85001655,
'19950308','19950228',null)!
CREATE INDEX "PI7PRT.PRTMAINDEB"
	on PI7PRT( PRTMAINDEB ASC ) !
CREATE INDEX "PI7PRT.PRTNO"
	on PI7PRT( PRTNO ASC ) !
select 
"PRTADMNO          "
,"PRTNO             "
,"PRTAREA           "
,"PRT123            "
,"PRTDEB            "
,"PRTMAINDEB        "
,"PRTDATF           "
,"PRTTXT            "
,"PRTSTORNONO       "
,"PRTSSENO          " from pi7prt !
* fetch!
select count(*) from pi7prt !
fetch!
select distinct prtadmno,prtno
from pi7prt
where (prtno = 419 )
and   (prtadmno  = '804000364') !
fetch!
declare erg cursor for 
select distinct prtadmno,prtno
from pi7prt
where (prtno = 419 )
and   (prtadmno  = '804000364') for reuse!
fetch erg!
insert  pi7ner
select distinct prtadmno,prtno
from pi7prt
where (prtno = 419 )
and   (prtadmno  = '804000364') !
select * from pi7ner !
fetch!
rollback release !
