SQLMODE INTERNAL
//
USE SCHEMA "HOTEL"
//
USE SCHEMA "HOTEL"
//
CREATE TABLE "HOTEL"
(
	"HNO"  Fixed (4,0)  NOT NULL,
	"NAME"  Char (15) ASCII  NOT NULL,
	"ZIP"  Fixed (10,0),
	"COUNTRY_ID"  Fixed (3,0),
	"ADDRESS"  Char (25) ASCII  NOT NULL,
	"INFO"  Long ASCII,
	PRIMARY KEY ("HNO"),
 CONSTRAINT "HNO_CONS" CHECK HNO > 0
)
//
GRANT SELECT(HNO,NAME) ON MONA.HOTEL TO PUCK
//
GRANT SELECT(HNO,NAME) ON MONA.HOTEL TO PUCK WITH GRANT OPTION
//
GRANT SELECT(HNO,NAME) ON MONA.HOTEL TO TANZA
//
GRANT SELECT(HNO,NAME) ON MONA.HOTEL TO TANZA WITH GRANT OPTION
//
CREATE TABLE "ROOM"
(
	"HNO"  Fixed (4,0)  NOT NULL,
	"TYPE"  Char (6) ASCII  NOT NULL,
	"FREE"  Fixed (3,0),
	"PRICE"  Fixed (6,2),
	PRIMARY KEY ("HNO", "TYPE"),
 CONSTRAINT "FREE_CONS" CHECK FREE >= 0,
 CONSTRAINT "HNO_CONS" CHECK HNO > 0,
 CONSTRAINT "PRICE_CONS" CHECK PRICE BETWEEN 0.00 AND 5000.00,
 CONSTRAINT "TYPE_CONS" CHECK TYPE IN ('single','double','suite')
)
//
CREATE TABLE "EMPLOYEE"
(
	"HNO"  Fixed (4,0)  NOT NULL,
	"ENO"  Fixed (4,0)  NOT NULL,
	"TITLE"  Char (7) ASCII,
	"FIRSTNAME"  Char (10) ASCII,
	"NAME"  Char (10) ASCII  NOT NULL,
	"MANAGER_ENO"  Fixed (4,0),
	PRIMARY KEY ("HNO", "ENO"),
 CONSTRAINT "TITLE_CONS" CHECK TITLE IN ('Mr','Mrs')
)
//
CREATE TABLE "RESERVATION"
(
	"RNO"  Fixed (4,0)  NOT NULL,
	"CNO"  Fixed (6,0),
	"HNO"  Fixed (4,0),
	"TYPE"  Char (6) ASCII,
	"ARRIVAL"  Date  NOT NULL,
	"DEPARTURE"  Date  NOT NULL,
	PRIMARY KEY ("RNO"),
 CONSTRAINT "CNO_CONS" CHECK CNO > 0,
 CONSTRAINT "HNO_CONS" CHECK HNO > 0,
 CONSTRAINT "RNO_CONS" CHECK RNO > 0,
 CONSTRAINT "STAYING" CHECK DEPARTURE > ARRIVAL,
 CONSTRAINT "TYPE_CONS" CHECK TYPE IN ('single','double','suite')
)
//
GRANT UPDATE ON MONA.RESERVATION TO PUCK
//
GRANT SELECT(CNO,HNO) ON MONA.RESERVATION TO PUCK
//
GRANT SELECT(CNO,HNO) ON MONA.RESERVATION TO PUCK WITH GRANT OPTION
//
GRANT SELECT(CNO,HNO) ON MONA.RESERVATION TO TANZA
//
GRANT SELECT(CNO,HNO) ON MONA.RESERVATION TO TANZA WITH GRANT OPTION
//
USE SCHEMA "HOTEL"
//
USE SCHEMA "HOTEL"
//
ALTER TABLE "HOTEL" FOREIGN KEY "HOTEL_ZIP_IN_CITY" ("ZIP","COUNTRY_ID") REFERENCES "CITY" ("ZIP","COUNTRY_ID") ON DELETE  RESTRICT
//
ALTER TABLE "ROOM" FOREIGN KEY "ROOM_HNO_IN_HOTEL" ("HNO") REFERENCES "HOTEL" ("HNO") ON DELETE  CASCADE
//
ALTER TABLE "EMPLOYEE" FOREIGN KEY "EMPLOYEE_HNO_IN_HOTEL" ("HNO") REFERENCES "HOTEL" ("HNO") ON DELETE  CASCADE
//
ALTER TABLE "RESERVATION" FOREIGN KEY "RESERVATION_CNO_IN_CUSTOMER" ("CNO") REFERENCES "CUSTOMER" ("CUSTOMER_ID") ON DELETE  CASCADE
//
ALTER TABLE "RESERVATION" FOREIGN KEY "RESERVATION_INFO_IN_ROOM" ("HNO","TYPE") REFERENCES "ROOM" ("HNO","TYPE") ON DELETE  CASCADE
//
USE SCHEMA "HOTEL"
//

